<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.1.0"/>
    <title>tgasdk API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>




            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#TDAnalytics">TDAnalytics</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#TDAnalytics.__init__">TDAnalytics</a>
                        </li>
                        <li>
                                <a class="function" href="#TDAnalytics.set_dynamic_super_properties_tracker">set_dynamic_super_properties_tracker</a>
                        </li>
                        <li>
                                <a class="function" href="#TDAnalytics.user_set">user_set</a>
                        </li>
                        <li>
                                <a class="function" href="#TDAnalytics.user_unset">user_unset</a>
                        </li>
                        <li>
                                <a class="function" href="#TDAnalytics.user_setOnce">user_setOnce</a>
                        </li>
                        <li>
                                <a class="function" href="#TDAnalytics.user_add">user_add</a>
                        </li>
                        <li>
                                <a class="function" href="#TDAnalytics.user_append">user_append</a>
                        </li>
                        <li>
                                <a class="function" href="#TDAnalytics.user_uniq_append">user_uniq_append</a>
                        </li>
                        <li>
                                <a class="function" href="#TDAnalytics.user_del">user_del</a>
                        </li>
                        <li>
                                <a class="function" href="#TDAnalytics.track">track</a>
                        </li>
                        <li>
                                <a class="function" href="#TDAnalytics.track_first">track_first</a>
                        </li>
                        <li>
                                <a class="function" href="#TDAnalytics.track_update">track_update</a>
                        </li>
                        <li>
                                <a class="function" href="#TDAnalytics.track_overwrite">track_overwrite</a>
                        </li>
                        <li>
                                <a class="function" href="#TDAnalytics.flush">flush</a>
                        </li>
                        <li>
                                <a class="function" href="#TDAnalytics.close">close</a>
                        </li>
                        <li>
                                <a class="function" href="#TDAnalytics.clear_super_properties">clear_super_properties</a>
                        </li>
                        <li>
                                <a class="function" href="#TDAnalytics.set_super_properties">set_super_properties</a>
                        </li>
                        <li>
                                <a class="function" href="#TDAnalytics.enableLog">enableLog</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#TDLogConsumer">TDLogConsumer</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#TDLogConsumer.__init__">TDLogConsumer</a>
                        </li>
                        <li>
                                <a class="function" href="#TDLogConsumer.construct_filename">construct_filename</a>
                        </li>
                        <li>
                                <a class="function" href="#TDLogConsumer.file_size_out">file_size_out</a>
                        </li>
                        <li>
                                <a class="function" href="#TDLogConsumer.unlock_logging_consumer">unlock_logging_consumer</a>
                        </li>
                        <li>
                                <a class="function" href="#TDLogConsumer.lock_logging_consumer">lock_logging_consumer</a>
                        </li>
                        <li>
                                <a class="variable" href="#TDLogConsumer.log_directory">log_directory</a>
                        </li>
                        <li>
                                <a class="variable" href="#TDLogConsumer.sdf">sdf</a>
                        </li>
                        <li>
                                <a class="variable" href="#TDLogConsumer.suffix">suffix</a>
                        </li>
                        <li>
                                <a class="function" href="#TDLogConsumer.add">add</a>
                        </li>
                        <li>
                                <a class="function" href="#TDLogConsumer.flush_with_close">flush_with_close</a>
                        </li>
                        <li>
                                <a class="function" href="#TDLogConsumer.refresh_writer">refresh_writer</a>
                        </li>
                        <li>
                                <a class="function" href="#TDLogConsumer.flush">flush</a>
                        </li>
                        <li>
                                <a class="function" href="#TDLogConsumer.close">close</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#TDBatchConsumer">TDBatchConsumer</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#TDBatchConsumer.__init__">TDBatchConsumer</a>
                        </li>
                        <li>
                                <a class="function" href="#TDBatchConsumer.add">add</a>
                        </li>
                        <li>
                                <a class="function" href="#TDBatchConsumer.flush">flush</a>
                        </li>
                        <li>
                                <a class="function" href="#TDBatchConsumer.flush_once">flush_once</a>
                        </li>
                        <li>
                                <a class="function" href="#TDBatchConsumer.close">close</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#TDDebugConsumer">TDDebugConsumer</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#TDDebugConsumer.__init__">TDDebugConsumer</a>
                        </li>
                        <li>
                                <a class="function" href="#TDDebugConsumer.add">add</a>
                        </li>
                        <li>
                                <a class="function" href="#TDDebugConsumer.flush">flush</a>
                        </li>
                        <li>
                                <a class="function" href="#TDDebugConsumer.close">close</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#TDAsyncBatchConsumer">TDAsyncBatchConsumer</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#TDAsyncBatchConsumer.__init__">TDAsyncBatchConsumer</a>
                        </li>
                        <li>
                                <a class="function" href="#TDAsyncBatchConsumer.add">add</a>
                        </li>
                        <li>
                                <a class="function" href="#TDAsyncBatchConsumer.flush">flush</a>
                        </li>
                        <li>
                                <a class="function" href="#TDAsyncBatchConsumer.close">close</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#TDException">TDException</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="class" href="#TDIllegalDataException">TDIllegalDataException</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="class" href="#TDNetworkException">TDNetworkException</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="class" href="#TD_ROTATE_MODE">TD_ROTATE_MODE</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#TD_ROTATE_MODE.DAILY">DAILY</a>
                        </li>
                        <li>
                                <a class="variable" href="#TD_ROTATE_MODE.HOURLY">HOURLY</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#TDDynamicSuperPropertiesTracker">TDDynamicSuperPropertiesTracker</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#TDDynamicSuperPropertiesTracker.get_dynamic_super_properties">get_dynamic_super_properties</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
tgasdk    </h1>

                
                        <input id="mod-tgasdk-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-tgasdk-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos"> 1</span></a><span class="kn">from</span> <span class="nn">tgasdk.sdk</span> <span class="kn">import</span> <span class="o">*</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos"> 2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos"> 3</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos"> 4</span></a>    <span class="s1">&#39;TDAnalytics&#39;</span><span class="p">,</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos"> 5</span></a>    <span class="s1">&#39;TDLogConsumer&#39;</span><span class="p">,</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos"> 6</span></a>    <span class="s1">&#39;TDBatchConsumer&#39;</span><span class="p">,</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos"> 7</span></a>    <span class="s1">&#39;TDDebugConsumer&#39;</span><span class="p">,</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos"> 8</span></a>    <span class="s1">&#39;TDAsyncBatchConsumer&#39;</span><span class="p">,</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos"> 9</span></a>    <span class="s1">&#39;TDException&#39;</span><span class="p">,</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">10</span></a>    <span class="s1">&#39;TDIllegalDataException&#39;</span><span class="p">,</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">11</span></a>    <span class="s1">&#39;TDNetworkException&#39;</span><span class="p">,</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">12</span></a>    <span class="s1">&#39;TD_ROTATE_MODE&#39;</span><span class="p">,</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">13</span></a>    <span class="s1">&#39;TDDynamicSuperPropertiesTracker&#39;</span><span class="p">,</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">14</span></a><span class="p">]</span>
</span></pre></div>


            </section>
                <section id="TDAnalytics">
                            <input id="TDAnalytics-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">TDAnalytics</span>:

                <label class="view-source-button" for="TDAnalytics-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDAnalytics"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDAnalytics-129"><a href="#TDAnalytics-129"><span class="linenos">129</span></a><span class="k">class</span> <span class="nc">TDAnalytics</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="TDAnalytics-130"><a href="#TDAnalytics-130"><span class="linenos">130</span></a>    <span class="n">__strict</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="TDAnalytics-131"><a href="#TDAnalytics-131"><span class="linenos">131</span></a>
</span><span id="TDAnalytics-132"><a href="#TDAnalytics-132"><span class="linenos">132</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">consumer</span><span class="p">,</span> <span class="n">enable_uuid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TDAnalytics-133"><a href="#TDAnalytics-133"><span class="linenos">133</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics-134"><a href="#TDAnalytics-134"><span class="linenos">134</span></a><span class="sd">        - TDLogConsumer: Write local files in batches</span>
</span><span id="TDAnalytics-135"><a href="#TDAnalytics-135"><span class="linenos">135</span></a><span class="sd">        - TDBatchConsumer: Transfer data to the TE server in batches(synchronous blocking)</span>
</span><span id="TDAnalytics-136"><a href="#TDAnalytics-136"><span class="linenos">136</span></a><span class="sd">        - TDAsyncBatchConsumer:Transfer data to the TE server in batches(asynchronous blocking)</span>
</span><span id="TDAnalytics-137"><a href="#TDAnalytics-137"><span class="linenos">137</span></a><span class="sd">        - TDDebugConsumer: Send data one by one, and strictly verify the data format</span>
</span><span id="TDAnalytics-138"><a href="#TDAnalytics-138"><span class="linenos">138</span></a>
</span><span id="TDAnalytics-139"><a href="#TDAnalytics-139"><span class="linenos">139</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAnalytics-140"><a href="#TDAnalytics-140"><span class="linenos">140</span></a><span class="sd">        - consumer -- required</span>
</span><span id="TDAnalytics-141"><a href="#TDAnalytics-141"><span class="linenos">141</span></a><span class="sd">        - enable_uuid -- true,false</span>
</span><span id="TDAnalytics-142"><a href="#TDAnalytics-142"><span class="linenos">142</span></a>
</span><span id="TDAnalytics-143"><a href="#TDAnalytics-143"><span class="linenos">143</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics-144"><a href="#TDAnalytics-144"><span class="linenos">144</span></a>
</span><span id="TDAnalytics-145"><a href="#TDAnalytics-145"><span class="linenos">145</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__consumer</span> <span class="o">=</span> <span class="n">consumer</span>
</span><span id="TDAnalytics-146"><a href="#TDAnalytics-146"><span class="linenos">146</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">consumer</span><span class="p">,</span> <span class="n">TDDebugConsumer</span><span class="p">):</span>
</span><span id="TDAnalytics-147"><a href="#TDAnalytics-147"><span class="linenos">147</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__strict</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="TDAnalytics-148"><a href="#TDAnalytics-148"><span class="linenos">148</span></a>        <span class="k">if</span> <span class="n">strict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="TDAnalytics-149"><a href="#TDAnalytics-149"><span class="linenos">149</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__strict</span> <span class="o">=</span> <span class="n">strict</span>
</span><span id="TDAnalytics-150"><a href="#TDAnalytics-150"><span class="linenos">150</span></a>
</span><span id="TDAnalytics-151"><a href="#TDAnalytics-151"><span class="linenos">151</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__enableUuid</span> <span class="o">=</span> <span class="n">enable_uuid</span>
</span><span id="TDAnalytics-152"><a href="#TDAnalytics-152"><span class="linenos">152</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__super_properties</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="TDAnalytics-153"><a href="#TDAnalytics-153"><span class="linenos">153</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_super_properties</span><span class="p">()</span>
</span><span id="TDAnalytics-154"><a href="#TDAnalytics-154"><span class="linenos">154</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__dynamic_super_properties_tracker</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="TDAnalytics-155"><a href="#TDAnalytics-155"><span class="linenos">155</span></a>
</span><span id="TDAnalytics-156"><a href="#TDAnalytics-156"><span class="linenos">156</span></a>        <span class="n">td_log</span><span class="p">(</span><span class="s2">&quot;init SDK success&quot;</span><span class="p">)</span>
</span><span id="TDAnalytics-157"><a href="#TDAnalytics-157"><span class="linenos">157</span></a>
</span><span id="TDAnalytics-158"><a href="#TDAnalytics-158"><span class="linenos">158</span></a>    <span class="k">def</span> <span class="nf">set_dynamic_super_properties_tracker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dynamic_super_properties_tracker</span><span class="p">):</span>
</span><span id="TDAnalytics-159"><a href="#TDAnalytics-159"><span class="linenos">159</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics-160"><a href="#TDAnalytics-160"><span class="linenos">160</span></a><span class="sd">        Set dynamic super properties.</span>
</span><span id="TDAnalytics-161"><a href="#TDAnalytics-161"><span class="linenos">161</span></a><span class="sd">        </span>
</span><span id="TDAnalytics-162"><a href="#TDAnalytics-162"><span class="linenos">162</span></a><span class="sd">        e.g.</span>
</span><span id="TDAnalytics-163"><a href="#TDAnalytics-163"><span class="linenos">163</span></a>
</span><span id="TDAnalytics-164"><a href="#TDAnalytics-164"><span class="linenos">164</span></a><span class="sd">            class DynamicPropertiesTracker(TDDynamicSuperPropertiesTracker):</span>
</span><span id="TDAnalytics-165"><a href="#TDAnalytics-165"><span class="linenos">165</span></a><span class="sd">                def get_dynamic_super_properties(self):</span>
</span><span id="TDAnalytics-166"><a href="#TDAnalytics-166"><span class="linenos">166</span></a><span class="sd">                    return {&#39;super_dynamic_key&#39;: datetime.datetime.now()}</span>
</span><span id="TDAnalytics-167"><a href="#TDAnalytics-167"><span class="linenos">167</span></a>
</span><span id="TDAnalytics-168"><a href="#TDAnalytics-168"><span class="linenos">168</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAnalytics-169"><a href="#TDAnalytics-169"><span class="linenos">169</span></a><span class="sd">        - dynamic_super_properties_tracker -- is object which has defined function: &#39;get_dynamic_super_properties()&#39;</span>
</span><span id="TDAnalytics-170"><a href="#TDAnalytics-170"><span class="linenos">170</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics-171"><a href="#TDAnalytics-171"><span class="linenos">171</span></a>        <span class="k">if</span> <span class="n">dynamic_super_properties_tracker</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="TDAnalytics-172"><a href="#TDAnalytics-172"><span class="linenos">172</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__dynamic_super_properties_tracker</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="TDAnalytics-173"><a href="#TDAnalytics-173"><span class="linenos">173</span></a>            <span class="n">td_log</span><span class="p">(</span><span class="s2">&quot;clean up dynamic super properties&quot;</span><span class="p">)</span>
</span><span id="TDAnalytics-174"><a href="#TDAnalytics-174"><span class="linenos">174</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dynamic_super_properties_tracker</span><span class="p">,</span> <span class="n">TDDynamicSuperPropertiesTracker</span><span class="p">):</span>
</span><span id="TDAnalytics-175"><a href="#TDAnalytics-175"><span class="linenos">175</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__dynamic_super_properties_tracker</span> <span class="o">=</span> <span class="n">dynamic_super_properties_tracker</span>
</span><span id="TDAnalytics-176"><a href="#TDAnalytics-176"><span class="linenos">176</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="TDAnalytics-177"><a href="#TDAnalytics-177"><span class="linenos">177</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;&#39;set_dynamic_super_properties_tracker()&#39; params type is must be &quot;</span> \
</span><span id="TDAnalytics-178"><a href="#TDAnalytics-178"><span class="linenos">178</span></a>                  <span class="s2">&quot;TDDynamicSuperPropertiesTracker or subclass. but now type is: </span><span class="si">{nowType}</span><span class="s2">&quot;</span>
</span><span id="TDAnalytics-179"><a href="#TDAnalytics-179"><span class="linenos">179</span></a>            <span class="n">td_log</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nowType</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">dynamic_super_properties_tracker</span><span class="p">)))</span>
</span><span id="TDAnalytics-180"><a href="#TDAnalytics-180"><span class="linenos">180</span></a>
</span><span id="TDAnalytics-181"><a href="#TDAnalytics-181"><span class="linenos">181</span></a>    <span class="k">def</span> <span class="nf">user_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TDAnalytics-182"><a href="#TDAnalytics-182"><span class="linenos">182</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics-183"><a href="#TDAnalytics-183"><span class="linenos">183</span></a><span class="sd">        Set user property</span>
</span><span id="TDAnalytics-184"><a href="#TDAnalytics-184"><span class="linenos">184</span></a>
</span><span id="TDAnalytics-185"><a href="#TDAnalytics-185"><span class="linenos">185</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAnalytics-186"><a href="#TDAnalytics-186"><span class="linenos">186</span></a><span class="sd">        - distinct_id: str</span>
</span><span id="TDAnalytics-187"><a href="#TDAnalytics-187"><span class="linenos">187</span></a><span class="sd">        - account_id: str</span>
</span><span id="TDAnalytics-188"><a href="#TDAnalytics-188"><span class="linenos">188</span></a><span class="sd">        - properties: dict</span>
</span><span id="TDAnalytics-189"><a href="#TDAnalytics-189"><span class="linenos">189</span></a>
</span><span id="TDAnalytics-190"><a href="#TDAnalytics-190"><span class="linenos">190</span></a><span class="sd">        Raises:</span>
</span><span id="TDAnalytics-191"><a href="#TDAnalytics-191"><span class="linenos">191</span></a><span class="sd">        - TDIllegalDataException</span>
</span><span id="TDAnalytics-192"><a href="#TDAnalytics-192"><span class="linenos">192</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics-193"><a href="#TDAnalytics-193"><span class="linenos">193</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__add</span><span class="p">(</span><span class="n">distinct_id</span><span class="o">=</span><span class="n">distinct_id</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span> <span class="n">send_type</span><span class="o">=</span><span class="s1">&#39;user_set&#39;</span><span class="p">,</span> <span class="n">properties_add</span><span class="o">=</span><span class="n">properties</span><span class="p">)</span>
</span><span id="TDAnalytics-194"><a href="#TDAnalytics-194"><span class="linenos">194</span></a>
</span><span id="TDAnalytics-195"><a href="#TDAnalytics-195"><span class="linenos">195</span></a>    <span class="k">def</span> <span class="nf">user_unset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TDAnalytics-196"><a href="#TDAnalytics-196"><span class="linenos">196</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics-197"><a href="#TDAnalytics-197"><span class="linenos">197</span></a><span class="sd">        clear user property</span>
</span><span id="TDAnalytics-198"><a href="#TDAnalytics-198"><span class="linenos">198</span></a>
</span><span id="TDAnalytics-199"><a href="#TDAnalytics-199"><span class="linenos">199</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAnalytics-200"><a href="#TDAnalytics-200"><span class="linenos">200</span></a><span class="sd">        - distinct_id: str</span>
</span><span id="TDAnalytics-201"><a href="#TDAnalytics-201"><span class="linenos">201</span></a><span class="sd">        - account_id: str</span>
</span><span id="TDAnalytics-202"><a href="#TDAnalytics-202"><span class="linenos">202</span></a><span class="sd">        - properties: list, e.g. [&#39;name&#39;, &#39;age&#39;]</span>
</span><span id="TDAnalytics-203"><a href="#TDAnalytics-203"><span class="linenos">203</span></a>
</span><span id="TDAnalytics-204"><a href="#TDAnalytics-204"><span class="linenos">204</span></a><span class="sd">        Raises:</span>
</span><span id="TDAnalytics-205"><a href="#TDAnalytics-205"><span class="linenos">205</span></a><span class="sd">            TDIllegalDataException</span>
</span><span id="TDAnalytics-206"><a href="#TDAnalytics-206"><span class="linenos">206</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics-207"><a href="#TDAnalytics-207"><span class="linenos">207</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">properties</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="TDAnalytics-208"><a href="#TDAnalytics-208"><span class="linenos">208</span></a>            <span class="n">properties</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">key</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">properties</span><span class="p">)</span>
</span><span id="TDAnalytics-209"><a href="#TDAnalytics-209"><span class="linenos">209</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__add</span><span class="p">(</span><span class="n">distinct_id</span><span class="o">=</span><span class="n">distinct_id</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span> <span class="n">send_type</span><span class="o">=</span><span class="s1">&#39;user_unset&#39;</span><span class="p">,</span> <span class="n">properties_add</span><span class="o">=</span><span class="n">properties</span><span class="p">)</span>
</span><span id="TDAnalytics-210"><a href="#TDAnalytics-210"><span class="linenos">210</span></a>
</span><span id="TDAnalytics-211"><a href="#TDAnalytics-211"><span class="linenos">211</span></a>    <span class="k">def</span> <span class="nf">user_setOnce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TDAnalytics-212"><a href="#TDAnalytics-212"><span class="linenos">212</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics-213"><a href="#TDAnalytics-213"><span class="linenos">213</span></a><span class="sd">        If the user property you want to upload only needs to be set once,you can call user_setOnce to set it.</span>
</span><span id="TDAnalytics-214"><a href="#TDAnalytics-214"><span class="linenos">214</span></a><span class="sd">        When the property has value before, this item will be ignored.</span>
</span><span id="TDAnalytics-215"><a href="#TDAnalytics-215"><span class="linenos">215</span></a>
</span><span id="TDAnalytics-216"><a href="#TDAnalytics-216"><span class="linenos">216</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAnalytics-217"><a href="#TDAnalytics-217"><span class="linenos">217</span></a><span class="sd">        - distinct_id: string</span>
</span><span id="TDAnalytics-218"><a href="#TDAnalytics-218"><span class="linenos">218</span></a><span class="sd">        - account_id: string</span>
</span><span id="TDAnalytics-219"><a href="#TDAnalytics-219"><span class="linenos">219</span></a><span class="sd">        - properties: dict</span>
</span><span id="TDAnalytics-220"><a href="#TDAnalytics-220"><span class="linenos">220</span></a>
</span><span id="TDAnalytics-221"><a href="#TDAnalytics-221"><span class="linenos">221</span></a><span class="sd">        Raises:</span>
</span><span id="TDAnalytics-222"><a href="#TDAnalytics-222"><span class="linenos">222</span></a><span class="sd">            TDIllegalDataException</span>
</span><span id="TDAnalytics-223"><a href="#TDAnalytics-223"><span class="linenos">223</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics-224"><a href="#TDAnalytics-224"><span class="linenos">224</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__add</span><span class="p">(</span><span class="n">distinct_id</span><span class="o">=</span><span class="n">distinct_id</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span> <span class="n">send_type</span><span class="o">=</span><span class="s1">&#39;user_setOnce&#39;</span><span class="p">,</span> <span class="n">properties_add</span><span class="o">=</span><span class="n">properties</span><span class="p">)</span>
</span><span id="TDAnalytics-225"><a href="#TDAnalytics-225"><span class="linenos">225</span></a>
</span><span id="TDAnalytics-226"><a href="#TDAnalytics-226"><span class="linenos">226</span></a>    <span class="k">def</span> <span class="nf">user_add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TDAnalytics-227"><a href="#TDAnalytics-227"><span class="linenos">227</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics-228"><a href="#TDAnalytics-228"><span class="linenos">228</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAnalytics-229"><a href="#TDAnalytics-229"><span class="linenos">229</span></a><span class="sd">        - distinct_id: string</span>
</span><span id="TDAnalytics-230"><a href="#TDAnalytics-230"><span class="linenos">230</span></a><span class="sd">        - account_id: string  </span>
</span><span id="TDAnalytics-231"><a href="#TDAnalytics-231"><span class="linenos">231</span></a><span class="sd">        - properties: dict. value must be number. e.g. {&#39;count&#39;: 1}</span>
</span><span id="TDAnalytics-232"><a href="#TDAnalytics-232"><span class="linenos">232</span></a>
</span><span id="TDAnalytics-233"><a href="#TDAnalytics-233"><span class="linenos">233</span></a><span class="sd">        Raises:</span>
</span><span id="TDAnalytics-234"><a href="#TDAnalytics-234"><span class="linenos">234</span></a><span class="sd">            TDIllegalDataException</span>
</span><span id="TDAnalytics-235"><a href="#TDAnalytics-235"><span class="linenos">235</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics-236"><a href="#TDAnalytics-236"><span class="linenos">236</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__add</span><span class="p">(</span><span class="n">distinct_id</span><span class="o">=</span><span class="n">distinct_id</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span> <span class="n">send_type</span><span class="o">=</span><span class="s1">&#39;user_add&#39;</span><span class="p">,</span> <span class="n">properties_add</span><span class="o">=</span><span class="n">properties</span><span class="p">)</span>
</span><span id="TDAnalytics-237"><a href="#TDAnalytics-237"><span class="linenos">237</span></a>
</span><span id="TDAnalytics-238"><a href="#TDAnalytics-238"><span class="linenos">238</span></a>    <span class="k">def</span> <span class="nf">user_append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TDAnalytics-239"><a href="#TDAnalytics-239"><span class="linenos">239</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics-240"><a href="#TDAnalytics-240"><span class="linenos">240</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAnalytics-241"><a href="#TDAnalytics-241"><span class="linenos">241</span></a><span class="sd">        - distinct_id: string</span>
</span><span id="TDAnalytics-242"><a href="#TDAnalytics-242"><span class="linenos">242</span></a><span class="sd">        - account_id: string</span>
</span><span id="TDAnalytics-243"><a href="#TDAnalytics-243"><span class="linenos">243</span></a><span class="sd">        - properties: dict</span>
</span><span id="TDAnalytics-244"><a href="#TDAnalytics-244"><span class="linenos">244</span></a>
</span><span id="TDAnalytics-245"><a href="#TDAnalytics-245"><span class="linenos">245</span></a><span class="sd">        Raises:</span>
</span><span id="TDAnalytics-246"><a href="#TDAnalytics-246"><span class="linenos">246</span></a><span class="sd">            TDIllegalDataException</span>
</span><span id="TDAnalytics-247"><a href="#TDAnalytics-247"><span class="linenos">247</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics-248"><a href="#TDAnalytics-248"><span class="linenos">248</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__add</span><span class="p">(</span><span class="n">distinct_id</span><span class="o">=</span><span class="n">distinct_id</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span> <span class="n">send_type</span><span class="o">=</span><span class="s1">&#39;user_append&#39;</span><span class="p">,</span> <span class="n">properties_add</span><span class="o">=</span><span class="n">properties</span><span class="p">)</span>
</span><span id="TDAnalytics-249"><a href="#TDAnalytics-249"><span class="linenos">249</span></a>
</span><span id="TDAnalytics-250"><a href="#TDAnalytics-250"><span class="linenos">250</span></a>    <span class="k">def</span> <span class="nf">user_uniq_append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TDAnalytics-251"><a href="#TDAnalytics-251"><span class="linenos">251</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics-252"><a href="#TDAnalytics-252"><span class="linenos">252</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAnalytics-253"><a href="#TDAnalytics-253"><span class="linenos">253</span></a><span class="sd">        - distinct_id: string</span>
</span><span id="TDAnalytics-254"><a href="#TDAnalytics-254"><span class="linenos">254</span></a><span class="sd">        - account_id: string</span>
</span><span id="TDAnalytics-255"><a href="#TDAnalytics-255"><span class="linenos">255</span></a><span class="sd">        - properties: dict</span>
</span><span id="TDAnalytics-256"><a href="#TDAnalytics-256"><span class="linenos">256</span></a>
</span><span id="TDAnalytics-257"><a href="#TDAnalytics-257"><span class="linenos">257</span></a><span class="sd">        Raises:</span>
</span><span id="TDAnalytics-258"><a href="#TDAnalytics-258"><span class="linenos">258</span></a><span class="sd">            TDIllegalDataException</span>
</span><span id="TDAnalytics-259"><a href="#TDAnalytics-259"><span class="linenos">259</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics-260"><a href="#TDAnalytics-260"><span class="linenos">260</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__add</span><span class="p">(</span><span class="n">distinct_id</span><span class="o">=</span><span class="n">distinct_id</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span> <span class="n">send_type</span><span class="o">=</span><span class="s1">&#39;user_uniq_append&#39;</span><span class="p">,</span>
</span><span id="TDAnalytics-261"><a href="#TDAnalytics-261"><span class="linenos">261</span></a>                   <span class="n">properties_add</span><span class="o">=</span><span class="n">properties</span><span class="p">)</span>
</span><span id="TDAnalytics-262"><a href="#TDAnalytics-262"><span class="linenos">262</span></a>
</span><span id="TDAnalytics-263"><a href="#TDAnalytics-263"><span class="linenos">263</span></a>    <span class="k">def</span> <span class="nf">user_del</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TDAnalytics-264"><a href="#TDAnalytics-264"><span class="linenos">264</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics-265"><a href="#TDAnalytics-265"><span class="linenos">265</span></a><span class="sd">        Delete user form TE.</span>
</span><span id="TDAnalytics-266"><a href="#TDAnalytics-266"><span class="linenos">266</span></a>
</span><span id="TDAnalytics-267"><a href="#TDAnalytics-267"><span class="linenos">267</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAnalytics-268"><a href="#TDAnalytics-268"><span class="linenos">268</span></a><span class="sd">        - distinct_id: string</span>
</span><span id="TDAnalytics-269"><a href="#TDAnalytics-269"><span class="linenos">269</span></a><span class="sd">        - account_id: string</span>
</span><span id="TDAnalytics-270"><a href="#TDAnalytics-270"><span class="linenos">270</span></a>
</span><span id="TDAnalytics-271"><a href="#TDAnalytics-271"><span class="linenos">271</span></a><span class="sd">        Raises:</span>
</span><span id="TDAnalytics-272"><a href="#TDAnalytics-272"><span class="linenos">272</span></a><span class="sd">            TDIllegalDataException</span>
</span><span id="TDAnalytics-273"><a href="#TDAnalytics-273"><span class="linenos">273</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics-274"><a href="#TDAnalytics-274"><span class="linenos">274</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__add</span><span class="p">(</span><span class="n">distinct_id</span><span class="o">=</span><span class="n">distinct_id</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span> <span class="n">send_type</span><span class="o">=</span><span class="s1">&#39;user_del&#39;</span><span class="p">)</span>
</span><span id="TDAnalytics-275"><a href="#TDAnalytics-275"><span class="linenos">275</span></a>
</span><span id="TDAnalytics-276"><a href="#TDAnalytics-276"><span class="linenos">276</span></a>    <span class="k">def</span> <span class="nf">track</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">event_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TDAnalytics-277"><a href="#TDAnalytics-277"><span class="linenos">277</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics-278"><a href="#TDAnalytics-278"><span class="linenos">278</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAnalytics-279"><a href="#TDAnalytics-279"><span class="linenos">279</span></a><span class="sd">        - distinct_id: string</span>
</span><span id="TDAnalytics-280"><a href="#TDAnalytics-280"><span class="linenos">280</span></a><span class="sd">        - account_id: string</span>
</span><span id="TDAnalytics-281"><a href="#TDAnalytics-281"><span class="linenos">281</span></a><span class="sd">        - event_name: string</span>
</span><span id="TDAnalytics-282"><a href="#TDAnalytics-282"><span class="linenos">282</span></a><span class="sd">        - properties: dict</span>
</span><span id="TDAnalytics-283"><a href="#TDAnalytics-283"><span class="linenos">283</span></a>
</span><span id="TDAnalytics-284"><a href="#TDAnalytics-284"><span class="linenos">284</span></a><span class="sd">        Raises:</span>
</span><span id="TDAnalytics-285"><a href="#TDAnalytics-285"><span class="linenos">285</span></a><span class="sd">            TDIllegalDataException</span>
</span><span id="TDAnalytics-286"><a href="#TDAnalytics-286"><span class="linenos">286</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics-287"><a href="#TDAnalytics-287"><span class="linenos">287</span></a>        <span class="n">all_properties</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_public_track_add</span><span class="p">(</span><span class="n">event_name</span><span class="p">,</span> <span class="n">properties</span><span class="p">)</span>
</span><span id="TDAnalytics-288"><a href="#TDAnalytics-288"><span class="linenos">288</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__add</span><span class="p">(</span><span class="n">distinct_id</span><span class="o">=</span><span class="n">distinct_id</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span> <span class="n">send_type</span><span class="o">=</span><span class="s1">&#39;track&#39;</span><span class="p">,</span> <span class="n">event_name</span><span class="o">=</span><span class="n">event_name</span><span class="p">,</span>
</span><span id="TDAnalytics-289"><a href="#TDAnalytics-289"><span class="linenos">289</span></a>                   <span class="n">properties_add</span><span class="o">=</span><span class="n">all_properties</span><span class="p">)</span>
</span><span id="TDAnalytics-290"><a href="#TDAnalytics-290"><span class="linenos">290</span></a>
</span><span id="TDAnalytics-291"><a href="#TDAnalytics-291"><span class="linenos">291</span></a>    <span class="k">def</span> <span class="nf">track_first</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">event_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">first_check_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TDAnalytics-292"><a href="#TDAnalytics-292"><span class="linenos">292</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics-293"><a href="#TDAnalytics-293"><span class="linenos">293</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAnalytics-294"><a href="#TDAnalytics-294"><span class="linenos">294</span></a><span class="sd">        - distinct_id: str</span>
</span><span id="TDAnalytics-295"><a href="#TDAnalytics-295"><span class="linenos">295</span></a><span class="sd">        - account_id: str</span>
</span><span id="TDAnalytics-296"><a href="#TDAnalytics-296"><span class="linenos">296</span></a><span class="sd">        - event_name: str</span>
</span><span id="TDAnalytics-297"><a href="#TDAnalytics-297"><span class="linenos">297</span></a><span class="sd">        - first_check_id: str</span>
</span><span id="TDAnalytics-298"><a href="#TDAnalytics-298"><span class="linenos">298</span></a><span class="sd">        - properties: dict</span>
</span><span id="TDAnalytics-299"><a href="#TDAnalytics-299"><span class="linenos">299</span></a>
</span><span id="TDAnalytics-300"><a href="#TDAnalytics-300"><span class="linenos">300</span></a><span class="sd">        Raises:</span>
</span><span id="TDAnalytics-301"><a href="#TDAnalytics-301"><span class="linenos">301</span></a><span class="sd">            TDIllegalDataException</span>
</span><span id="TDAnalytics-302"><a href="#TDAnalytics-302"><span class="linenos">302</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics-303"><a href="#TDAnalytics-303"><span class="linenos">303</span></a>        <span class="n">all_properties</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_public_track_add</span><span class="p">(</span><span class="n">event_name</span><span class="p">,</span> <span class="n">properties</span><span class="p">)</span>
</span><span id="TDAnalytics-304"><a href="#TDAnalytics-304"><span class="linenos">304</span></a>        <span class="k">if</span> <span class="n">first_check_id</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__strict</span><span class="p">:</span>
</span><span id="TDAnalytics-305"><a href="#TDAnalytics-305"><span class="linenos">305</span></a>            <span class="k">raise</span> <span class="n">TDException</span><span class="p">(</span><span class="s2">&quot;first_check_id must be set&quot;</span><span class="p">)</span>
</span><span id="TDAnalytics-306"><a href="#TDAnalytics-306"><span class="linenos">306</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__add</span><span class="p">(</span><span class="n">distinct_id</span><span class="o">=</span><span class="n">distinct_id</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span> <span class="n">send_type</span><span class="o">=</span><span class="s1">&#39;track&#39;</span><span class="p">,</span> <span class="n">event_id</span><span class="o">=</span><span class="n">first_check_id</span><span class="p">,</span>
</span><span id="TDAnalytics-307"><a href="#TDAnalytics-307"><span class="linenos">307</span></a>                   <span class="n">event_name</span><span class="o">=</span><span class="n">event_name</span><span class="p">,</span>
</span><span id="TDAnalytics-308"><a href="#TDAnalytics-308"><span class="linenos">308</span></a>                   <span class="n">properties_add</span><span class="o">=</span><span class="n">all_properties</span><span class="p">)</span>
</span><span id="TDAnalytics-309"><a href="#TDAnalytics-309"><span class="linenos">309</span></a>
</span><span id="TDAnalytics-310"><a href="#TDAnalytics-310"><span class="linenos">310</span></a>    <span class="k">def</span> <span class="nf">track_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">event_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">event_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TDAnalytics-311"><a href="#TDAnalytics-311"><span class="linenos">311</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics-312"><a href="#TDAnalytics-312"><span class="linenos">312</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAnalytics-313"><a href="#TDAnalytics-313"><span class="linenos">313</span></a><span class="sd">        - distinct_id: str</span>
</span><span id="TDAnalytics-314"><a href="#TDAnalytics-314"><span class="linenos">314</span></a><span class="sd">        - account_id: str</span>
</span><span id="TDAnalytics-315"><a href="#TDAnalytics-315"><span class="linenos">315</span></a><span class="sd">        - event_name: str</span>
</span><span id="TDAnalytics-316"><a href="#TDAnalytics-316"><span class="linenos">316</span></a><span class="sd">        - event_id: str</span>
</span><span id="TDAnalytics-317"><a href="#TDAnalytics-317"><span class="linenos">317</span></a><span class="sd">        - properties: dict</span>
</span><span id="TDAnalytics-318"><a href="#TDAnalytics-318"><span class="linenos">318</span></a>
</span><span id="TDAnalytics-319"><a href="#TDAnalytics-319"><span class="linenos">319</span></a><span class="sd">        Raises:</span>
</span><span id="TDAnalytics-320"><a href="#TDAnalytics-320"><span class="linenos">320</span></a><span class="sd">            TDIllegalDataException</span>
</span><span id="TDAnalytics-321"><a href="#TDAnalytics-321"><span class="linenos">321</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics-322"><a href="#TDAnalytics-322"><span class="linenos">322</span></a>        <span class="k">if</span> <span class="n">event_id</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__strict</span><span class="p">:</span>
</span><span id="TDAnalytics-323"><a href="#TDAnalytics-323"><span class="linenos">323</span></a>            <span class="k">raise</span> <span class="n">TDException</span><span class="p">(</span><span class="s2">&quot;event_id must be set&quot;</span><span class="p">)</span>
</span><span id="TDAnalytics-324"><a href="#TDAnalytics-324"><span class="linenos">324</span></a>
</span><span id="TDAnalytics-325"><a href="#TDAnalytics-325"><span class="linenos">325</span></a>        <span class="n">all_properties</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_public_track_add</span><span class="p">(</span><span class="n">event_name</span><span class="p">,</span> <span class="n">properties</span><span class="p">)</span>
</span><span id="TDAnalytics-326"><a href="#TDAnalytics-326"><span class="linenos">326</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__add</span><span class="p">(</span><span class="n">distinct_id</span><span class="o">=</span><span class="n">distinct_id</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span> <span class="n">send_type</span><span class="o">=</span><span class="s1">&#39;track_update&#39;</span><span class="p">,</span> <span class="n">event_name</span><span class="o">=</span><span class="n">event_name</span><span class="p">,</span>
</span><span id="TDAnalytics-327"><a href="#TDAnalytics-327"><span class="linenos">327</span></a>                   <span class="n">event_id</span><span class="o">=</span><span class="n">event_id</span><span class="p">,</span> <span class="n">properties_add</span><span class="o">=</span><span class="n">all_properties</span><span class="p">)</span>
</span><span id="TDAnalytics-328"><a href="#TDAnalytics-328"><span class="linenos">328</span></a>
</span><span id="TDAnalytics-329"><a href="#TDAnalytics-329"><span class="linenos">329</span></a>    <span class="k">def</span> <span class="nf">track_overwrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">event_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">event_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TDAnalytics-330"><a href="#TDAnalytics-330"><span class="linenos">330</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics-331"><a href="#TDAnalytics-331"><span class="linenos">331</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAnalytics-332"><a href="#TDAnalytics-332"><span class="linenos">332</span></a><span class="sd">        - distinct_id: str</span>
</span><span id="TDAnalytics-333"><a href="#TDAnalytics-333"><span class="linenos">333</span></a><span class="sd">        - account_id: str</span>
</span><span id="TDAnalytics-334"><a href="#TDAnalytics-334"><span class="linenos">334</span></a><span class="sd">        - event_name: str</span>
</span><span id="TDAnalytics-335"><a href="#TDAnalytics-335"><span class="linenos">335</span></a><span class="sd">        - event_id: str</span>
</span><span id="TDAnalytics-336"><a href="#TDAnalytics-336"><span class="linenos">336</span></a><span class="sd">        - properties: dict</span>
</span><span id="TDAnalytics-337"><a href="#TDAnalytics-337"><span class="linenos">337</span></a>
</span><span id="TDAnalytics-338"><a href="#TDAnalytics-338"><span class="linenos">338</span></a><span class="sd">        Raises:</span>
</span><span id="TDAnalytics-339"><a href="#TDAnalytics-339"><span class="linenos">339</span></a><span class="sd">            TDIllegalDataException</span>
</span><span id="TDAnalytics-340"><a href="#TDAnalytics-340"><span class="linenos">340</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics-341"><a href="#TDAnalytics-341"><span class="linenos">341</span></a>        <span class="k">if</span> <span class="n">event_id</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__strict</span><span class="p">:</span>
</span><span id="TDAnalytics-342"><a href="#TDAnalytics-342"><span class="linenos">342</span></a>            <span class="k">raise</span> <span class="n">TDException</span><span class="p">(</span><span class="s2">&quot;event_id must be set&quot;</span><span class="p">)</span>
</span><span id="TDAnalytics-343"><a href="#TDAnalytics-343"><span class="linenos">343</span></a>        <span class="n">all_properties</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_public_track_add</span><span class="p">(</span><span class="n">event_name</span><span class="p">,</span> <span class="n">properties</span><span class="p">)</span>
</span><span id="TDAnalytics-344"><a href="#TDAnalytics-344"><span class="linenos">344</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__add</span><span class="p">(</span><span class="n">distinct_id</span><span class="o">=</span><span class="n">distinct_id</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span> <span class="n">send_type</span><span class="o">=</span><span class="s1">&#39;track_overwrite&#39;</span><span class="p">,</span> <span class="n">event_name</span><span class="o">=</span><span class="n">event_name</span><span class="p">,</span>
</span><span id="TDAnalytics-345"><a href="#TDAnalytics-345"><span class="linenos">345</span></a>                   <span class="n">event_id</span><span class="o">=</span><span class="n">event_id</span><span class="p">,</span> <span class="n">properties_add</span><span class="o">=</span><span class="n">all_properties</span><span class="p">)</span>
</span><span id="TDAnalytics-346"><a href="#TDAnalytics-346"><span class="linenos">346</span></a>
</span><span id="TDAnalytics-347"><a href="#TDAnalytics-347"><span class="linenos">347</span></a>    <span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TDAnalytics-348"><a href="#TDAnalytics-348"><span class="linenos">348</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics-349"><a href="#TDAnalytics-349"><span class="linenos">349</span></a><span class="sd">        Upload data immediately</span>
</span><span id="TDAnalytics-350"><a href="#TDAnalytics-350"><span class="linenos">350</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics-351"><a href="#TDAnalytics-351"><span class="linenos">351</span></a>        <span class="n">td_log</span><span class="p">(</span><span class="s2">&quot;flush data immediately&quot;</span><span class="p">)</span>
</span><span id="TDAnalytics-352"><a href="#TDAnalytics-352"><span class="linenos">352</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__consumer</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span><span id="TDAnalytics-353"><a href="#TDAnalytics-353"><span class="linenos">353</span></a>
</span><span id="TDAnalytics-354"><a href="#TDAnalytics-354"><span class="linenos">354</span></a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TDAnalytics-355"><a href="#TDAnalytics-355"><span class="linenos">355</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics-356"><a href="#TDAnalytics-356"><span class="linenos">356</span></a><span class="sd">        Please call this api before exiting to avoid data loss in the cache</span>
</span><span id="TDAnalytics-357"><a href="#TDAnalytics-357"><span class="linenos">357</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics-358"><a href="#TDAnalytics-358"><span class="linenos">358</span></a>        <span class="n">td_log</span><span class="p">(</span><span class="s2">&quot;close SDK&quot;</span><span class="p">)</span>
</span><span id="TDAnalytics-359"><a href="#TDAnalytics-359"><span class="linenos">359</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__consumer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="TDAnalytics-360"><a href="#TDAnalytics-360"><span class="linenos">360</span></a>
</span><span id="TDAnalytics-361"><a href="#TDAnalytics-361"><span class="linenos">361</span></a>    <span class="k">def</span> <span class="nf">_public_track_add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_name</span><span class="p">,</span> <span class="n">properties</span><span class="p">):</span>
</span><span id="TDAnalytics-362"><a href="#TDAnalytics-362"><span class="linenos">362</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_str</span><span class="p">(</span><span class="n">event_name</span><span class="p">):</span>
</span><span id="TDAnalytics-363"><a href="#TDAnalytics-363"><span class="linenos">363</span></a>            <span class="k">raise</span> <span class="n">TDIllegalDataException</span><span class="p">(</span><span class="s1">&#39;a string type event_name is required for track&#39;</span><span class="p">)</span>
</span><span id="TDAnalytics-364"><a href="#TDAnalytics-364"><span class="linenos">364</span></a>
</span><span id="TDAnalytics-365"><a href="#TDAnalytics-365"><span class="linenos">365</span></a>        <span class="n">all_properties</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="TDAnalytics-366"><a href="#TDAnalytics-366"><span class="linenos">366</span></a>            <span class="s1">&#39;#lib&#39;</span><span class="p">:</span> <span class="s1">&#39;tga_python_sdk&#39;</span><span class="p">,</span>
</span><span id="TDAnalytics-367"><a href="#TDAnalytics-367"><span class="linenos">367</span></a>            <span class="s1">&#39;#lib_version&#39;</span><span class="p">:</span> <span class="n">__version__</span><span class="p">,</span>
</span><span id="TDAnalytics-368"><a href="#TDAnalytics-368"><span class="linenos">368</span></a>        <span class="p">}</span>
</span><span id="TDAnalytics-369"><a href="#TDAnalytics-369"><span class="linenos">369</span></a>        <span class="n">all_properties</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__super_properties</span><span class="p">)</span>
</span><span id="TDAnalytics-370"><a href="#TDAnalytics-370"><span class="linenos">370</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__dynamic_super_properties_tracker</span><span class="p">,</span> <span class="n">TDDynamicSuperPropertiesTracker</span><span class="p">):</span>
</span><span id="TDAnalytics-371"><a href="#TDAnalytics-371"><span class="linenos">371</span></a>            <span class="n">all_properties</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__dynamic_super_properties_tracker</span><span class="o">.</span><span class="n">get_dynamic_super_properties</span><span class="p">())</span>
</span><span id="TDAnalytics-372"><a href="#TDAnalytics-372"><span class="linenos">372</span></a>        <span class="k">if</span> <span class="n">properties</span><span class="p">:</span>
</span><span id="TDAnalytics-373"><a href="#TDAnalytics-373"><span class="linenos">373</span></a>            <span class="n">all_properties</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">properties</span><span class="p">)</span>
</span><span id="TDAnalytics-374"><a href="#TDAnalytics-374"><span class="linenos">374</span></a>        <span class="k">return</span> <span class="n">all_properties</span>
</span><span id="TDAnalytics-375"><a href="#TDAnalytics-375"><span class="linenos">375</span></a>        <span class="k">pass</span>
</span><span id="TDAnalytics-376"><a href="#TDAnalytics-376"><span class="linenos">376</span></a>
</span><span id="TDAnalytics-377"><a href="#TDAnalytics-377"><span class="linenos">377</span></a>    <span class="k">def</span> <span class="nf">__add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distinct_id</span><span class="p">,</span> <span class="n">account_id</span><span class="p">,</span> <span class="n">send_type</span><span class="p">,</span> <span class="n">event_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">event_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">properties_add</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TDAnalytics-378"><a href="#TDAnalytics-378"><span class="linenos">378</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__strict</span><span class="p">:</span>
</span><span id="TDAnalytics-379"><a href="#TDAnalytics-379"><span class="linenos">379</span></a>            <span class="n">is_empty_distinct_id</span> <span class="o">=</span> <span class="n">distinct_id</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">distinct_id</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">distinct_id</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="TDAnalytics-380"><a href="#TDAnalytics-380"><span class="linenos">380</span></a>            <span class="n">is_empty_account_id</span> <span class="o">=</span> <span class="n">account_id</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">account_id</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">account_id</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="TDAnalytics-381"><a href="#TDAnalytics-381"><span class="linenos">381</span></a>            <span class="k">if</span> <span class="n">is_empty_distinct_id</span> <span class="ow">and</span> <span class="n">is_empty_account_id</span><span class="p">:</span>
</span><span id="TDAnalytics-382"><a href="#TDAnalytics-382"><span class="linenos">382</span></a>                <span class="k">raise</span> <span class="n">TDException</span><span class="p">(</span><span class="s2">&quot;Distinct_id and account_id must be set at least one&quot;</span><span class="p">)</span>
</span><span id="TDAnalytics-383"><a href="#TDAnalytics-383"><span class="linenos">383</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;#type&#39;</span><span class="p">:</span> <span class="n">send_type</span><span class="p">}</span>
</span><span id="TDAnalytics-384"><a href="#TDAnalytics-384"><span class="linenos">384</span></a>        <span class="k">if</span> <span class="n">send_type</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;track&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="TDAnalytics-385"><a href="#TDAnalytics-385"><span class="linenos">385</span></a>            <span class="c1"># add event id or first_check_id</span>
</span><span id="TDAnalytics-386"><a href="#TDAnalytics-386"><span class="linenos">386</span></a>            <span class="k">if</span> <span class="n">event_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="TDAnalytics-387"><a href="#TDAnalytics-387"><span class="linenos">387</span></a>                <span class="k">if</span> <span class="n">send_type</span> <span class="o">==</span> <span class="s2">&quot;track&quot;</span><span class="p">:</span>
</span><span id="TDAnalytics-388"><a href="#TDAnalytics-388"><span class="linenos">388</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">__buildData</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;#first_check_id&#39;</span><span class="p">,</span> <span class="n">event_id</span><span class="p">)</span>
</span><span id="TDAnalytics-389"><a href="#TDAnalytics-389"><span class="linenos">389</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="TDAnalytics-390"><a href="#TDAnalytics-390"><span class="linenos">390</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">__buildData</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;#event_id&#39;</span><span class="p">,</span> <span class="n">event_id</span><span class="p">)</span>
</span><span id="TDAnalytics-391"><a href="#TDAnalytics-391"><span class="linenos">391</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="TDAnalytics-392"><a href="#TDAnalytics-392"><span class="linenos">392</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__strict</span> <span class="ow">and</span> <span class="p">(</span>
</span><span id="TDAnalytics-393"><a href="#TDAnalytics-393"><span class="linenos">393</span></a>                        <span class="n">event_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">event_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">event_name</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)):</span>
</span><span id="TDAnalytics-394"><a href="#TDAnalytics-394"><span class="linenos">394</span></a>                    <span class="k">raise</span> <span class="n">TDException</span><span class="p">(</span><span class="s2">&quot;event name must not be null&quot;</span><span class="p">)</span>
</span><span id="TDAnalytics-395"><a href="#TDAnalytics-395"><span class="linenos">395</span></a>
</span><span id="TDAnalytics-396"><a href="#TDAnalytics-396"><span class="linenos">396</span></a>        <span class="k">if</span> <span class="n">properties_add</span><span class="p">:</span>
</span><span id="TDAnalytics-397"><a href="#TDAnalytics-397"><span class="linenos">397</span></a>            <span class="n">properties</span> <span class="o">=</span> <span class="n">properties_add</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="TDAnalytics-398"><a href="#TDAnalytics-398"><span class="linenos">398</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="TDAnalytics-399"><a href="#TDAnalytics-399"><span class="linenos">399</span></a>            <span class="n">properties</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="TDAnalytics-400"><a href="#TDAnalytics-400"><span class="linenos">400</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__move_preset_properties</span><span class="p">([</span><span class="s2">&quot;#ip&quot;</span><span class="p">,</span> <span class="s2">&quot;#first_check_id&quot;</span><span class="p">,</span> <span class="s2">&quot;#app_id&quot;</span><span class="p">,</span> <span class="s2">&quot;#time&quot;</span><span class="p">,</span> <span class="s1">&#39;#uuid&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">,</span> <span class="n">properties</span><span class="p">)</span>
</span><span id="TDAnalytics-401"><a href="#TDAnalytics-401"><span class="linenos">401</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__strict</span><span class="p">:</span>
</span><span id="TDAnalytics-402"><a href="#TDAnalytics-402"><span class="linenos">402</span></a>            <span class="n">assert_properties</span><span class="p">(</span><span class="n">send_type</span><span class="p">,</span> <span class="n">properties</span><span class="p">)</span>
</span><span id="TDAnalytics-403"><a href="#TDAnalytics-403"><span class="linenos">403</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__enableUuid</span> <span class="ow">and</span> <span class="s2">&quot;#uuid&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="TDAnalytics-404"><a href="#TDAnalytics-404"><span class="linenos">404</span></a>            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;#uuid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>
</span><span id="TDAnalytics-405"><a href="#TDAnalytics-405"><span class="linenos">405</span></a>        <span class="k">if</span> <span class="s1">&#39;#time&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="TDAnalytics-406"><a href="#TDAnalytics-406"><span class="linenos">406</span></a>            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;#time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>
</span><span id="TDAnalytics-407"><a href="#TDAnalytics-407"><span class="linenos">407</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__buildData</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;#event_name&#39;</span><span class="p">,</span> <span class="n">event_name</span><span class="p">)</span>
</span><span id="TDAnalytics-408"><a href="#TDAnalytics-408"><span class="linenos">408</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__buildData</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;#distinct_id&#39;</span><span class="p">,</span> <span class="n">distinct_id</span><span class="p">)</span>
</span><span id="TDAnalytics-409"><a href="#TDAnalytics-409"><span class="linenos">409</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__buildData</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;#account_id&#39;</span><span class="p">,</span> <span class="n">account_id</span><span class="p">)</span>
</span><span id="TDAnalytics-410"><a href="#TDAnalytics-410"><span class="linenos">410</span></a>        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">properties</span>
</span><span id="TDAnalytics-411"><a href="#TDAnalytics-411"><span class="linenos">411</span></a>        <span class="n">content</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">separators</span><span class="o">=</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)),</span> <span class="bp">cls</span><span class="o">=</span><span class="n">TADateTimeSerializer</span><span class="p">)</span>
</span><span id="TDAnalytics-412"><a href="#TDAnalytics-412"><span class="linenos">412</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__consumer</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
</span><span id="TDAnalytics-413"><a href="#TDAnalytics-413"><span class="linenos">413</span></a>
</span><span id="TDAnalytics-414"><a href="#TDAnalytics-414"><span class="linenos">414</span></a>    <span class="k">def</span> <span class="nf">__buildData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="TDAnalytics-415"><a href="#TDAnalytics-415"><span class="linenos">415</span></a>        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="TDAnalytics-416"><a href="#TDAnalytics-416"><span class="linenos">416</span></a>            <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="TDAnalytics-417"><a href="#TDAnalytics-417"><span class="linenos">417</span></a>
</span><span id="TDAnalytics-418"><a href="#TDAnalytics-418"><span class="linenos">418</span></a>    <span class="k">def</span> <span class="nf">__move_preset_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">properties</span><span class="p">):</span>
</span><span id="TDAnalytics-419"><a href="#TDAnalytics-419"><span class="linenos">419</span></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
</span><span id="TDAnalytics-420"><a href="#TDAnalytics-420"><span class="linenos">420</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">properties</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="TDAnalytics-421"><a href="#TDAnalytics-421"><span class="linenos">421</span></a>                <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">properties</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="TDAnalytics-422"><a href="#TDAnalytics-422"><span class="linenos">422</span></a>                <span class="k">del</span> <span class="p">(</span><span class="n">properties</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="TDAnalytics-423"><a href="#TDAnalytics-423"><span class="linenos">423</span></a>
</span><span id="TDAnalytics-424"><a href="#TDAnalytics-424"><span class="linenos">424</span></a>    <span class="k">def</span> <span class="nf">clear_super_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TDAnalytics-425"><a href="#TDAnalytics-425"><span class="linenos">425</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__super_properties</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="TDAnalytics-426"><a href="#TDAnalytics-426"><span class="linenos">426</span></a>            <span class="s1">&#39;#lib&#39;</span><span class="p">:</span> <span class="s1">&#39;tga_python_sdk&#39;</span><span class="p">,</span>
</span><span id="TDAnalytics-427"><a href="#TDAnalytics-427"><span class="linenos">427</span></a>            <span class="s1">&#39;#lib_version&#39;</span><span class="p">:</span> <span class="n">__version__</span><span class="p">,</span>
</span><span id="TDAnalytics-428"><a href="#TDAnalytics-428"><span class="linenos">428</span></a>        <span class="p">}</span>
</span><span id="TDAnalytics-429"><a href="#TDAnalytics-429"><span class="linenos">429</span></a>
</span><span id="TDAnalytics-430"><a href="#TDAnalytics-430"><span class="linenos">430</span></a>    <span class="k">def</span> <span class="nf">set_super_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">super_properties</span><span class="p">):</span>
</span><span id="TDAnalytics-431"><a href="#TDAnalytics-431"><span class="linenos">431</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics-432"><a href="#TDAnalytics-432"><span class="linenos">432</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAnalytics-433"><a href="#TDAnalytics-433"><span class="linenos">433</span></a><span class="sd">        - super_properties: dict</span>
</span><span id="TDAnalytics-434"><a href="#TDAnalytics-434"><span class="linenos">434</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics-435"><a href="#TDAnalytics-435"><span class="linenos">435</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__super_properties</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">super_properties</span><span class="p">)</span>
</span><span id="TDAnalytics-436"><a href="#TDAnalytics-436"><span class="linenos">436</span></a>
</span><span id="TDAnalytics-437"><a href="#TDAnalytics-437"><span class="linenos">437</span></a>    <span class="nd">@staticmethod</span>
</span><span id="TDAnalytics-438"><a href="#TDAnalytics-438"><span class="linenos">438</span></a>    <span class="k">def</span> <span class="nf">enableLog</span><span class="p">(</span><span class="n">isPrint</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="TDAnalytics-439"><a href="#TDAnalytics-439"><span class="linenos">439</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics-440"><a href="#TDAnalytics-440"><span class="linenos">440</span></a><span class="sd">        Is enable SDK td_log</span>
</span><span id="TDAnalytics-441"><a href="#TDAnalytics-441"><span class="linenos">441</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics-442"><a href="#TDAnalytics-442"><span class="linenos">442</span></a>        <span class="k">global</span> <span class="n">is_print</span>
</span><span id="TDAnalytics-443"><a href="#TDAnalytics-443"><span class="linenos">443</span></a>        <span class="n">is_print</span> <span class="o">=</span> <span class="n">isPrint</span>
</span></pre></div>


    

                            <div id="TDAnalytics.__init__" class="classattr">
                                        <input id="TDAnalytics.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">TDAnalytics</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">consumer</span>, </span><span class="param"><span class="n">enable_uuid</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="n">strict</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="TDAnalytics.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDAnalytics.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDAnalytics.__init__-132"><a href="#TDAnalytics.__init__-132"><span class="linenos">132</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">consumer</span><span class="p">,</span> <span class="n">enable_uuid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TDAnalytics.__init__-133"><a href="#TDAnalytics.__init__-133"><span class="linenos">133</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics.__init__-134"><a href="#TDAnalytics.__init__-134"><span class="linenos">134</span></a><span class="sd">        - TDLogConsumer: Write local files in batches</span>
</span><span id="TDAnalytics.__init__-135"><a href="#TDAnalytics.__init__-135"><span class="linenos">135</span></a><span class="sd">        - TDBatchConsumer: Transfer data to the TE server in batches(synchronous blocking)</span>
</span><span id="TDAnalytics.__init__-136"><a href="#TDAnalytics.__init__-136"><span class="linenos">136</span></a><span class="sd">        - TDAsyncBatchConsumer:Transfer data to the TE server in batches(asynchronous blocking)</span>
</span><span id="TDAnalytics.__init__-137"><a href="#TDAnalytics.__init__-137"><span class="linenos">137</span></a><span class="sd">        - TDDebugConsumer: Send data one by one, and strictly verify the data format</span>
</span><span id="TDAnalytics.__init__-138"><a href="#TDAnalytics.__init__-138"><span class="linenos">138</span></a>
</span><span id="TDAnalytics.__init__-139"><a href="#TDAnalytics.__init__-139"><span class="linenos">139</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAnalytics.__init__-140"><a href="#TDAnalytics.__init__-140"><span class="linenos">140</span></a><span class="sd">        - consumer -- required</span>
</span><span id="TDAnalytics.__init__-141"><a href="#TDAnalytics.__init__-141"><span class="linenos">141</span></a><span class="sd">        - enable_uuid -- true,false</span>
</span><span id="TDAnalytics.__init__-142"><a href="#TDAnalytics.__init__-142"><span class="linenos">142</span></a>
</span><span id="TDAnalytics.__init__-143"><a href="#TDAnalytics.__init__-143"><span class="linenos">143</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics.__init__-144"><a href="#TDAnalytics.__init__-144"><span class="linenos">144</span></a>
</span><span id="TDAnalytics.__init__-145"><a href="#TDAnalytics.__init__-145"><span class="linenos">145</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__consumer</span> <span class="o">=</span> <span class="n">consumer</span>
</span><span id="TDAnalytics.__init__-146"><a href="#TDAnalytics.__init__-146"><span class="linenos">146</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">consumer</span><span class="p">,</span> <span class="n">TDDebugConsumer</span><span class="p">):</span>
</span><span id="TDAnalytics.__init__-147"><a href="#TDAnalytics.__init__-147"><span class="linenos">147</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__strict</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="TDAnalytics.__init__-148"><a href="#TDAnalytics.__init__-148"><span class="linenos">148</span></a>        <span class="k">if</span> <span class="n">strict</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="TDAnalytics.__init__-149"><a href="#TDAnalytics.__init__-149"><span class="linenos">149</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__strict</span> <span class="o">=</span> <span class="n">strict</span>
</span><span id="TDAnalytics.__init__-150"><a href="#TDAnalytics.__init__-150"><span class="linenos">150</span></a>
</span><span id="TDAnalytics.__init__-151"><a href="#TDAnalytics.__init__-151"><span class="linenos">151</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__enableUuid</span> <span class="o">=</span> <span class="n">enable_uuid</span>
</span><span id="TDAnalytics.__init__-152"><a href="#TDAnalytics.__init__-152"><span class="linenos">152</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__super_properties</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="TDAnalytics.__init__-153"><a href="#TDAnalytics.__init__-153"><span class="linenos">153</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">clear_super_properties</span><span class="p">()</span>
</span><span id="TDAnalytics.__init__-154"><a href="#TDAnalytics.__init__-154"><span class="linenos">154</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__dynamic_super_properties_tracker</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="TDAnalytics.__init__-155"><a href="#TDAnalytics.__init__-155"><span class="linenos">155</span></a>
</span><span id="TDAnalytics.__init__-156"><a href="#TDAnalytics.__init__-156"><span class="linenos">156</span></a>        <span class="n">td_log</span><span class="p">(</span><span class="s2">&quot;init SDK success&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><ul>
<li>TDLogConsumer: Write local files in batches</li>
<li>TDBatchConsumer: Transfer data to the TE server in batches(synchronous blocking)</li>
<li>TDAsyncBatchConsumer:Transfer data to the TE server in batches(asynchronous blocking)</li>
<li>TDDebugConsumer: Send data one by one, and strictly verify the data format</li>
</ul>

<p>Parameters:</p>

<ul>
<li>consumer -- required</li>
<li>enable_uuid -- true,false</li>
</ul>
</div>


                            </div>
                            <div id="TDAnalytics.set_dynamic_super_properties_tracker" class="classattr">
                                        <input id="TDAnalytics.set_dynamic_super_properties_tracker-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_dynamic_super_properties_tracker</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">dynamic_super_properties_tracker</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDAnalytics.set_dynamic_super_properties_tracker-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDAnalytics.set_dynamic_super_properties_tracker"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDAnalytics.set_dynamic_super_properties_tracker-158"><a href="#TDAnalytics.set_dynamic_super_properties_tracker-158"><span class="linenos">158</span></a>    <span class="k">def</span> <span class="nf">set_dynamic_super_properties_tracker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dynamic_super_properties_tracker</span><span class="p">):</span>
</span><span id="TDAnalytics.set_dynamic_super_properties_tracker-159"><a href="#TDAnalytics.set_dynamic_super_properties_tracker-159"><span class="linenos">159</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics.set_dynamic_super_properties_tracker-160"><a href="#TDAnalytics.set_dynamic_super_properties_tracker-160"><span class="linenos">160</span></a><span class="sd">        Set dynamic super properties.</span>
</span><span id="TDAnalytics.set_dynamic_super_properties_tracker-161"><a href="#TDAnalytics.set_dynamic_super_properties_tracker-161"><span class="linenos">161</span></a><span class="sd">        </span>
</span><span id="TDAnalytics.set_dynamic_super_properties_tracker-162"><a href="#TDAnalytics.set_dynamic_super_properties_tracker-162"><span class="linenos">162</span></a><span class="sd">        e.g.</span>
</span><span id="TDAnalytics.set_dynamic_super_properties_tracker-163"><a href="#TDAnalytics.set_dynamic_super_properties_tracker-163"><span class="linenos">163</span></a>
</span><span id="TDAnalytics.set_dynamic_super_properties_tracker-164"><a href="#TDAnalytics.set_dynamic_super_properties_tracker-164"><span class="linenos">164</span></a><span class="sd">            class DynamicPropertiesTracker(TDDynamicSuperPropertiesTracker):</span>
</span><span id="TDAnalytics.set_dynamic_super_properties_tracker-165"><a href="#TDAnalytics.set_dynamic_super_properties_tracker-165"><span class="linenos">165</span></a><span class="sd">                def get_dynamic_super_properties(self):</span>
</span><span id="TDAnalytics.set_dynamic_super_properties_tracker-166"><a href="#TDAnalytics.set_dynamic_super_properties_tracker-166"><span class="linenos">166</span></a><span class="sd">                    return {&#39;super_dynamic_key&#39;: datetime.datetime.now()}</span>
</span><span id="TDAnalytics.set_dynamic_super_properties_tracker-167"><a href="#TDAnalytics.set_dynamic_super_properties_tracker-167"><span class="linenos">167</span></a>
</span><span id="TDAnalytics.set_dynamic_super_properties_tracker-168"><a href="#TDAnalytics.set_dynamic_super_properties_tracker-168"><span class="linenos">168</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAnalytics.set_dynamic_super_properties_tracker-169"><a href="#TDAnalytics.set_dynamic_super_properties_tracker-169"><span class="linenos">169</span></a><span class="sd">        - dynamic_super_properties_tracker -- is object which has defined function: &#39;get_dynamic_super_properties()&#39;</span>
</span><span id="TDAnalytics.set_dynamic_super_properties_tracker-170"><a href="#TDAnalytics.set_dynamic_super_properties_tracker-170"><span class="linenos">170</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics.set_dynamic_super_properties_tracker-171"><a href="#TDAnalytics.set_dynamic_super_properties_tracker-171"><span class="linenos">171</span></a>        <span class="k">if</span> <span class="n">dynamic_super_properties_tracker</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="TDAnalytics.set_dynamic_super_properties_tracker-172"><a href="#TDAnalytics.set_dynamic_super_properties_tracker-172"><span class="linenos">172</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__dynamic_super_properties_tracker</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="TDAnalytics.set_dynamic_super_properties_tracker-173"><a href="#TDAnalytics.set_dynamic_super_properties_tracker-173"><span class="linenos">173</span></a>            <span class="n">td_log</span><span class="p">(</span><span class="s2">&quot;clean up dynamic super properties&quot;</span><span class="p">)</span>
</span><span id="TDAnalytics.set_dynamic_super_properties_tracker-174"><a href="#TDAnalytics.set_dynamic_super_properties_tracker-174"><span class="linenos">174</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dynamic_super_properties_tracker</span><span class="p">,</span> <span class="n">TDDynamicSuperPropertiesTracker</span><span class="p">):</span>
</span><span id="TDAnalytics.set_dynamic_super_properties_tracker-175"><a href="#TDAnalytics.set_dynamic_super_properties_tracker-175"><span class="linenos">175</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__dynamic_super_properties_tracker</span> <span class="o">=</span> <span class="n">dynamic_super_properties_tracker</span>
</span><span id="TDAnalytics.set_dynamic_super_properties_tracker-176"><a href="#TDAnalytics.set_dynamic_super_properties_tracker-176"><span class="linenos">176</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="TDAnalytics.set_dynamic_super_properties_tracker-177"><a href="#TDAnalytics.set_dynamic_super_properties_tracker-177"><span class="linenos">177</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;&#39;set_dynamic_super_properties_tracker()&#39; params type is must be &quot;</span> \
</span><span id="TDAnalytics.set_dynamic_super_properties_tracker-178"><a href="#TDAnalytics.set_dynamic_super_properties_tracker-178"><span class="linenos">178</span></a>                  <span class="s2">&quot;TDDynamicSuperPropertiesTracker or subclass. but now type is: </span><span class="si">{nowType}</span><span class="s2">&quot;</span>
</span><span id="TDAnalytics.set_dynamic_super_properties_tracker-179"><a href="#TDAnalytics.set_dynamic_super_properties_tracker-179"><span class="linenos">179</span></a>            <span class="n">td_log</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nowType</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">dynamic_super_properties_tracker</span><span class="p">)))</span>
</span></pre></div>


            <div class="docstring"><p>Set dynamic super properties.</p>

<p>e.g.</p>

<pre><code>class DynamicPropertiesTracker(TDDynamicSuperPropertiesTracker):
    def get_dynamic_super_properties(self):
        return {'super_dynamic_key': datetime.datetime.now()}
</code></pre>

<p>Parameters:</p>

<ul>
<li>dynamic_super_properties_tracker -- is object which has defined function: 'get_dynamic_super_properties()'</li>
</ul>
</div>


                            </div>
                            <div id="TDAnalytics.user_set" class="classattr">
                                        <input id="TDAnalytics.user_set-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">user_set</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">account_id</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">properties</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDAnalytics.user_set-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDAnalytics.user_set"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDAnalytics.user_set-181"><a href="#TDAnalytics.user_set-181"><span class="linenos">181</span></a>    <span class="k">def</span> <span class="nf">user_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TDAnalytics.user_set-182"><a href="#TDAnalytics.user_set-182"><span class="linenos">182</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics.user_set-183"><a href="#TDAnalytics.user_set-183"><span class="linenos">183</span></a><span class="sd">        Set user property</span>
</span><span id="TDAnalytics.user_set-184"><a href="#TDAnalytics.user_set-184"><span class="linenos">184</span></a>
</span><span id="TDAnalytics.user_set-185"><a href="#TDAnalytics.user_set-185"><span class="linenos">185</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAnalytics.user_set-186"><a href="#TDAnalytics.user_set-186"><span class="linenos">186</span></a><span class="sd">        - distinct_id: str</span>
</span><span id="TDAnalytics.user_set-187"><a href="#TDAnalytics.user_set-187"><span class="linenos">187</span></a><span class="sd">        - account_id: str</span>
</span><span id="TDAnalytics.user_set-188"><a href="#TDAnalytics.user_set-188"><span class="linenos">188</span></a><span class="sd">        - properties: dict</span>
</span><span id="TDAnalytics.user_set-189"><a href="#TDAnalytics.user_set-189"><span class="linenos">189</span></a>
</span><span id="TDAnalytics.user_set-190"><a href="#TDAnalytics.user_set-190"><span class="linenos">190</span></a><span class="sd">        Raises:</span>
</span><span id="TDAnalytics.user_set-191"><a href="#TDAnalytics.user_set-191"><span class="linenos">191</span></a><span class="sd">        - TDIllegalDataException</span>
</span><span id="TDAnalytics.user_set-192"><a href="#TDAnalytics.user_set-192"><span class="linenos">192</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics.user_set-193"><a href="#TDAnalytics.user_set-193"><span class="linenos">193</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__add</span><span class="p">(</span><span class="n">distinct_id</span><span class="o">=</span><span class="n">distinct_id</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span> <span class="n">send_type</span><span class="o">=</span><span class="s1">&#39;user_set&#39;</span><span class="p">,</span> <span class="n">properties_add</span><span class="o">=</span><span class="n">properties</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Set user property</p>

<p>Parameters:</p>

<ul>
<li>distinct_id: str</li>
<li>account_id: str</li>
<li>properties: dict</li>
</ul>

<p>Raises:</p>

<ul>
<li>TDIllegalDataException</li>
</ul>
</div>


                            </div>
                            <div id="TDAnalytics.user_unset" class="classattr">
                                        <input id="TDAnalytics.user_unset-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">user_unset</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">account_id</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">properties</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDAnalytics.user_unset-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDAnalytics.user_unset"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDAnalytics.user_unset-195"><a href="#TDAnalytics.user_unset-195"><span class="linenos">195</span></a>    <span class="k">def</span> <span class="nf">user_unset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TDAnalytics.user_unset-196"><a href="#TDAnalytics.user_unset-196"><span class="linenos">196</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics.user_unset-197"><a href="#TDAnalytics.user_unset-197"><span class="linenos">197</span></a><span class="sd">        clear user property</span>
</span><span id="TDAnalytics.user_unset-198"><a href="#TDAnalytics.user_unset-198"><span class="linenos">198</span></a>
</span><span id="TDAnalytics.user_unset-199"><a href="#TDAnalytics.user_unset-199"><span class="linenos">199</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAnalytics.user_unset-200"><a href="#TDAnalytics.user_unset-200"><span class="linenos">200</span></a><span class="sd">        - distinct_id: str</span>
</span><span id="TDAnalytics.user_unset-201"><a href="#TDAnalytics.user_unset-201"><span class="linenos">201</span></a><span class="sd">        - account_id: str</span>
</span><span id="TDAnalytics.user_unset-202"><a href="#TDAnalytics.user_unset-202"><span class="linenos">202</span></a><span class="sd">        - properties: list, e.g. [&#39;name&#39;, &#39;age&#39;]</span>
</span><span id="TDAnalytics.user_unset-203"><a href="#TDAnalytics.user_unset-203"><span class="linenos">203</span></a>
</span><span id="TDAnalytics.user_unset-204"><a href="#TDAnalytics.user_unset-204"><span class="linenos">204</span></a><span class="sd">        Raises:</span>
</span><span id="TDAnalytics.user_unset-205"><a href="#TDAnalytics.user_unset-205"><span class="linenos">205</span></a><span class="sd">            TDIllegalDataException</span>
</span><span id="TDAnalytics.user_unset-206"><a href="#TDAnalytics.user_unset-206"><span class="linenos">206</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics.user_unset-207"><a href="#TDAnalytics.user_unset-207"><span class="linenos">207</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">properties</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="TDAnalytics.user_unset-208"><a href="#TDAnalytics.user_unset-208"><span class="linenos">208</span></a>            <span class="n">properties</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">key</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">properties</span><span class="p">)</span>
</span><span id="TDAnalytics.user_unset-209"><a href="#TDAnalytics.user_unset-209"><span class="linenos">209</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__add</span><span class="p">(</span><span class="n">distinct_id</span><span class="o">=</span><span class="n">distinct_id</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span> <span class="n">send_type</span><span class="o">=</span><span class="s1">&#39;user_unset&#39;</span><span class="p">,</span> <span class="n">properties_add</span><span class="o">=</span><span class="n">properties</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>clear user property</p>

<p>Parameters:</p>

<ul>
<li>distinct_id: str</li>
<li>account_id: str</li>
<li>properties: list, e.g. ['name', 'age']</li>
</ul>

<p>Raises:
    TDIllegalDataException</p>
</div>


                            </div>
                            <div id="TDAnalytics.user_setOnce" class="classattr">
                                        <input id="TDAnalytics.user_setOnce-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">user_setOnce</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">account_id</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">properties</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDAnalytics.user_setOnce-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDAnalytics.user_setOnce"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDAnalytics.user_setOnce-211"><a href="#TDAnalytics.user_setOnce-211"><span class="linenos">211</span></a>    <span class="k">def</span> <span class="nf">user_setOnce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TDAnalytics.user_setOnce-212"><a href="#TDAnalytics.user_setOnce-212"><span class="linenos">212</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics.user_setOnce-213"><a href="#TDAnalytics.user_setOnce-213"><span class="linenos">213</span></a><span class="sd">        If the user property you want to upload only needs to be set once,you can call user_setOnce to set it.</span>
</span><span id="TDAnalytics.user_setOnce-214"><a href="#TDAnalytics.user_setOnce-214"><span class="linenos">214</span></a><span class="sd">        When the property has value before, this item will be ignored.</span>
</span><span id="TDAnalytics.user_setOnce-215"><a href="#TDAnalytics.user_setOnce-215"><span class="linenos">215</span></a>
</span><span id="TDAnalytics.user_setOnce-216"><a href="#TDAnalytics.user_setOnce-216"><span class="linenos">216</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAnalytics.user_setOnce-217"><a href="#TDAnalytics.user_setOnce-217"><span class="linenos">217</span></a><span class="sd">        - distinct_id: string</span>
</span><span id="TDAnalytics.user_setOnce-218"><a href="#TDAnalytics.user_setOnce-218"><span class="linenos">218</span></a><span class="sd">        - account_id: string</span>
</span><span id="TDAnalytics.user_setOnce-219"><a href="#TDAnalytics.user_setOnce-219"><span class="linenos">219</span></a><span class="sd">        - properties: dict</span>
</span><span id="TDAnalytics.user_setOnce-220"><a href="#TDAnalytics.user_setOnce-220"><span class="linenos">220</span></a>
</span><span id="TDAnalytics.user_setOnce-221"><a href="#TDAnalytics.user_setOnce-221"><span class="linenos">221</span></a><span class="sd">        Raises:</span>
</span><span id="TDAnalytics.user_setOnce-222"><a href="#TDAnalytics.user_setOnce-222"><span class="linenos">222</span></a><span class="sd">            TDIllegalDataException</span>
</span><span id="TDAnalytics.user_setOnce-223"><a href="#TDAnalytics.user_setOnce-223"><span class="linenos">223</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics.user_setOnce-224"><a href="#TDAnalytics.user_setOnce-224"><span class="linenos">224</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__add</span><span class="p">(</span><span class="n">distinct_id</span><span class="o">=</span><span class="n">distinct_id</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span> <span class="n">send_type</span><span class="o">=</span><span class="s1">&#39;user_setOnce&#39;</span><span class="p">,</span> <span class="n">properties_add</span><span class="o">=</span><span class="n">properties</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>If the user property you want to upload only needs to be set once,you can call user_setOnce to set it.
When the property has value before, this item will be ignored.</p>

<p>Parameters:</p>

<ul>
<li>distinct_id: string</li>
<li>account_id: string</li>
<li>properties: dict</li>
</ul>

<p>Raises:
    TDIllegalDataException</p>
</div>


                            </div>
                            <div id="TDAnalytics.user_add" class="classattr">
                                        <input id="TDAnalytics.user_add-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">user_add</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">account_id</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">properties</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDAnalytics.user_add-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDAnalytics.user_add"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDAnalytics.user_add-226"><a href="#TDAnalytics.user_add-226"><span class="linenos">226</span></a>    <span class="k">def</span> <span class="nf">user_add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TDAnalytics.user_add-227"><a href="#TDAnalytics.user_add-227"><span class="linenos">227</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics.user_add-228"><a href="#TDAnalytics.user_add-228"><span class="linenos">228</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAnalytics.user_add-229"><a href="#TDAnalytics.user_add-229"><span class="linenos">229</span></a><span class="sd">        - distinct_id: string</span>
</span><span id="TDAnalytics.user_add-230"><a href="#TDAnalytics.user_add-230"><span class="linenos">230</span></a><span class="sd">        - account_id: string  </span>
</span><span id="TDAnalytics.user_add-231"><a href="#TDAnalytics.user_add-231"><span class="linenos">231</span></a><span class="sd">        - properties: dict. value must be number. e.g. {&#39;count&#39;: 1}</span>
</span><span id="TDAnalytics.user_add-232"><a href="#TDAnalytics.user_add-232"><span class="linenos">232</span></a>
</span><span id="TDAnalytics.user_add-233"><a href="#TDAnalytics.user_add-233"><span class="linenos">233</span></a><span class="sd">        Raises:</span>
</span><span id="TDAnalytics.user_add-234"><a href="#TDAnalytics.user_add-234"><span class="linenos">234</span></a><span class="sd">            TDIllegalDataException</span>
</span><span id="TDAnalytics.user_add-235"><a href="#TDAnalytics.user_add-235"><span class="linenos">235</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics.user_add-236"><a href="#TDAnalytics.user_add-236"><span class="linenos">236</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__add</span><span class="p">(</span><span class="n">distinct_id</span><span class="o">=</span><span class="n">distinct_id</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span> <span class="n">send_type</span><span class="o">=</span><span class="s1">&#39;user_add&#39;</span><span class="p">,</span> <span class="n">properties_add</span><span class="o">=</span><span class="n">properties</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Parameters:</p>

<ul>
<li>distinct_id: string</li>
<li>account_id: string  </li>
<li>properties: dict. value must be number. e.g. {'count': 1}</li>
</ul>

<p>Raises:
    TDIllegalDataException</p>
</div>


                            </div>
                            <div id="TDAnalytics.user_append" class="classattr">
                                        <input id="TDAnalytics.user_append-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">user_append</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">account_id</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">properties</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDAnalytics.user_append-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDAnalytics.user_append"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDAnalytics.user_append-238"><a href="#TDAnalytics.user_append-238"><span class="linenos">238</span></a>    <span class="k">def</span> <span class="nf">user_append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TDAnalytics.user_append-239"><a href="#TDAnalytics.user_append-239"><span class="linenos">239</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics.user_append-240"><a href="#TDAnalytics.user_append-240"><span class="linenos">240</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAnalytics.user_append-241"><a href="#TDAnalytics.user_append-241"><span class="linenos">241</span></a><span class="sd">        - distinct_id: string</span>
</span><span id="TDAnalytics.user_append-242"><a href="#TDAnalytics.user_append-242"><span class="linenos">242</span></a><span class="sd">        - account_id: string</span>
</span><span id="TDAnalytics.user_append-243"><a href="#TDAnalytics.user_append-243"><span class="linenos">243</span></a><span class="sd">        - properties: dict</span>
</span><span id="TDAnalytics.user_append-244"><a href="#TDAnalytics.user_append-244"><span class="linenos">244</span></a>
</span><span id="TDAnalytics.user_append-245"><a href="#TDAnalytics.user_append-245"><span class="linenos">245</span></a><span class="sd">        Raises:</span>
</span><span id="TDAnalytics.user_append-246"><a href="#TDAnalytics.user_append-246"><span class="linenos">246</span></a><span class="sd">            TDIllegalDataException</span>
</span><span id="TDAnalytics.user_append-247"><a href="#TDAnalytics.user_append-247"><span class="linenos">247</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics.user_append-248"><a href="#TDAnalytics.user_append-248"><span class="linenos">248</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__add</span><span class="p">(</span><span class="n">distinct_id</span><span class="o">=</span><span class="n">distinct_id</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span> <span class="n">send_type</span><span class="o">=</span><span class="s1">&#39;user_append&#39;</span><span class="p">,</span> <span class="n">properties_add</span><span class="o">=</span><span class="n">properties</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Parameters:</p>

<ul>
<li>distinct_id: string</li>
<li>account_id: string</li>
<li>properties: dict</li>
</ul>

<p>Raises:
    TDIllegalDataException</p>
</div>


                            </div>
                            <div id="TDAnalytics.user_uniq_append" class="classattr">
                                        <input id="TDAnalytics.user_uniq_append-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">user_uniq_append</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">account_id</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">properties</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDAnalytics.user_uniq_append-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDAnalytics.user_uniq_append"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDAnalytics.user_uniq_append-250"><a href="#TDAnalytics.user_uniq_append-250"><span class="linenos">250</span></a>    <span class="k">def</span> <span class="nf">user_uniq_append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TDAnalytics.user_uniq_append-251"><a href="#TDAnalytics.user_uniq_append-251"><span class="linenos">251</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics.user_uniq_append-252"><a href="#TDAnalytics.user_uniq_append-252"><span class="linenos">252</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAnalytics.user_uniq_append-253"><a href="#TDAnalytics.user_uniq_append-253"><span class="linenos">253</span></a><span class="sd">        - distinct_id: string</span>
</span><span id="TDAnalytics.user_uniq_append-254"><a href="#TDAnalytics.user_uniq_append-254"><span class="linenos">254</span></a><span class="sd">        - account_id: string</span>
</span><span id="TDAnalytics.user_uniq_append-255"><a href="#TDAnalytics.user_uniq_append-255"><span class="linenos">255</span></a><span class="sd">        - properties: dict</span>
</span><span id="TDAnalytics.user_uniq_append-256"><a href="#TDAnalytics.user_uniq_append-256"><span class="linenos">256</span></a>
</span><span id="TDAnalytics.user_uniq_append-257"><a href="#TDAnalytics.user_uniq_append-257"><span class="linenos">257</span></a><span class="sd">        Raises:</span>
</span><span id="TDAnalytics.user_uniq_append-258"><a href="#TDAnalytics.user_uniq_append-258"><span class="linenos">258</span></a><span class="sd">            TDIllegalDataException</span>
</span><span id="TDAnalytics.user_uniq_append-259"><a href="#TDAnalytics.user_uniq_append-259"><span class="linenos">259</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics.user_uniq_append-260"><a href="#TDAnalytics.user_uniq_append-260"><span class="linenos">260</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__add</span><span class="p">(</span><span class="n">distinct_id</span><span class="o">=</span><span class="n">distinct_id</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span> <span class="n">send_type</span><span class="o">=</span><span class="s1">&#39;user_uniq_append&#39;</span><span class="p">,</span>
</span><span id="TDAnalytics.user_uniq_append-261"><a href="#TDAnalytics.user_uniq_append-261"><span class="linenos">261</span></a>                   <span class="n">properties_add</span><span class="o">=</span><span class="n">properties</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Parameters:</p>

<ul>
<li>distinct_id: string</li>
<li>account_id: string</li>
<li>properties: dict</li>
</ul>

<p>Raises:
    TDIllegalDataException</p>
</div>


                            </div>
                            <div id="TDAnalytics.user_del" class="classattr">
                                        <input id="TDAnalytics.user_del-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">user_del</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">account_id</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDAnalytics.user_del-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDAnalytics.user_del"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDAnalytics.user_del-263"><a href="#TDAnalytics.user_del-263"><span class="linenos">263</span></a>    <span class="k">def</span> <span class="nf">user_del</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TDAnalytics.user_del-264"><a href="#TDAnalytics.user_del-264"><span class="linenos">264</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics.user_del-265"><a href="#TDAnalytics.user_del-265"><span class="linenos">265</span></a><span class="sd">        Delete user form TE.</span>
</span><span id="TDAnalytics.user_del-266"><a href="#TDAnalytics.user_del-266"><span class="linenos">266</span></a>
</span><span id="TDAnalytics.user_del-267"><a href="#TDAnalytics.user_del-267"><span class="linenos">267</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAnalytics.user_del-268"><a href="#TDAnalytics.user_del-268"><span class="linenos">268</span></a><span class="sd">        - distinct_id: string</span>
</span><span id="TDAnalytics.user_del-269"><a href="#TDAnalytics.user_del-269"><span class="linenos">269</span></a><span class="sd">        - account_id: string</span>
</span><span id="TDAnalytics.user_del-270"><a href="#TDAnalytics.user_del-270"><span class="linenos">270</span></a>
</span><span id="TDAnalytics.user_del-271"><a href="#TDAnalytics.user_del-271"><span class="linenos">271</span></a><span class="sd">        Raises:</span>
</span><span id="TDAnalytics.user_del-272"><a href="#TDAnalytics.user_del-272"><span class="linenos">272</span></a><span class="sd">            TDIllegalDataException</span>
</span><span id="TDAnalytics.user_del-273"><a href="#TDAnalytics.user_del-273"><span class="linenos">273</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics.user_del-274"><a href="#TDAnalytics.user_del-274"><span class="linenos">274</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__add</span><span class="p">(</span><span class="n">distinct_id</span><span class="o">=</span><span class="n">distinct_id</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span> <span class="n">send_type</span><span class="o">=</span><span class="s1">&#39;user_del&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Delete user form TE.</p>

<p>Parameters:</p>

<ul>
<li>distinct_id: string</li>
<li>account_id: string</li>
</ul>

<p>Raises:
    TDIllegalDataException</p>
</div>


                            </div>
                            <div id="TDAnalytics.track" class="classattr">
                                        <input id="TDAnalytics.track-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">track</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">account_id</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">event_name</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">properties</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDAnalytics.track-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDAnalytics.track"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDAnalytics.track-276"><a href="#TDAnalytics.track-276"><span class="linenos">276</span></a>    <span class="k">def</span> <span class="nf">track</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">event_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TDAnalytics.track-277"><a href="#TDAnalytics.track-277"><span class="linenos">277</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics.track-278"><a href="#TDAnalytics.track-278"><span class="linenos">278</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAnalytics.track-279"><a href="#TDAnalytics.track-279"><span class="linenos">279</span></a><span class="sd">        - distinct_id: string</span>
</span><span id="TDAnalytics.track-280"><a href="#TDAnalytics.track-280"><span class="linenos">280</span></a><span class="sd">        - account_id: string</span>
</span><span id="TDAnalytics.track-281"><a href="#TDAnalytics.track-281"><span class="linenos">281</span></a><span class="sd">        - event_name: string</span>
</span><span id="TDAnalytics.track-282"><a href="#TDAnalytics.track-282"><span class="linenos">282</span></a><span class="sd">        - properties: dict</span>
</span><span id="TDAnalytics.track-283"><a href="#TDAnalytics.track-283"><span class="linenos">283</span></a>
</span><span id="TDAnalytics.track-284"><a href="#TDAnalytics.track-284"><span class="linenos">284</span></a><span class="sd">        Raises:</span>
</span><span id="TDAnalytics.track-285"><a href="#TDAnalytics.track-285"><span class="linenos">285</span></a><span class="sd">            TDIllegalDataException</span>
</span><span id="TDAnalytics.track-286"><a href="#TDAnalytics.track-286"><span class="linenos">286</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics.track-287"><a href="#TDAnalytics.track-287"><span class="linenos">287</span></a>        <span class="n">all_properties</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_public_track_add</span><span class="p">(</span><span class="n">event_name</span><span class="p">,</span> <span class="n">properties</span><span class="p">)</span>
</span><span id="TDAnalytics.track-288"><a href="#TDAnalytics.track-288"><span class="linenos">288</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__add</span><span class="p">(</span><span class="n">distinct_id</span><span class="o">=</span><span class="n">distinct_id</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span> <span class="n">send_type</span><span class="o">=</span><span class="s1">&#39;track&#39;</span><span class="p">,</span> <span class="n">event_name</span><span class="o">=</span><span class="n">event_name</span><span class="p">,</span>
</span><span id="TDAnalytics.track-289"><a href="#TDAnalytics.track-289"><span class="linenos">289</span></a>                   <span class="n">properties_add</span><span class="o">=</span><span class="n">all_properties</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Parameters:</p>

<ul>
<li>distinct_id: string</li>
<li>account_id: string</li>
<li>event_name: string</li>
<li>properties: dict</li>
</ul>

<p>Raises:
    TDIllegalDataException</p>
</div>


                            </div>
                            <div id="TDAnalytics.track_first" class="classattr">
                                        <input id="TDAnalytics.track_first-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">track_first</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">account_id</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">event_name</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">first_check_id</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">properties</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDAnalytics.track_first-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDAnalytics.track_first"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDAnalytics.track_first-291"><a href="#TDAnalytics.track_first-291"><span class="linenos">291</span></a>    <span class="k">def</span> <span class="nf">track_first</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">event_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">first_check_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TDAnalytics.track_first-292"><a href="#TDAnalytics.track_first-292"><span class="linenos">292</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics.track_first-293"><a href="#TDAnalytics.track_first-293"><span class="linenos">293</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAnalytics.track_first-294"><a href="#TDAnalytics.track_first-294"><span class="linenos">294</span></a><span class="sd">        - distinct_id: str</span>
</span><span id="TDAnalytics.track_first-295"><a href="#TDAnalytics.track_first-295"><span class="linenos">295</span></a><span class="sd">        - account_id: str</span>
</span><span id="TDAnalytics.track_first-296"><a href="#TDAnalytics.track_first-296"><span class="linenos">296</span></a><span class="sd">        - event_name: str</span>
</span><span id="TDAnalytics.track_first-297"><a href="#TDAnalytics.track_first-297"><span class="linenos">297</span></a><span class="sd">        - first_check_id: str</span>
</span><span id="TDAnalytics.track_first-298"><a href="#TDAnalytics.track_first-298"><span class="linenos">298</span></a><span class="sd">        - properties: dict</span>
</span><span id="TDAnalytics.track_first-299"><a href="#TDAnalytics.track_first-299"><span class="linenos">299</span></a>
</span><span id="TDAnalytics.track_first-300"><a href="#TDAnalytics.track_first-300"><span class="linenos">300</span></a><span class="sd">        Raises:</span>
</span><span id="TDAnalytics.track_first-301"><a href="#TDAnalytics.track_first-301"><span class="linenos">301</span></a><span class="sd">            TDIllegalDataException</span>
</span><span id="TDAnalytics.track_first-302"><a href="#TDAnalytics.track_first-302"><span class="linenos">302</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics.track_first-303"><a href="#TDAnalytics.track_first-303"><span class="linenos">303</span></a>        <span class="n">all_properties</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_public_track_add</span><span class="p">(</span><span class="n">event_name</span><span class="p">,</span> <span class="n">properties</span><span class="p">)</span>
</span><span id="TDAnalytics.track_first-304"><a href="#TDAnalytics.track_first-304"><span class="linenos">304</span></a>        <span class="k">if</span> <span class="n">first_check_id</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__strict</span><span class="p">:</span>
</span><span id="TDAnalytics.track_first-305"><a href="#TDAnalytics.track_first-305"><span class="linenos">305</span></a>            <span class="k">raise</span> <span class="n">TDException</span><span class="p">(</span><span class="s2">&quot;first_check_id must be set&quot;</span><span class="p">)</span>
</span><span id="TDAnalytics.track_first-306"><a href="#TDAnalytics.track_first-306"><span class="linenos">306</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__add</span><span class="p">(</span><span class="n">distinct_id</span><span class="o">=</span><span class="n">distinct_id</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span> <span class="n">send_type</span><span class="o">=</span><span class="s1">&#39;track&#39;</span><span class="p">,</span> <span class="n">event_id</span><span class="o">=</span><span class="n">first_check_id</span><span class="p">,</span>
</span><span id="TDAnalytics.track_first-307"><a href="#TDAnalytics.track_first-307"><span class="linenos">307</span></a>                   <span class="n">event_name</span><span class="o">=</span><span class="n">event_name</span><span class="p">,</span>
</span><span id="TDAnalytics.track_first-308"><a href="#TDAnalytics.track_first-308"><span class="linenos">308</span></a>                   <span class="n">properties_add</span><span class="o">=</span><span class="n">all_properties</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Parameters:</p>

<ul>
<li>distinct_id: str</li>
<li>account_id: str</li>
<li>event_name: str</li>
<li>first_check_id: str</li>
<li>properties: dict</li>
</ul>

<p>Raises:
    TDIllegalDataException</p>
</div>


                            </div>
                            <div id="TDAnalytics.track_update" class="classattr">
                                        <input id="TDAnalytics.track_update-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">track_update</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">account_id</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">event_name</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">event_id</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">properties</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDAnalytics.track_update-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDAnalytics.track_update"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDAnalytics.track_update-310"><a href="#TDAnalytics.track_update-310"><span class="linenos">310</span></a>    <span class="k">def</span> <span class="nf">track_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">event_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">event_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TDAnalytics.track_update-311"><a href="#TDAnalytics.track_update-311"><span class="linenos">311</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics.track_update-312"><a href="#TDAnalytics.track_update-312"><span class="linenos">312</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAnalytics.track_update-313"><a href="#TDAnalytics.track_update-313"><span class="linenos">313</span></a><span class="sd">        - distinct_id: str</span>
</span><span id="TDAnalytics.track_update-314"><a href="#TDAnalytics.track_update-314"><span class="linenos">314</span></a><span class="sd">        - account_id: str</span>
</span><span id="TDAnalytics.track_update-315"><a href="#TDAnalytics.track_update-315"><span class="linenos">315</span></a><span class="sd">        - event_name: str</span>
</span><span id="TDAnalytics.track_update-316"><a href="#TDAnalytics.track_update-316"><span class="linenos">316</span></a><span class="sd">        - event_id: str</span>
</span><span id="TDAnalytics.track_update-317"><a href="#TDAnalytics.track_update-317"><span class="linenos">317</span></a><span class="sd">        - properties: dict</span>
</span><span id="TDAnalytics.track_update-318"><a href="#TDAnalytics.track_update-318"><span class="linenos">318</span></a>
</span><span id="TDAnalytics.track_update-319"><a href="#TDAnalytics.track_update-319"><span class="linenos">319</span></a><span class="sd">        Raises:</span>
</span><span id="TDAnalytics.track_update-320"><a href="#TDAnalytics.track_update-320"><span class="linenos">320</span></a><span class="sd">            TDIllegalDataException</span>
</span><span id="TDAnalytics.track_update-321"><a href="#TDAnalytics.track_update-321"><span class="linenos">321</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics.track_update-322"><a href="#TDAnalytics.track_update-322"><span class="linenos">322</span></a>        <span class="k">if</span> <span class="n">event_id</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__strict</span><span class="p">:</span>
</span><span id="TDAnalytics.track_update-323"><a href="#TDAnalytics.track_update-323"><span class="linenos">323</span></a>            <span class="k">raise</span> <span class="n">TDException</span><span class="p">(</span><span class="s2">&quot;event_id must be set&quot;</span><span class="p">)</span>
</span><span id="TDAnalytics.track_update-324"><a href="#TDAnalytics.track_update-324"><span class="linenos">324</span></a>
</span><span id="TDAnalytics.track_update-325"><a href="#TDAnalytics.track_update-325"><span class="linenos">325</span></a>        <span class="n">all_properties</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_public_track_add</span><span class="p">(</span><span class="n">event_name</span><span class="p">,</span> <span class="n">properties</span><span class="p">)</span>
</span><span id="TDAnalytics.track_update-326"><a href="#TDAnalytics.track_update-326"><span class="linenos">326</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__add</span><span class="p">(</span><span class="n">distinct_id</span><span class="o">=</span><span class="n">distinct_id</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span> <span class="n">send_type</span><span class="o">=</span><span class="s1">&#39;track_update&#39;</span><span class="p">,</span> <span class="n">event_name</span><span class="o">=</span><span class="n">event_name</span><span class="p">,</span>
</span><span id="TDAnalytics.track_update-327"><a href="#TDAnalytics.track_update-327"><span class="linenos">327</span></a>                   <span class="n">event_id</span><span class="o">=</span><span class="n">event_id</span><span class="p">,</span> <span class="n">properties_add</span><span class="o">=</span><span class="n">all_properties</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Parameters:</p>

<ul>
<li>distinct_id: str</li>
<li>account_id: str</li>
<li>event_name: str</li>
<li>event_id: str</li>
<li>properties: dict</li>
</ul>

<p>Raises:
    TDIllegalDataException</p>
</div>


                            </div>
                            <div id="TDAnalytics.track_overwrite" class="classattr">
                                        <input id="TDAnalytics.track_overwrite-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">track_overwrite</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">account_id</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">event_name</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">event_id</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">properties</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDAnalytics.track_overwrite-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDAnalytics.track_overwrite"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDAnalytics.track_overwrite-329"><a href="#TDAnalytics.track_overwrite-329"><span class="linenos">329</span></a>    <span class="k">def</span> <span class="nf">track_overwrite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distinct_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">event_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">event_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TDAnalytics.track_overwrite-330"><a href="#TDAnalytics.track_overwrite-330"><span class="linenos">330</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics.track_overwrite-331"><a href="#TDAnalytics.track_overwrite-331"><span class="linenos">331</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAnalytics.track_overwrite-332"><a href="#TDAnalytics.track_overwrite-332"><span class="linenos">332</span></a><span class="sd">        - distinct_id: str</span>
</span><span id="TDAnalytics.track_overwrite-333"><a href="#TDAnalytics.track_overwrite-333"><span class="linenos">333</span></a><span class="sd">        - account_id: str</span>
</span><span id="TDAnalytics.track_overwrite-334"><a href="#TDAnalytics.track_overwrite-334"><span class="linenos">334</span></a><span class="sd">        - event_name: str</span>
</span><span id="TDAnalytics.track_overwrite-335"><a href="#TDAnalytics.track_overwrite-335"><span class="linenos">335</span></a><span class="sd">        - event_id: str</span>
</span><span id="TDAnalytics.track_overwrite-336"><a href="#TDAnalytics.track_overwrite-336"><span class="linenos">336</span></a><span class="sd">        - properties: dict</span>
</span><span id="TDAnalytics.track_overwrite-337"><a href="#TDAnalytics.track_overwrite-337"><span class="linenos">337</span></a>
</span><span id="TDAnalytics.track_overwrite-338"><a href="#TDAnalytics.track_overwrite-338"><span class="linenos">338</span></a><span class="sd">        Raises:</span>
</span><span id="TDAnalytics.track_overwrite-339"><a href="#TDAnalytics.track_overwrite-339"><span class="linenos">339</span></a><span class="sd">            TDIllegalDataException</span>
</span><span id="TDAnalytics.track_overwrite-340"><a href="#TDAnalytics.track_overwrite-340"><span class="linenos">340</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics.track_overwrite-341"><a href="#TDAnalytics.track_overwrite-341"><span class="linenos">341</span></a>        <span class="k">if</span> <span class="n">event_id</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__strict</span><span class="p">:</span>
</span><span id="TDAnalytics.track_overwrite-342"><a href="#TDAnalytics.track_overwrite-342"><span class="linenos">342</span></a>            <span class="k">raise</span> <span class="n">TDException</span><span class="p">(</span><span class="s2">&quot;event_id must be set&quot;</span><span class="p">)</span>
</span><span id="TDAnalytics.track_overwrite-343"><a href="#TDAnalytics.track_overwrite-343"><span class="linenos">343</span></a>        <span class="n">all_properties</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_public_track_add</span><span class="p">(</span><span class="n">event_name</span><span class="p">,</span> <span class="n">properties</span><span class="p">)</span>
</span><span id="TDAnalytics.track_overwrite-344"><a href="#TDAnalytics.track_overwrite-344"><span class="linenos">344</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__add</span><span class="p">(</span><span class="n">distinct_id</span><span class="o">=</span><span class="n">distinct_id</span><span class="p">,</span> <span class="n">account_id</span><span class="o">=</span><span class="n">account_id</span><span class="p">,</span> <span class="n">send_type</span><span class="o">=</span><span class="s1">&#39;track_overwrite&#39;</span><span class="p">,</span> <span class="n">event_name</span><span class="o">=</span><span class="n">event_name</span><span class="p">,</span>
</span><span id="TDAnalytics.track_overwrite-345"><a href="#TDAnalytics.track_overwrite-345"><span class="linenos">345</span></a>                   <span class="n">event_id</span><span class="o">=</span><span class="n">event_id</span><span class="p">,</span> <span class="n">properties_add</span><span class="o">=</span><span class="n">all_properties</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Parameters:</p>

<ul>
<li>distinct_id: str</li>
<li>account_id: str</li>
<li>event_name: str</li>
<li>event_id: str</li>
<li>properties: dict</li>
</ul>

<p>Raises:
    TDIllegalDataException</p>
</div>


                            </div>
                            <div id="TDAnalytics.flush" class="classattr">
                                        <input id="TDAnalytics.flush-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">flush</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDAnalytics.flush-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDAnalytics.flush"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDAnalytics.flush-347"><a href="#TDAnalytics.flush-347"><span class="linenos">347</span></a>    <span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TDAnalytics.flush-348"><a href="#TDAnalytics.flush-348"><span class="linenos">348</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics.flush-349"><a href="#TDAnalytics.flush-349"><span class="linenos">349</span></a><span class="sd">        Upload data immediately</span>
</span><span id="TDAnalytics.flush-350"><a href="#TDAnalytics.flush-350"><span class="linenos">350</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics.flush-351"><a href="#TDAnalytics.flush-351"><span class="linenos">351</span></a>        <span class="n">td_log</span><span class="p">(</span><span class="s2">&quot;flush data immediately&quot;</span><span class="p">)</span>
</span><span id="TDAnalytics.flush-352"><a href="#TDAnalytics.flush-352"><span class="linenos">352</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__consumer</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Upload data immediately</p>
</div>


                            </div>
                            <div id="TDAnalytics.close" class="classattr">
                                        <input id="TDAnalytics.close-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">close</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDAnalytics.close-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDAnalytics.close"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDAnalytics.close-354"><a href="#TDAnalytics.close-354"><span class="linenos">354</span></a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TDAnalytics.close-355"><a href="#TDAnalytics.close-355"><span class="linenos">355</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics.close-356"><a href="#TDAnalytics.close-356"><span class="linenos">356</span></a><span class="sd">        Please call this api before exiting to avoid data loss in the cache</span>
</span><span id="TDAnalytics.close-357"><a href="#TDAnalytics.close-357"><span class="linenos">357</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics.close-358"><a href="#TDAnalytics.close-358"><span class="linenos">358</span></a>        <span class="n">td_log</span><span class="p">(</span><span class="s2">&quot;close SDK&quot;</span><span class="p">)</span>
</span><span id="TDAnalytics.close-359"><a href="#TDAnalytics.close-359"><span class="linenos">359</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__consumer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Please call this api before exiting to avoid data loss in the cache</p>
</div>


                            </div>
                            <div id="TDAnalytics.clear_super_properties" class="classattr">
                                        <input id="TDAnalytics.clear_super_properties-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">clear_super_properties</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDAnalytics.clear_super_properties-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDAnalytics.clear_super_properties"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDAnalytics.clear_super_properties-424"><a href="#TDAnalytics.clear_super_properties-424"><span class="linenos">424</span></a>    <span class="k">def</span> <span class="nf">clear_super_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TDAnalytics.clear_super_properties-425"><a href="#TDAnalytics.clear_super_properties-425"><span class="linenos">425</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__super_properties</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="TDAnalytics.clear_super_properties-426"><a href="#TDAnalytics.clear_super_properties-426"><span class="linenos">426</span></a>            <span class="s1">&#39;#lib&#39;</span><span class="p">:</span> <span class="s1">&#39;tga_python_sdk&#39;</span><span class="p">,</span>
</span><span id="TDAnalytics.clear_super_properties-427"><a href="#TDAnalytics.clear_super_properties-427"><span class="linenos">427</span></a>            <span class="s1">&#39;#lib_version&#39;</span><span class="p">:</span> <span class="n">__version__</span><span class="p">,</span>
</span><span id="TDAnalytics.clear_super_properties-428"><a href="#TDAnalytics.clear_super_properties-428"><span class="linenos">428</span></a>        <span class="p">}</span>
</span></pre></div>


    

                            </div>
                            <div id="TDAnalytics.set_super_properties" class="classattr">
                                        <input id="TDAnalytics.set_super_properties-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_super_properties</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">super_properties</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDAnalytics.set_super_properties-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDAnalytics.set_super_properties"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDAnalytics.set_super_properties-430"><a href="#TDAnalytics.set_super_properties-430"><span class="linenos">430</span></a>    <span class="k">def</span> <span class="nf">set_super_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">super_properties</span><span class="p">):</span>
</span><span id="TDAnalytics.set_super_properties-431"><a href="#TDAnalytics.set_super_properties-431"><span class="linenos">431</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics.set_super_properties-432"><a href="#TDAnalytics.set_super_properties-432"><span class="linenos">432</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAnalytics.set_super_properties-433"><a href="#TDAnalytics.set_super_properties-433"><span class="linenos">433</span></a><span class="sd">        - super_properties: dict</span>
</span><span id="TDAnalytics.set_super_properties-434"><a href="#TDAnalytics.set_super_properties-434"><span class="linenos">434</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics.set_super_properties-435"><a href="#TDAnalytics.set_super_properties-435"><span class="linenos">435</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__super_properties</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">super_properties</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Parameters:</p>

<ul>
<li>super_properties: dict</li>
</ul>
</div>


                            </div>
                            <div id="TDAnalytics.enableLog" class="classattr">
                                        <input id="TDAnalytics.enableLog-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">enableLog</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">isPrint</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDAnalytics.enableLog-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDAnalytics.enableLog"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDAnalytics.enableLog-437"><a href="#TDAnalytics.enableLog-437"><span class="linenos">437</span></a>    <span class="nd">@staticmethod</span>
</span><span id="TDAnalytics.enableLog-438"><a href="#TDAnalytics.enableLog-438"><span class="linenos">438</span></a>    <span class="k">def</span> <span class="nf">enableLog</span><span class="p">(</span><span class="n">isPrint</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="TDAnalytics.enableLog-439"><a href="#TDAnalytics.enableLog-439"><span class="linenos">439</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAnalytics.enableLog-440"><a href="#TDAnalytics.enableLog-440"><span class="linenos">440</span></a><span class="sd">        Is enable SDK td_log</span>
</span><span id="TDAnalytics.enableLog-441"><a href="#TDAnalytics.enableLog-441"><span class="linenos">441</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAnalytics.enableLog-442"><a href="#TDAnalytics.enableLog-442"><span class="linenos">442</span></a>        <span class="k">global</span> <span class="n">is_print</span>
</span><span id="TDAnalytics.enableLog-443"><a href="#TDAnalytics.enableLog-443"><span class="linenos">443</span></a>        <span class="n">is_print</span> <span class="o">=</span> <span class="n">isPrint</span>
</span></pre></div>


            <div class="docstring"><p>Is enable SDK td_log</p>
</div>


                            </div>
                </section>
                <section id="TDLogConsumer">
                            <input id="TDLogConsumer-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">TDLogConsumer</span>:

                <label class="view-source-button" for="TDLogConsumer-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDLogConsumer"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDLogConsumer-508"><a href="#TDLogConsumer-508"><span class="linenos">508</span></a><span class="k">class</span> <span class="nc">TDLogConsumer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="TDLogConsumer-509"><a href="#TDLogConsumer-509"><span class="linenos">509</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDLogConsumer-510"><a href="#TDLogConsumer-510"><span class="linenos">510</span></a><span class="sd">    Write data to local files in batches</span>
</span><span id="TDLogConsumer-511"><a href="#TDLogConsumer-511"><span class="linenos">511</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="TDLogConsumer-512"><a href="#TDLogConsumer-512"><span class="linenos">512</span></a>    <span class="n">_mutex</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
</span><span id="TDLogConsumer-513"><a href="#TDLogConsumer-513"><span class="linenos">513</span></a>    <span class="n">_mutex</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="TDLogConsumer-514"><a href="#TDLogConsumer-514"><span class="linenos">514</span></a>
</span><span id="TDLogConsumer-515"><a href="#TDLogConsumer-515"><span class="linenos">515</span></a>    <span class="k">class</span> <span class="nc">_FileWriter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="TDLogConsumer-516"><a href="#TDLogConsumer-516"><span class="linenos">516</span></a>        <span class="n">_writers</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="TDLogConsumer-517"><a href="#TDLogConsumer-517"><span class="linenos">517</span></a>        <span class="n">_writeMutex</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
</span><span id="TDLogConsumer-518"><a href="#TDLogConsumer-518"><span class="linenos">518</span></a>        <span class="n">_writeMutex</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="TDLogConsumer-519"><a href="#TDLogConsumer-519"><span class="linenos">519</span></a>
</span><span id="TDLogConsumer-520"><a href="#TDLogConsumer-520"><span class="linenos">520</span></a>        <span class="nd">@classmethod</span>
</span><span id="TDLogConsumer-521"><a href="#TDLogConsumer-521"><span class="linenos">521</span></a>        <span class="k">def</span> <span class="nf">instance</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="TDLogConsumer-522"><a href="#TDLogConsumer-522"><span class="linenos">522</span></a>            <span class="bp">cls</span><span class="o">.</span><span class="n">_writeMutex</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span><span id="TDLogConsumer-523"><a href="#TDLogConsumer-523"><span class="linenos">523</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="TDLogConsumer-524"><a href="#TDLogConsumer-524"><span class="linenos">524</span></a>                <span class="k">if</span> <span class="n">filename</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_writers</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="TDLogConsumer-525"><a href="#TDLogConsumer-525"><span class="linenos">525</span></a>                    <span class="n">result</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_writers</span><span class="p">[</span><span class="n">filename</span><span class="p">]</span>
</span><span id="TDLogConsumer-526"><a href="#TDLogConsumer-526"><span class="linenos">526</span></a>                    <span class="n">result</span><span class="o">.</span><span class="n">_count</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">_count</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="TDLogConsumer-527"><a href="#TDLogConsumer-527"><span class="linenos">527</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="TDLogConsumer-528"><a href="#TDLogConsumer-528"><span class="linenos">528</span></a>                    <span class="n">result</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="TDLogConsumer-529"><a href="#TDLogConsumer-529"><span class="linenos">529</span></a>                    <span class="bp">cls</span><span class="o">.</span><span class="n">_writers</span><span class="p">[</span><span class="n">filename</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
</span><span id="TDLogConsumer-530"><a href="#TDLogConsumer-530"><span class="linenos">530</span></a>                <span class="k">return</span> <span class="n">result</span>
</span><span id="TDLogConsumer-531"><a href="#TDLogConsumer-531"><span class="linenos">531</span></a>            <span class="k">finally</span><span class="p">:</span>
</span><span id="TDLogConsumer-532"><a href="#TDLogConsumer-532"><span class="linenos">532</span></a>                <span class="bp">cls</span><span class="o">.</span><span class="n">_writeMutex</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="TDLogConsumer-533"><a href="#TDLogConsumer-533"><span class="linenos">533</span></a>
</span><span id="TDLogConsumer-534"><a href="#TDLogConsumer-534"><span class="linenos">534</span></a>        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="TDLogConsumer-535"><a href="#TDLogConsumer-535"><span class="linenos">535</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span> <span class="o">=</span> <span class="n">filename</span>
</span><span id="TDLogConsumer-536"><a href="#TDLogConsumer-536"><span class="linenos">536</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
</span><span id="TDLogConsumer-537"><a href="#TDLogConsumer-537"><span class="linenos">537</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_count</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="TDLogConsumer-538"><a href="#TDLogConsumer-538"><span class="linenos">538</span></a>
</span><span id="TDLogConsumer-539"><a href="#TDLogConsumer-539"><span class="linenos">539</span></a>        <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TDLogConsumer-540"><a href="#TDLogConsumer-540"><span class="linenos">540</span></a>            <span class="n">TDLogConsumer</span><span class="o">.</span><span class="n">_FileWriter</span><span class="o">.</span><span class="n">_writeMutex</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span><span id="TDLogConsumer-541"><a href="#TDLogConsumer-541"><span class="linenos">541</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="TDLogConsumer-542"><a href="#TDLogConsumer-542"><span class="linenos">542</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_count</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="TDLogConsumer-543"><a href="#TDLogConsumer-543"><span class="linenos">543</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TDLogConsumer-544"><a href="#TDLogConsumer-544"><span class="linenos">544</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="TDLogConsumer-545"><a href="#TDLogConsumer-545"><span class="linenos">545</span></a>                    <span class="k">del</span> <span class="n">TDLogConsumer</span><span class="o">.</span><span class="n">_FileWriter</span><span class="o">.</span><span class="n">_writers</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="p">]</span>
</span><span id="TDLogConsumer-546"><a href="#TDLogConsumer-546"><span class="linenos">546</span></a>            <span class="k">finally</span><span class="p">:</span>
</span><span id="TDLogConsumer-547"><a href="#TDLogConsumer-547"><span class="linenos">547</span></a>                <span class="n">TDLogConsumer</span><span class="o">.</span><span class="n">_FileWriter</span><span class="o">.</span><span class="n">_writeMutex</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="TDLogConsumer-548"><a href="#TDLogConsumer-548"><span class="linenos">548</span></a>
</span><span id="TDLogConsumer-549"><a href="#TDLogConsumer-549"><span class="linenos">549</span></a>        <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="TDLogConsumer-550"><a href="#TDLogConsumer-550"><span class="linenos">550</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span> <span class="o">==</span> <span class="n">filename</span>
</span><span id="TDLogConsumer-551"><a href="#TDLogConsumer-551"><span class="linenos">551</span></a>
</span><span id="TDLogConsumer-552"><a href="#TDLogConsumer-552"><span class="linenos">552</span></a>        <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">messages</span><span class="p">):</span>
</span><span id="TDLogConsumer-553"><a href="#TDLogConsumer-553"><span class="linenos">553</span></a>            <span class="k">with</span> <span class="n">_TAFileLock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="p">):</span>
</span><span id="TDLogConsumer-554"><a href="#TDLogConsumer-554"><span class="linenos">554</span></a>                <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">messages</span><span class="p">:</span>
</span><span id="TDLogConsumer-555"><a href="#TDLogConsumer-555"><span class="linenos">555</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</span><span id="TDLogConsumer-556"><a href="#TDLogConsumer-556"><span class="linenos">556</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="TDLogConsumer-557"><a href="#TDLogConsumer-557"><span class="linenos">557</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span><span id="TDLogConsumer-558"><a href="#TDLogConsumer-558"><span class="linenos">558</span></a>                <span class="n">td_log</span><span class="p">(</span><span class="s2">&quot;Write data to file, count: </span><span class="si">{msgCount}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">msgCount</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">messages</span><span class="p">)))</span>
</span><span id="TDLogConsumer-559"><a href="#TDLogConsumer-559"><span class="linenos">559</span></a>
</span><span id="TDLogConsumer-560"><a href="#TDLogConsumer-560"><span class="linenos">560</span></a>    <span class="nd">@classmethod</span>
</span><span id="TDLogConsumer-561"><a href="#TDLogConsumer-561"><span class="linenos">561</span></a>    <span class="k">def</span> <span class="nf">construct_filename</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span> <span class="n">date_suffix</span><span class="p">,</span> <span class="n">file_size</span><span class="p">,</span> <span class="n">file_prefix</span><span class="p">):</span>
</span><span id="TDLogConsumer-562"><a href="#TDLogConsumer-562"><span class="linenos">562</span></a>        <span class="n">filename</span> <span class="o">=</span> <span class="n">file_prefix</span> <span class="o">+</span> <span class="s2">&quot;.log.&quot;</span> <span class="o">+</span> <span class="n">date_suffix</span> \
</span><span id="TDLogConsumer-563"><a href="#TDLogConsumer-563"><span class="linenos">563</span></a>            <span class="k">if</span> <span class="n">file_prefix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;log.&quot;</span> <span class="o">+</span> <span class="n">date_suffix</span>
</span><span id="TDLogConsumer-564"><a href="#TDLogConsumer-564"><span class="linenos">564</span></a>
</span><span id="TDLogConsumer-565"><a href="#TDLogConsumer-565"><span class="linenos">565</span></a>        <span class="k">if</span> <span class="n">file_size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TDLogConsumer-566"><a href="#TDLogConsumer-566"><span class="linenos">566</span></a>            <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="TDLogConsumer-567"><a href="#TDLogConsumer-567"><span class="linenos">567</span></a>            <span class="n">file_path</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
</span><span id="TDLogConsumer-568"><a href="#TDLogConsumer-568"><span class="linenos">568</span></a>            <span class="k">while</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">cls</span><span class="o">.</span><span class="n">file_size_out</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">file_size</span><span class="p">):</span>
</span><span id="TDLogConsumer-569"><a href="#TDLogConsumer-569"><span class="linenos">569</span></a>                <span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="TDLogConsumer-570"><a href="#TDLogConsumer-570"><span class="linenos">570</span></a>                <span class="n">file_path</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
</span><span id="TDLogConsumer-571"><a href="#TDLogConsumer-571"><span class="linenos">571</span></a>            <span class="k">return</span> <span class="n">file_path</span>
</span><span id="TDLogConsumer-572"><a href="#TDLogConsumer-572"><span class="linenos">572</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="TDLogConsumer-573"><a href="#TDLogConsumer-573"><span class="linenos">573</span></a>            <span class="k">return</span> <span class="n">directory</span> <span class="o">+</span> <span class="n">filename</span>
</span><span id="TDLogConsumer-574"><a href="#TDLogConsumer-574"><span class="linenos">574</span></a>
</span><span id="TDLogConsumer-575"><a href="#TDLogConsumer-575"><span class="linenos">575</span></a>    <span class="nd">@classmethod</span>
</span><span id="TDLogConsumer-576"><a href="#TDLogConsumer-576"><span class="linenos">576</span></a>    <span class="k">def</span> <span class="nf">file_size_out</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">file_size</span><span class="p">):</span>
</span><span id="TDLogConsumer-577"><a href="#TDLogConsumer-577"><span class="linenos">577</span></a>        <span class="n">f_size</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="TDLogConsumer-578"><a href="#TDLogConsumer-578"><span class="linenos">578</span></a>        <span class="n">f_size</span> <span class="o">=</span> <span class="n">f_size</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span>
</span><span id="TDLogConsumer-579"><a href="#TDLogConsumer-579"><span class="linenos">579</span></a>        <span class="k">if</span> <span class="n">f_size</span> <span class="o">&gt;=</span> <span class="n">file_size</span><span class="p">:</span>
</span><span id="TDLogConsumer-580"><a href="#TDLogConsumer-580"><span class="linenos">580</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="TDLogConsumer-581"><a href="#TDLogConsumer-581"><span class="linenos">581</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="TDLogConsumer-582"><a href="#TDLogConsumer-582"><span class="linenos">582</span></a>
</span><span id="TDLogConsumer-583"><a href="#TDLogConsumer-583"><span class="linenos">583</span></a>    <span class="nd">@classmethod</span>
</span><span id="TDLogConsumer-584"><a href="#TDLogConsumer-584"><span class="linenos">584</span></a>    <span class="k">def</span> <span class="nf">unlock_logging_consumer</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="TDLogConsumer-585"><a href="#TDLogConsumer-585"><span class="linenos">585</span></a>        <span class="bp">cls</span><span class="o">.</span><span class="n">_mutex</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="TDLogConsumer-586"><a href="#TDLogConsumer-586"><span class="linenos">586</span></a>
</span><span id="TDLogConsumer-587"><a href="#TDLogConsumer-587"><span class="linenos">587</span></a>    <span class="nd">@classmethod</span>
</span><span id="TDLogConsumer-588"><a href="#TDLogConsumer-588"><span class="linenos">588</span></a>    <span class="k">def</span> <span class="nf">lock_logging_consumer</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="TDLogConsumer-589"><a href="#TDLogConsumer-589"><span class="linenos">589</span></a>        <span class="bp">cls</span><span class="o">.</span><span class="n">_mutex</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span><span id="TDLogConsumer-590"><a href="#TDLogConsumer-590"><span class="linenos">590</span></a>
</span><span id="TDLogConsumer-591"><a href="#TDLogConsumer-591"><span class="linenos">591</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_directory</span><span class="p">,</span> <span class="n">log_size</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">buffer_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">rotate_mode</span><span class="o">=</span><span class="n">TD_ROTATE_MODE</span><span class="o">.</span><span class="n">DAILY</span><span class="p">,</span> <span class="n">file_prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TDLogConsumer-592"><a href="#TDLogConsumer-592"><span class="linenos">592</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDLogConsumer-593"><a href="#TDLogConsumer-593"><span class="linenos">593</span></a><span class="sd">        Write data to file</span>
</span><span id="TDLogConsumer-594"><a href="#TDLogConsumer-594"><span class="linenos">594</span></a>
</span><span id="TDLogConsumer-595"><a href="#TDLogConsumer-595"><span class="linenos">595</span></a><span class="sd">        Parameters:</span>
</span><span id="TDLogConsumer-596"><a href="#TDLogConsumer-596"><span class="linenos">596</span></a><span class="sd">        - log_directory: str. The directory where the td_log files are saved</span>
</span><span id="TDLogConsumer-597"><a href="#TDLogConsumer-597"><span class="linenos">597</span></a><span class="sd">        - log_size: The size of a single td_log file, in MB, log_size &lt;= 0 means no limit on the size of a single file</span>
</span><span id="TDLogConsumer-598"><a href="#TDLogConsumer-598"><span class="linenos">598</span></a><span class="sd">        - buffer_size: The amount of data written to the file each time, the default is to write 5 pieces at a time</span>
</span><span id="TDLogConsumer-599"><a href="#TDLogConsumer-599"><span class="linenos">599</span></a><span class="sd">        - rotate_mode: Log splitting mode, by default splitting by day</span>
</span><span id="TDLogConsumer-600"><a href="#TDLogConsumer-600"><span class="linenos">600</span></a><span class="sd">        - file_prefix: td_log file prefix</span>
</span><span id="TDLogConsumer-601"><a href="#TDLogConsumer-601"><span class="linenos">601</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDLogConsumer-602"><a href="#TDLogConsumer-602"><span class="linenos">602</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">log_directory</span><span class="p">):</span>
</span><span id="TDLogConsumer-603"><a href="#TDLogConsumer-603"><span class="linenos">603</span></a>            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">log_directory</span><span class="p">)</span>
</span><span id="TDLogConsumer-604"><a href="#TDLogConsumer-604"><span class="linenos">604</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">log_directory</span> <span class="o">=</span> <span class="n">log_directory</span>
</span><span id="TDLogConsumer-605"><a href="#TDLogConsumer-605"><span class="linenos">605</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sdf</span> <span class="o">=</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">-%H&#39;</span> <span class="k">if</span> <span class="n">rotate_mode</span> <span class="o">==</span> <span class="n">TD_ROTATE_MODE</span><span class="o">.</span><span class="n">HOURLY</span> <span class="k">else</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span>
</span><span id="TDLogConsumer-606"><a href="#TDLogConsumer-606"><span class="linenos">606</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">suffix</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sdf</span><span class="p">)</span>
</span><span id="TDLogConsumer-607"><a href="#TDLogConsumer-607"><span class="linenos">607</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_fileSize</span> <span class="o">=</span> <span class="n">log_size</span>
</span><span id="TDLogConsumer-608"><a href="#TDLogConsumer-608"><span class="linenos">608</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_directory</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">):</span>
</span><span id="TDLogConsumer-609"><a href="#TDLogConsumer-609"><span class="linenos">609</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">log_directory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_directory</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
</span><span id="TDLogConsumer-610"><a href="#TDLogConsumer-610"><span class="linenos">610</span></a>
</span><span id="TDLogConsumer-611"><a href="#TDLogConsumer-611"><span class="linenos">611</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="TDLogConsumer-612"><a href="#TDLogConsumer-612"><span class="linenos">612</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size</span> <span class="o">=</span> <span class="n">buffer_size</span>
</span><span id="TDLogConsumer-613"><a href="#TDLogConsumer-613"><span class="linenos">613</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_file_prefix</span> <span class="o">=</span> <span class="n">file_prefix</span>
</span><span id="TDLogConsumer-614"><a href="#TDLogConsumer-614"><span class="linenos">614</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lock_logging_consumer</span><span class="p">()</span>
</span><span id="TDLogConsumer-615"><a href="#TDLogConsumer-615"><span class="linenos">615</span></a>        <span class="n">filename</span> <span class="o">=</span> <span class="n">TDLogConsumer</span><span class="o">.</span><span class="n">construct_filename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_directory</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">suffix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fileSize</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_prefix</span><span class="p">)</span>
</span><span id="TDLogConsumer-616"><a href="#TDLogConsumer-616"><span class="linenos">616</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_writer</span> <span class="o">=</span> <span class="n">TDLogConsumer</span><span class="o">.</span><span class="n">_FileWriter</span><span class="o">.</span><span class="n">instance</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="TDLogConsumer-617"><a href="#TDLogConsumer-617"><span class="linenos">617</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unlock_logging_consumer</span><span class="p">()</span>
</span><span id="TDLogConsumer-618"><a href="#TDLogConsumer-618"><span class="linenos">618</span></a>        <span class="n">td_log</span><span class="p">(</span><span class="s2">&quot;init TDLogConsumer&quot;</span><span class="p">)</span>
</span><span id="TDLogConsumer-619"><a href="#TDLogConsumer-619"><span class="linenos">619</span></a>
</span><span id="TDLogConsumer-620"><a href="#TDLogConsumer-620"><span class="linenos">620</span></a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
</span><span id="TDLogConsumer-621"><a href="#TDLogConsumer-621"><span class="linenos">621</span></a>        <span class="n">log</span> <span class="o">=</span> <span class="s2">&quot;Enqueue data = </span><span class="si">{msg}</span><span class="s2">&quot;</span>
</span><span id="TDLogConsumer-622"><a href="#TDLogConsumer-622"><span class="linenos">622</span></a>        <span class="n">td_log</span><span class="p">(</span><span class="n">log</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">))</span>
</span><span id="TDLogConsumer-623"><a href="#TDLogConsumer-623"><span class="linenos">623</span></a>
</span><span id="TDLogConsumer-624"><a href="#TDLogConsumer-624"><span class="linenos">624</span></a>        <span class="n">messages</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="TDLogConsumer-625"><a href="#TDLogConsumer-625"><span class="linenos">625</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lock_logging_consumer</span><span class="p">()</span>
</span><span id="TDLogConsumer-626"><a href="#TDLogConsumer-626"><span class="linenos">626</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="TDLogConsumer-627"><a href="#TDLogConsumer-627"><span class="linenos">627</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size</span><span class="p">:</span>
</span><span id="TDLogConsumer-628"><a href="#TDLogConsumer-628"><span class="linenos">628</span></a>            <span class="n">messages</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span>
</span><span id="TDLogConsumer-629"><a href="#TDLogConsumer-629"><span class="linenos">629</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refresh_writer</span><span class="p">()</span>
</span><span id="TDLogConsumer-630"><a href="#TDLogConsumer-630"><span class="linenos">630</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="TDLogConsumer-631"><a href="#TDLogConsumer-631"><span class="linenos">631</span></a>
</span><span id="TDLogConsumer-632"><a href="#TDLogConsumer-632"><span class="linenos">632</span></a>        <span class="k">if</span> <span class="n">messages</span><span class="p">:</span>
</span><span id="TDLogConsumer-633"><a href="#TDLogConsumer-633"><span class="linenos">633</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">messages</span><span class="p">)</span>
</span><span id="TDLogConsumer-634"><a href="#TDLogConsumer-634"><span class="linenos">634</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unlock_logging_consumer</span><span class="p">()</span>
</span><span id="TDLogConsumer-635"><a href="#TDLogConsumer-635"><span class="linenos">635</span></a>
</span><span id="TDLogConsumer-636"><a href="#TDLogConsumer-636"><span class="linenos">636</span></a>    <span class="k">def</span> <span class="nf">flush_with_close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_close</span><span class="p">):</span>
</span><span id="TDLogConsumer-637"><a href="#TDLogConsumer-637"><span class="linenos">637</span></a>        <span class="n">messages</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="TDLogConsumer-638"><a href="#TDLogConsumer-638"><span class="linenos">638</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lock_logging_consumer</span><span class="p">()</span>
</span><span id="TDLogConsumer-639"><a href="#TDLogConsumer-639"><span class="linenos">639</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TDLogConsumer-640"><a href="#TDLogConsumer-640"><span class="linenos">640</span></a>            <span class="n">messages</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span>
</span><span id="TDLogConsumer-641"><a href="#TDLogConsumer-641"><span class="linenos">641</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refresh_writer</span><span class="p">()</span>
</span><span id="TDLogConsumer-642"><a href="#TDLogConsumer-642"><span class="linenos">642</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="TDLogConsumer-643"><a href="#TDLogConsumer-643"><span class="linenos">643</span></a>        <span class="k">if</span> <span class="n">messages</span><span class="p">:</span>
</span><span id="TDLogConsumer-644"><a href="#TDLogConsumer-644"><span class="linenos">644</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">messages</span><span class="p">)</span>
</span><span id="TDLogConsumer-645"><a href="#TDLogConsumer-645"><span class="linenos">645</span></a>        <span class="k">if</span> <span class="n">is_close</span><span class="p">:</span>
</span><span id="TDLogConsumer-646"><a href="#TDLogConsumer-646"><span class="linenos">646</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="TDLogConsumer-647"><a href="#TDLogConsumer-647"><span class="linenos">647</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unlock_logging_consumer</span><span class="p">()</span>
</span><span id="TDLogConsumer-648"><a href="#TDLogConsumer-648"><span class="linenos">648</span></a>
</span><span id="TDLogConsumer-649"><a href="#TDLogConsumer-649"><span class="linenos">649</span></a>    <span class="k">def</span> <span class="nf">refresh_writer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TDLogConsumer-650"><a href="#TDLogConsumer-650"><span class="linenos">650</span></a>        <span class="n">date_suffix</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sdf</span><span class="p">)</span>
</span><span id="TDLogConsumer-651"><a href="#TDLogConsumer-651"><span class="linenos">651</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">suffix</span> <span class="o">!=</span> <span class="n">date_suffix</span><span class="p">:</span>
</span><span id="TDLogConsumer-652"><a href="#TDLogConsumer-652"><span class="linenos">652</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">suffix</span> <span class="o">=</span> <span class="n">date_suffix</span>
</span><span id="TDLogConsumer-653"><a href="#TDLogConsumer-653"><span class="linenos">653</span></a>        <span class="n">filename</span> <span class="o">=</span> <span class="n">TDLogConsumer</span><span class="o">.</span><span class="n">construct_filename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_directory</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">suffix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fileSize</span><span class="p">,</span>
</span><span id="TDLogConsumer-654"><a href="#TDLogConsumer-654"><span class="linenos">654</span></a>                                                    <span class="bp">self</span><span class="o">.</span><span class="n">_file_prefix</span><span class="p">)</span>
</span><span id="TDLogConsumer-655"><a href="#TDLogConsumer-655"><span class="linenos">655</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_writer</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
</span><span id="TDLogConsumer-656"><a href="#TDLogConsumer-656"><span class="linenos">656</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="TDLogConsumer-657"><a href="#TDLogConsumer-657"><span class="linenos">657</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_writer</span> <span class="o">=</span> <span class="n">TDLogConsumer</span><span class="o">.</span><span class="n">_FileWriter</span><span class="o">.</span><span class="n">instance</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="TDLogConsumer-658"><a href="#TDLogConsumer-658"><span class="linenos">658</span></a>
</span><span id="TDLogConsumer-659"><a href="#TDLogConsumer-659"><span class="linenos">659</span></a>    <span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TDLogConsumer-660"><a href="#TDLogConsumer-660"><span class="linenos">660</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">flush_with_close</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="TDLogConsumer-661"><a href="#TDLogConsumer-661"><span class="linenos">661</span></a>
</span><span id="TDLogConsumer-662"><a href="#TDLogConsumer-662"><span class="linenos">662</span></a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TDLogConsumer-663"><a href="#TDLogConsumer-663"><span class="linenos">663</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">flush_with_close</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Write data to local files in batches</p>
</div>


                            <div id="TDLogConsumer.__init__" class="classattr">
                                        <input id="TDLogConsumer.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">TDLogConsumer</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">log_directory</span>,</span><span class="param">	<span class="n">log_size</span><span class="o">=</span><span class="mi">0</span>,</span><span class="param">	<span class="n">buffer_size</span><span class="o">=</span><span class="mi">5</span>,</span><span class="param">	<span class="n">rotate_mode</span><span class="o">=&lt;</span><span class="n"><a href="#TD_ROTATE_MODE.DAILY">TD_ROTATE_MODE.DAILY</a></span><span class="p">:</span> <span class="mi">1</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">file_prefix</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="TDLogConsumer.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDLogConsumer.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDLogConsumer.__init__-591"><a href="#TDLogConsumer.__init__-591"><span class="linenos">591</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log_directory</span><span class="p">,</span> <span class="n">log_size</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">buffer_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">rotate_mode</span><span class="o">=</span><span class="n">TD_ROTATE_MODE</span><span class="o">.</span><span class="n">DAILY</span><span class="p">,</span> <span class="n">file_prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="TDLogConsumer.__init__-592"><a href="#TDLogConsumer.__init__-592"><span class="linenos">592</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDLogConsumer.__init__-593"><a href="#TDLogConsumer.__init__-593"><span class="linenos">593</span></a><span class="sd">        Write data to file</span>
</span><span id="TDLogConsumer.__init__-594"><a href="#TDLogConsumer.__init__-594"><span class="linenos">594</span></a>
</span><span id="TDLogConsumer.__init__-595"><a href="#TDLogConsumer.__init__-595"><span class="linenos">595</span></a><span class="sd">        Parameters:</span>
</span><span id="TDLogConsumer.__init__-596"><a href="#TDLogConsumer.__init__-596"><span class="linenos">596</span></a><span class="sd">        - log_directory: str. The directory where the td_log files are saved</span>
</span><span id="TDLogConsumer.__init__-597"><a href="#TDLogConsumer.__init__-597"><span class="linenos">597</span></a><span class="sd">        - log_size: The size of a single td_log file, in MB, log_size &lt;= 0 means no limit on the size of a single file</span>
</span><span id="TDLogConsumer.__init__-598"><a href="#TDLogConsumer.__init__-598"><span class="linenos">598</span></a><span class="sd">        - buffer_size: The amount of data written to the file each time, the default is to write 5 pieces at a time</span>
</span><span id="TDLogConsumer.__init__-599"><a href="#TDLogConsumer.__init__-599"><span class="linenos">599</span></a><span class="sd">        - rotate_mode: Log splitting mode, by default splitting by day</span>
</span><span id="TDLogConsumer.__init__-600"><a href="#TDLogConsumer.__init__-600"><span class="linenos">600</span></a><span class="sd">        - file_prefix: td_log file prefix</span>
</span><span id="TDLogConsumer.__init__-601"><a href="#TDLogConsumer.__init__-601"><span class="linenos">601</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDLogConsumer.__init__-602"><a href="#TDLogConsumer.__init__-602"><span class="linenos">602</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">log_directory</span><span class="p">):</span>
</span><span id="TDLogConsumer.__init__-603"><a href="#TDLogConsumer.__init__-603"><span class="linenos">603</span></a>            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">log_directory</span><span class="p">)</span>
</span><span id="TDLogConsumer.__init__-604"><a href="#TDLogConsumer.__init__-604"><span class="linenos">604</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">log_directory</span> <span class="o">=</span> <span class="n">log_directory</span>
</span><span id="TDLogConsumer.__init__-605"><a href="#TDLogConsumer.__init__-605"><span class="linenos">605</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">sdf</span> <span class="o">=</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">-%H&#39;</span> <span class="k">if</span> <span class="n">rotate_mode</span> <span class="o">==</span> <span class="n">TD_ROTATE_MODE</span><span class="o">.</span><span class="n">HOURLY</span> <span class="k">else</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span>
</span><span id="TDLogConsumer.__init__-606"><a href="#TDLogConsumer.__init__-606"><span class="linenos">606</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">suffix</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sdf</span><span class="p">)</span>
</span><span id="TDLogConsumer.__init__-607"><a href="#TDLogConsumer.__init__-607"><span class="linenos">607</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_fileSize</span> <span class="o">=</span> <span class="n">log_size</span>
</span><span id="TDLogConsumer.__init__-608"><a href="#TDLogConsumer.__init__-608"><span class="linenos">608</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_directory</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">):</span>
</span><span id="TDLogConsumer.__init__-609"><a href="#TDLogConsumer.__init__-609"><span class="linenos">609</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">log_directory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_directory</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
</span><span id="TDLogConsumer.__init__-610"><a href="#TDLogConsumer.__init__-610"><span class="linenos">610</span></a>
</span><span id="TDLogConsumer.__init__-611"><a href="#TDLogConsumer.__init__-611"><span class="linenos">611</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="TDLogConsumer.__init__-612"><a href="#TDLogConsumer.__init__-612"><span class="linenos">612</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size</span> <span class="o">=</span> <span class="n">buffer_size</span>
</span><span id="TDLogConsumer.__init__-613"><a href="#TDLogConsumer.__init__-613"><span class="linenos">613</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_file_prefix</span> <span class="o">=</span> <span class="n">file_prefix</span>
</span><span id="TDLogConsumer.__init__-614"><a href="#TDLogConsumer.__init__-614"><span class="linenos">614</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lock_logging_consumer</span><span class="p">()</span>
</span><span id="TDLogConsumer.__init__-615"><a href="#TDLogConsumer.__init__-615"><span class="linenos">615</span></a>        <span class="n">filename</span> <span class="o">=</span> <span class="n">TDLogConsumer</span><span class="o">.</span><span class="n">construct_filename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_directory</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">suffix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fileSize</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_prefix</span><span class="p">)</span>
</span><span id="TDLogConsumer.__init__-616"><a href="#TDLogConsumer.__init__-616"><span class="linenos">616</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_writer</span> <span class="o">=</span> <span class="n">TDLogConsumer</span><span class="o">.</span><span class="n">_FileWriter</span><span class="o">.</span><span class="n">instance</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="TDLogConsumer.__init__-617"><a href="#TDLogConsumer.__init__-617"><span class="linenos">617</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unlock_logging_consumer</span><span class="p">()</span>
</span><span id="TDLogConsumer.__init__-618"><a href="#TDLogConsumer.__init__-618"><span class="linenos">618</span></a>        <span class="n">td_log</span><span class="p">(</span><span class="s2">&quot;init TDLogConsumer&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Write data to file</p>

<p>Parameters:</p>

<ul>
<li>log_directory: str. The directory where the td_log files are saved</li>
<li>log_size: The size of a single td_log file, in MB, log_size &lt;= 0 means no limit on the size of a single file</li>
<li>buffer_size: The amount of data written to the file each time, the default is to write 5 pieces at a time</li>
<li>rotate_mode: Log splitting mode, by default splitting by day</li>
<li>file_prefix: td_log file prefix</li>
</ul>
</div>


                            </div>
                            <div id="TDLogConsumer.construct_filename" class="classattr">
                                        <input id="TDLogConsumer.construct_filename-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">construct_filename</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">directory</span>, </span><span class="param"><span class="n">date_suffix</span>, </span><span class="param"><span class="n">file_size</span>, </span><span class="param"><span class="n">file_prefix</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDLogConsumer.construct_filename-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDLogConsumer.construct_filename"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDLogConsumer.construct_filename-560"><a href="#TDLogConsumer.construct_filename-560"><span class="linenos">560</span></a>    <span class="nd">@classmethod</span>
</span><span id="TDLogConsumer.construct_filename-561"><a href="#TDLogConsumer.construct_filename-561"><span class="linenos">561</span></a>    <span class="k">def</span> <span class="nf">construct_filename</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span> <span class="n">date_suffix</span><span class="p">,</span> <span class="n">file_size</span><span class="p">,</span> <span class="n">file_prefix</span><span class="p">):</span>
</span><span id="TDLogConsumer.construct_filename-562"><a href="#TDLogConsumer.construct_filename-562"><span class="linenos">562</span></a>        <span class="n">filename</span> <span class="o">=</span> <span class="n">file_prefix</span> <span class="o">+</span> <span class="s2">&quot;.log.&quot;</span> <span class="o">+</span> <span class="n">date_suffix</span> \
</span><span id="TDLogConsumer.construct_filename-563"><a href="#TDLogConsumer.construct_filename-563"><span class="linenos">563</span></a>            <span class="k">if</span> <span class="n">file_prefix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;log.&quot;</span> <span class="o">+</span> <span class="n">date_suffix</span>
</span><span id="TDLogConsumer.construct_filename-564"><a href="#TDLogConsumer.construct_filename-564"><span class="linenos">564</span></a>
</span><span id="TDLogConsumer.construct_filename-565"><a href="#TDLogConsumer.construct_filename-565"><span class="linenos">565</span></a>        <span class="k">if</span> <span class="n">file_size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TDLogConsumer.construct_filename-566"><a href="#TDLogConsumer.construct_filename-566"><span class="linenos">566</span></a>            <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="TDLogConsumer.construct_filename-567"><a href="#TDLogConsumer.construct_filename-567"><span class="linenos">567</span></a>            <span class="n">file_path</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
</span><span id="TDLogConsumer.construct_filename-568"><a href="#TDLogConsumer.construct_filename-568"><span class="linenos">568</span></a>            <span class="k">while</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">cls</span><span class="o">.</span><span class="n">file_size_out</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">file_size</span><span class="p">):</span>
</span><span id="TDLogConsumer.construct_filename-569"><a href="#TDLogConsumer.construct_filename-569"><span class="linenos">569</span></a>                <span class="n">count</span> <span class="o">=</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="TDLogConsumer.construct_filename-570"><a href="#TDLogConsumer.construct_filename-570"><span class="linenos">570</span></a>                <span class="n">file_path</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
</span><span id="TDLogConsumer.construct_filename-571"><a href="#TDLogConsumer.construct_filename-571"><span class="linenos">571</span></a>            <span class="k">return</span> <span class="n">file_path</span>
</span><span id="TDLogConsumer.construct_filename-572"><a href="#TDLogConsumer.construct_filename-572"><span class="linenos">572</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="TDLogConsumer.construct_filename-573"><a href="#TDLogConsumer.construct_filename-573"><span class="linenos">573</span></a>            <span class="k">return</span> <span class="n">directory</span> <span class="o">+</span> <span class="n">filename</span>
</span></pre></div>


    

                            </div>
                            <div id="TDLogConsumer.file_size_out" class="classattr">
                                        <input id="TDLogConsumer.file_size_out-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">file_size_out</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">file_path</span>, </span><span class="param"><span class="n">file_size</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDLogConsumer.file_size_out-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDLogConsumer.file_size_out"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDLogConsumer.file_size_out-575"><a href="#TDLogConsumer.file_size_out-575"><span class="linenos">575</span></a>    <span class="nd">@classmethod</span>
</span><span id="TDLogConsumer.file_size_out-576"><a href="#TDLogConsumer.file_size_out-576"><span class="linenos">576</span></a>    <span class="k">def</span> <span class="nf">file_size_out</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">file_size</span><span class="p">):</span>
</span><span id="TDLogConsumer.file_size_out-577"><a href="#TDLogConsumer.file_size_out-577"><span class="linenos">577</span></a>        <span class="n">f_size</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="TDLogConsumer.file_size_out-578"><a href="#TDLogConsumer.file_size_out-578"><span class="linenos">578</span></a>        <span class="n">f_size</span> <span class="o">=</span> <span class="n">f_size</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span>
</span><span id="TDLogConsumer.file_size_out-579"><a href="#TDLogConsumer.file_size_out-579"><span class="linenos">579</span></a>        <span class="k">if</span> <span class="n">f_size</span> <span class="o">&gt;=</span> <span class="n">file_size</span><span class="p">:</span>
</span><span id="TDLogConsumer.file_size_out-580"><a href="#TDLogConsumer.file_size_out-580"><span class="linenos">580</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="TDLogConsumer.file_size_out-581"><a href="#TDLogConsumer.file_size_out-581"><span class="linenos">581</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


    

                            </div>
                            <div id="TDLogConsumer.unlock_logging_consumer" class="classattr">
                                        <input id="TDLogConsumer.unlock_logging_consumer-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">unlock_logging_consumer</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDLogConsumer.unlock_logging_consumer-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDLogConsumer.unlock_logging_consumer"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDLogConsumer.unlock_logging_consumer-583"><a href="#TDLogConsumer.unlock_logging_consumer-583"><span class="linenos">583</span></a>    <span class="nd">@classmethod</span>
</span><span id="TDLogConsumer.unlock_logging_consumer-584"><a href="#TDLogConsumer.unlock_logging_consumer-584"><span class="linenos">584</span></a>    <span class="k">def</span> <span class="nf">unlock_logging_consumer</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="TDLogConsumer.unlock_logging_consumer-585"><a href="#TDLogConsumer.unlock_logging_consumer-585"><span class="linenos">585</span></a>        <span class="bp">cls</span><span class="o">.</span><span class="n">_mutex</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="TDLogConsumer.lock_logging_consumer" class="classattr">
                                        <input id="TDLogConsumer.lock_logging_consumer-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">lock_logging_consumer</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDLogConsumer.lock_logging_consumer-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDLogConsumer.lock_logging_consumer"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDLogConsumer.lock_logging_consumer-587"><a href="#TDLogConsumer.lock_logging_consumer-587"><span class="linenos">587</span></a>    <span class="nd">@classmethod</span>
</span><span id="TDLogConsumer.lock_logging_consumer-588"><a href="#TDLogConsumer.lock_logging_consumer-588"><span class="linenos">588</span></a>    <span class="k">def</span> <span class="nf">lock_logging_consumer</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
</span><span id="TDLogConsumer.lock_logging_consumer-589"><a href="#TDLogConsumer.lock_logging_consumer-589"><span class="linenos">589</span></a>        <span class="bp">cls</span><span class="o">.</span><span class="n">_mutex</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="TDLogConsumer.log_directory" class="classattr">
                                <div class="attr variable">
            <span class="name">log_directory</span>

        
    </div>
    <a class="headerlink" href="#TDLogConsumer.log_directory"></a>
    
    

                            </div>
                            <div id="TDLogConsumer.sdf" class="classattr">
                                <div class="attr variable">
            <span class="name">sdf</span>

        
    </div>
    <a class="headerlink" href="#TDLogConsumer.sdf"></a>
    
    

                            </div>
                            <div id="TDLogConsumer.suffix" class="classattr">
                                <div class="attr variable">
            <span class="name">suffix</span>

        
    </div>
    <a class="headerlink" href="#TDLogConsumer.suffix"></a>
    
    

                            </div>
                            <div id="TDLogConsumer.add" class="classattr">
                                        <input id="TDLogConsumer.add-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">msg</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDLogConsumer.add-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDLogConsumer.add"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDLogConsumer.add-620"><a href="#TDLogConsumer.add-620"><span class="linenos">620</span></a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
</span><span id="TDLogConsumer.add-621"><a href="#TDLogConsumer.add-621"><span class="linenos">621</span></a>        <span class="n">log</span> <span class="o">=</span> <span class="s2">&quot;Enqueue data = </span><span class="si">{msg}</span><span class="s2">&quot;</span>
</span><span id="TDLogConsumer.add-622"><a href="#TDLogConsumer.add-622"><span class="linenos">622</span></a>        <span class="n">td_log</span><span class="p">(</span><span class="n">log</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">))</span>
</span><span id="TDLogConsumer.add-623"><a href="#TDLogConsumer.add-623"><span class="linenos">623</span></a>
</span><span id="TDLogConsumer.add-624"><a href="#TDLogConsumer.add-624"><span class="linenos">624</span></a>        <span class="n">messages</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="TDLogConsumer.add-625"><a href="#TDLogConsumer.add-625"><span class="linenos">625</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lock_logging_consumer</span><span class="p">()</span>
</span><span id="TDLogConsumer.add-626"><a href="#TDLogConsumer.add-626"><span class="linenos">626</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="TDLogConsumer.add-627"><a href="#TDLogConsumer.add-627"><span class="linenos">627</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer_size</span><span class="p">:</span>
</span><span id="TDLogConsumer.add-628"><a href="#TDLogConsumer.add-628"><span class="linenos">628</span></a>            <span class="n">messages</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span>
</span><span id="TDLogConsumer.add-629"><a href="#TDLogConsumer.add-629"><span class="linenos">629</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refresh_writer</span><span class="p">()</span>
</span><span id="TDLogConsumer.add-630"><a href="#TDLogConsumer.add-630"><span class="linenos">630</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="TDLogConsumer.add-631"><a href="#TDLogConsumer.add-631"><span class="linenos">631</span></a>
</span><span id="TDLogConsumer.add-632"><a href="#TDLogConsumer.add-632"><span class="linenos">632</span></a>        <span class="k">if</span> <span class="n">messages</span><span class="p">:</span>
</span><span id="TDLogConsumer.add-633"><a href="#TDLogConsumer.add-633"><span class="linenos">633</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">messages</span><span class="p">)</span>
</span><span id="TDLogConsumer.add-634"><a href="#TDLogConsumer.add-634"><span class="linenos">634</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unlock_logging_consumer</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="TDLogConsumer.flush_with_close" class="classattr">
                                        <input id="TDLogConsumer.flush_with_close-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">flush_with_close</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">is_close</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDLogConsumer.flush_with_close-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDLogConsumer.flush_with_close"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDLogConsumer.flush_with_close-636"><a href="#TDLogConsumer.flush_with_close-636"><span class="linenos">636</span></a>    <span class="k">def</span> <span class="nf">flush_with_close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_close</span><span class="p">):</span>
</span><span id="TDLogConsumer.flush_with_close-637"><a href="#TDLogConsumer.flush_with_close-637"><span class="linenos">637</span></a>        <span class="n">messages</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="TDLogConsumer.flush_with_close-638"><a href="#TDLogConsumer.flush_with_close-638"><span class="linenos">638</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">lock_logging_consumer</span><span class="p">()</span>
</span><span id="TDLogConsumer.flush_with_close-639"><a href="#TDLogConsumer.flush_with_close-639"><span class="linenos">639</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TDLogConsumer.flush_with_close-640"><a href="#TDLogConsumer.flush_with_close-640"><span class="linenos">640</span></a>            <span class="n">messages</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span>
</span><span id="TDLogConsumer.flush_with_close-641"><a href="#TDLogConsumer.flush_with_close-641"><span class="linenos">641</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refresh_writer</span><span class="p">()</span>
</span><span id="TDLogConsumer.flush_with_close-642"><a href="#TDLogConsumer.flush_with_close-642"><span class="linenos">642</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="TDLogConsumer.flush_with_close-643"><a href="#TDLogConsumer.flush_with_close-643"><span class="linenos">643</span></a>        <span class="k">if</span> <span class="n">messages</span><span class="p">:</span>
</span><span id="TDLogConsumer.flush_with_close-644"><a href="#TDLogConsumer.flush_with_close-644"><span class="linenos">644</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">messages</span><span class="p">)</span>
</span><span id="TDLogConsumer.flush_with_close-645"><a href="#TDLogConsumer.flush_with_close-645"><span class="linenos">645</span></a>        <span class="k">if</span> <span class="n">is_close</span><span class="p">:</span>
</span><span id="TDLogConsumer.flush_with_close-646"><a href="#TDLogConsumer.flush_with_close-646"><span class="linenos">646</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="TDLogConsumer.flush_with_close-647"><a href="#TDLogConsumer.flush_with_close-647"><span class="linenos">647</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unlock_logging_consumer</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="TDLogConsumer.refresh_writer" class="classattr">
                                        <input id="TDLogConsumer.refresh_writer-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">refresh_writer</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDLogConsumer.refresh_writer-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDLogConsumer.refresh_writer"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDLogConsumer.refresh_writer-649"><a href="#TDLogConsumer.refresh_writer-649"><span class="linenos">649</span></a>    <span class="k">def</span> <span class="nf">refresh_writer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TDLogConsumer.refresh_writer-650"><a href="#TDLogConsumer.refresh_writer-650"><span class="linenos">650</span></a>        <span class="n">date_suffix</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sdf</span><span class="p">)</span>
</span><span id="TDLogConsumer.refresh_writer-651"><a href="#TDLogConsumer.refresh_writer-651"><span class="linenos">651</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">suffix</span> <span class="o">!=</span> <span class="n">date_suffix</span><span class="p">:</span>
</span><span id="TDLogConsumer.refresh_writer-652"><a href="#TDLogConsumer.refresh_writer-652"><span class="linenos">652</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">suffix</span> <span class="o">=</span> <span class="n">date_suffix</span>
</span><span id="TDLogConsumer.refresh_writer-653"><a href="#TDLogConsumer.refresh_writer-653"><span class="linenos">653</span></a>        <span class="n">filename</span> <span class="o">=</span> <span class="n">TDLogConsumer</span><span class="o">.</span><span class="n">construct_filename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_directory</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">suffix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fileSize</span><span class="p">,</span>
</span><span id="TDLogConsumer.refresh_writer-654"><a href="#TDLogConsumer.refresh_writer-654"><span class="linenos">654</span></a>                                                    <span class="bp">self</span><span class="o">.</span><span class="n">_file_prefix</span><span class="p">)</span>
</span><span id="TDLogConsumer.refresh_writer-655"><a href="#TDLogConsumer.refresh_writer-655"><span class="linenos">655</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_writer</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
</span><span id="TDLogConsumer.refresh_writer-656"><a href="#TDLogConsumer.refresh_writer-656"><span class="linenos">656</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="TDLogConsumer.refresh_writer-657"><a href="#TDLogConsumer.refresh_writer-657"><span class="linenos">657</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_writer</span> <span class="o">=</span> <span class="n">TDLogConsumer</span><span class="o">.</span><span class="n">_FileWriter</span><span class="o">.</span><span class="n">instance</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="TDLogConsumer.flush" class="classattr">
                                        <input id="TDLogConsumer.flush-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">flush</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDLogConsumer.flush-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDLogConsumer.flush"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDLogConsumer.flush-659"><a href="#TDLogConsumer.flush-659"><span class="linenos">659</span></a>    <span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TDLogConsumer.flush-660"><a href="#TDLogConsumer.flush-660"><span class="linenos">660</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">flush_with_close</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="TDLogConsumer.close" class="classattr">
                                        <input id="TDLogConsumer.close-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">close</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDLogConsumer.close-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDLogConsumer.close"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDLogConsumer.close-662"><a href="#TDLogConsumer.close-662"><span class="linenos">662</span></a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TDLogConsumer.close-663"><a href="#TDLogConsumer.close-663"><span class="linenos">663</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">flush_with_close</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="TDBatchConsumer">
                            <input id="TDBatchConsumer-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">TDBatchConsumer</span>:

                <label class="view-source-button" for="TDBatchConsumer-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDBatchConsumer"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDBatchConsumer-666"><a href="#TDBatchConsumer-666"><span class="linenos">666</span></a><span class="k">class</span> <span class="nc">TDBatchConsumer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="TDBatchConsumer-667"><a href="#TDBatchConsumer-667"><span class="linenos">667</span></a>    <span class="n">_batch_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">RLock</span><span class="p">()</span>
</span><span id="TDBatchConsumer-668"><a href="#TDBatchConsumer-668"><span class="linenos">668</span></a>    <span class="n">_cachelock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">RLock</span><span class="p">()</span>
</span><span id="TDBatchConsumer-669"><a href="#TDBatchConsumer-669"><span class="linenos">669</span></a>
</span><span id="TDBatchConsumer-670"><a href="#TDBatchConsumer-670"><span class="linenos">670</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server_uri</span><span class="p">,</span> <span class="n">appid</span><span class="p">,</span> <span class="n">batch</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30000</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">compress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">max_cache_size</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
</span><span id="TDBatchConsumer-671"><a href="#TDBatchConsumer-671"><span class="linenos">671</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDBatchConsumer-672"><a href="#TDBatchConsumer-672"><span class="linenos">672</span></a><span class="sd">        Report data by http (synchronized)</span>
</span><span id="TDBatchConsumer-673"><a href="#TDBatchConsumer-673"><span class="linenos">673</span></a>
</span><span id="TDBatchConsumer-674"><a href="#TDBatchConsumer-674"><span class="linenos">674</span></a><span class="sd">        Parameters:</span>
</span><span id="TDBatchConsumer-675"><a href="#TDBatchConsumer-675"><span class="linenos">675</span></a><span class="sd">        - server_uri: str</span>
</span><span id="TDBatchConsumer-676"><a href="#TDBatchConsumer-676"><span class="linenos">676</span></a><span class="sd">        - appid: str</span>
</span><span id="TDBatchConsumer-677"><a href="#TDBatchConsumer-677"><span class="linenos">677</span></a><span class="sd">        - batch: Specify the number of data to trigger uploading, the default is 20, and the maximum is 200 .</span>
</span><span id="TDBatchConsumer-678"><a href="#TDBatchConsumer-678"><span class="linenos">678</span></a><span class="sd">        - timeout: Request timeout, in milliseconds, default is 30000 ms .</span>
</span><span id="TDBatchConsumer-679"><a href="#TDBatchConsumer-679"><span class="linenos">679</span></a><span class="sd">        - interval: The maximum time interval for uploading data, in seconds, the default is 3 seconds .</span>
</span><span id="TDBatchConsumer-680"><a href="#TDBatchConsumer-680"><span class="linenos">680</span></a><span class="sd">        - compress: is compress data when request .</span>
</span><span id="TDBatchConsumer-681"><a href="#TDBatchConsumer-681"><span class="linenos">681</span></a><span class="sd">        - max_cache_size: cache size</span>
</span><span id="TDBatchConsumer-682"><a href="#TDBatchConsumer-682"><span class="linenos">682</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDBatchConsumer-683"><a href="#TDBatchConsumer-683"><span class="linenos">683</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__interval</span> <span class="o">=</span> <span class="n">interval</span>
</span><span id="TDBatchConsumer-684"><a href="#TDBatchConsumer-684"><span class="linenos">684</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__batch</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
</span><span id="TDBatchConsumer-685"><a href="#TDBatchConsumer-685"><span class="linenos">685</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__message_channel</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="TDBatchConsumer-686"><a href="#TDBatchConsumer-686"><span class="linenos">686</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__max_cache_size</span> <span class="o">=</span> <span class="n">max_cache_size</span>
</span><span id="TDBatchConsumer-687"><a href="#TDBatchConsumer-687"><span class="linenos">687</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="TDBatchConsumer-688"><a href="#TDBatchConsumer-688"><span class="linenos">688</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__last_flush</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="TDBatchConsumer-689"><a href="#TDBatchConsumer-689"><span class="linenos">689</span></a>        <span class="n">server_url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">server_uri</span><span class="p">)</span>
</span><span id="TDBatchConsumer-690"><a href="#TDBatchConsumer-690"><span class="linenos">690</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__http_service</span> <span class="o">=</span> <span class="n">_HttpServices</span><span class="p">(</span><span class="n">server_url</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;/sync_server&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">geturl</span><span class="p">(),</span> <span class="n">appid</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
</span><span id="TDBatchConsumer-691"><a href="#TDBatchConsumer-691"><span class="linenos">691</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__http_service</span><span class="o">.</span><span class="n">compress</span> <span class="o">=</span> <span class="n">compress</span>
</span><span id="TDBatchConsumer-692"><a href="#TDBatchConsumer-692"><span class="linenos">692</span></a>        <span class="n">td_log</span><span class="p">(</span><span class="s2">&quot;init TDBatchConsumer&quot;</span><span class="p">)</span>
</span><span id="TDBatchConsumer-693"><a href="#TDBatchConsumer-693"><span class="linenos">693</span></a>
</span><span id="TDBatchConsumer-694"><a href="#TDBatchConsumer-694"><span class="linenos">694</span></a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
</span><span id="TDBatchConsumer-695"><a href="#TDBatchConsumer-695"><span class="linenos">695</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_batch_lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
</span><span id="TDBatchConsumer-696"><a href="#TDBatchConsumer-696"><span class="linenos">696</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="TDBatchConsumer-697"><a href="#TDBatchConsumer-697"><span class="linenos">697</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__message_channel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="TDBatchConsumer-698"><a href="#TDBatchConsumer-698"><span class="linenos">698</span></a>        <span class="k">finally</span><span class="p">:</span>
</span><span id="TDBatchConsumer-699"><a href="#TDBatchConsumer-699"><span class="linenos">699</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_batch_lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span><span id="TDBatchConsumer-700"><a href="#TDBatchConsumer-700"><span class="linenos">700</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__message_channel</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__batch</span> \
</span><span id="TDBatchConsumer-701"><a href="#TDBatchConsumer-701"><span class="linenos">701</span></a>                <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TDBatchConsumer-702"><a href="#TDBatchConsumer-702"><span class="linenos">702</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">flush_once</span><span class="p">()</span>
</span><span id="TDBatchConsumer-703"><a href="#TDBatchConsumer-703"><span class="linenos">703</span></a>
</span><span id="TDBatchConsumer-704"><a href="#TDBatchConsumer-704"><span class="linenos">704</span></a>    <span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">throw_exception</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="TDBatchConsumer-705"><a href="#TDBatchConsumer-705"><span class="linenos">705</span></a>        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__message_channel</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TDBatchConsumer-706"><a href="#TDBatchConsumer-706"><span class="linenos">706</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="TDBatchConsumer-707"><a href="#TDBatchConsumer-707"><span class="linenos">707</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">flush_once</span><span class="p">(</span><span class="n">throw_exception</span><span class="p">)</span>
</span><span id="TDBatchConsumer-708"><a href="#TDBatchConsumer-708"><span class="linenos">708</span></a>            <span class="k">except</span> <span class="n">TDIllegalDataException</span><span class="p">:</span>
</span><span id="TDBatchConsumer-709"><a href="#TDBatchConsumer-709"><span class="linenos">709</span></a>                <span class="k">continue</span>
</span><span id="TDBatchConsumer-710"><a href="#TDBatchConsumer-710"><span class="linenos">710</span></a>
</span><span id="TDBatchConsumer-711"><a href="#TDBatchConsumer-711"><span class="linenos">711</span></a>    <span class="k">def</span> <span class="nf">flush_once</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">throw_exception</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="TDBatchConsumer-712"><a href="#TDBatchConsumer-712"><span class="linenos">712</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__message_channel</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TDBatchConsumer-713"><a href="#TDBatchConsumer-713"><span class="linenos">713</span></a>            <span class="k">return</span>
</span><span id="TDBatchConsumer-714"><a href="#TDBatchConsumer-714"><span class="linenos">714</span></a>
</span><span id="TDBatchConsumer-715"><a href="#TDBatchConsumer-715"><span class="linenos">715</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cachelock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
</span><span id="TDBatchConsumer-716"><a href="#TDBatchConsumer-716"><span class="linenos">716</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_batch_lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
</span><span id="TDBatchConsumer-717"><a href="#TDBatchConsumer-717"><span class="linenos">717</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="TDBatchConsumer-718"><a href="#TDBatchConsumer-718"><span class="linenos">718</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="TDBatchConsumer-719"><a href="#TDBatchConsumer-719"><span class="linenos">719</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__message_channel</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TDBatchConsumer-720"><a href="#TDBatchConsumer-720"><span class="linenos">720</span></a>                    <span class="k">return</span>
</span><span id="TDBatchConsumer-721"><a href="#TDBatchConsumer-721"><span class="linenos">721</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__message_channel</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__batch</span><span class="p">:</span>
</span><span id="TDBatchConsumer-722"><a href="#TDBatchConsumer-722"><span class="linenos">722</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__message_channel</span><span class="p">)</span>
</span><span id="TDBatchConsumer-723"><a href="#TDBatchConsumer-723"><span class="linenos">723</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">__message_channel</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="TDBatchConsumer-724"><a href="#TDBatchConsumer-724"><span class="linenos">724</span></a>            <span class="k">finally</span><span class="p">:</span>
</span><span id="TDBatchConsumer-725"><a href="#TDBatchConsumer-725"><span class="linenos">725</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_batch_lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span><span id="TDBatchConsumer-726"><a href="#TDBatchConsumer-726"><span class="linenos">726</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="TDBatchConsumer-727"><a href="#TDBatchConsumer-727"><span class="linenos">727</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__http_service</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;[&#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">msg</span><span class="p">)))</span>
</span><span id="TDBatchConsumer-728"><a href="#TDBatchConsumer-728"><span class="linenos">728</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__last_flush</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="TDBatchConsumer-729"><a href="#TDBatchConsumer-729"><span class="linenos">729</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="TDBatchConsumer-730"><a href="#TDBatchConsumer-730"><span class="linenos">730</span></a>        <span class="k">except</span> <span class="n">TDNetworkException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="TDBatchConsumer-731"><a href="#TDBatchConsumer-731"><span class="linenos">731</span></a>            <span class="k">if</span> <span class="n">throw_exception</span><span class="p">:</span>
</span><span id="TDBatchConsumer-732"><a href="#TDBatchConsumer-732"><span class="linenos">732</span></a>                <span class="k">raise</span> <span class="n">e</span>
</span><span id="TDBatchConsumer-733"><a href="#TDBatchConsumer-733"><span class="linenos">733</span></a>        <span class="k">except</span> <span class="n">TDIllegalDataException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="TDBatchConsumer-734"><a href="#TDBatchConsumer-734"><span class="linenos">734</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="TDBatchConsumer-735"><a href="#TDBatchConsumer-735"><span class="linenos">735</span></a>            <span class="k">if</span> <span class="n">throw_exception</span><span class="p">:</span>
</span><span id="TDBatchConsumer-736"><a href="#TDBatchConsumer-736"><span class="linenos">736</span></a>                <span class="k">raise</span> <span class="n">e</span>
</span><span id="TDBatchConsumer-737"><a href="#TDBatchConsumer-737"><span class="linenos">737</span></a>        <span class="k">finally</span><span class="p">:</span>
</span><span id="TDBatchConsumer-738"><a href="#TDBatchConsumer-738"><span class="linenos">738</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">__max_cache_size</span><span class="p">:</span>
</span><span id="TDBatchConsumer-739"><a href="#TDBatchConsumer-739"><span class="linenos">739</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="TDBatchConsumer-740"><a href="#TDBatchConsumer-740"><span class="linenos">740</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_cachelock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span><span id="TDBatchConsumer-741"><a href="#TDBatchConsumer-741"><span class="linenos">741</span></a>
</span><span id="TDBatchConsumer-742"><a href="#TDBatchConsumer-742"><span class="linenos">742</span></a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TDBatchConsumer-743"><a href="#TDBatchConsumer-743"><span class="linenos">743</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span><span id="TDBatchConsumer-744"><a href="#TDBatchConsumer-744"><span class="linenos">744</span></a>
</span><span id="TDBatchConsumer-745"><a href="#TDBatchConsumer-745"><span class="linenos">745</span></a>    <span class="k">pass</span>
</span></pre></div>


    

                            <div id="TDBatchConsumer.__init__" class="classattr">
                                        <input id="TDBatchConsumer.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">TDBatchConsumer</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">server_uri</span>,</span><span class="param">	<span class="n">appid</span>,</span><span class="param">	<span class="n">batch</span><span class="o">=</span><span class="mi">20</span>,</span><span class="param">	<span class="n">timeout</span><span class="o">=</span><span class="mi">30000</span>,</span><span class="param">	<span class="n">interval</span><span class="o">=</span><span class="mi">3</span>,</span><span class="param">	<span class="n">compress</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">max_cache_size</span><span class="o">=</span><span class="mi">50</span></span>)</span>

                <label class="view-source-button" for="TDBatchConsumer.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDBatchConsumer.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDBatchConsumer.__init__-670"><a href="#TDBatchConsumer.__init__-670"><span class="linenos">670</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server_uri</span><span class="p">,</span> <span class="n">appid</span><span class="p">,</span> <span class="n">batch</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30000</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">compress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">max_cache_size</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
</span><span id="TDBatchConsumer.__init__-671"><a href="#TDBatchConsumer.__init__-671"><span class="linenos">671</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDBatchConsumer.__init__-672"><a href="#TDBatchConsumer.__init__-672"><span class="linenos">672</span></a><span class="sd">        Report data by http (synchronized)</span>
</span><span id="TDBatchConsumer.__init__-673"><a href="#TDBatchConsumer.__init__-673"><span class="linenos">673</span></a>
</span><span id="TDBatchConsumer.__init__-674"><a href="#TDBatchConsumer.__init__-674"><span class="linenos">674</span></a><span class="sd">        Parameters:</span>
</span><span id="TDBatchConsumer.__init__-675"><a href="#TDBatchConsumer.__init__-675"><span class="linenos">675</span></a><span class="sd">        - server_uri: str</span>
</span><span id="TDBatchConsumer.__init__-676"><a href="#TDBatchConsumer.__init__-676"><span class="linenos">676</span></a><span class="sd">        - appid: str</span>
</span><span id="TDBatchConsumer.__init__-677"><a href="#TDBatchConsumer.__init__-677"><span class="linenos">677</span></a><span class="sd">        - batch: Specify the number of data to trigger uploading, the default is 20, and the maximum is 200 .</span>
</span><span id="TDBatchConsumer.__init__-678"><a href="#TDBatchConsumer.__init__-678"><span class="linenos">678</span></a><span class="sd">        - timeout: Request timeout, in milliseconds, default is 30000 ms .</span>
</span><span id="TDBatchConsumer.__init__-679"><a href="#TDBatchConsumer.__init__-679"><span class="linenos">679</span></a><span class="sd">        - interval: The maximum time interval for uploading data, in seconds, the default is 3 seconds .</span>
</span><span id="TDBatchConsumer.__init__-680"><a href="#TDBatchConsumer.__init__-680"><span class="linenos">680</span></a><span class="sd">        - compress: is compress data when request .</span>
</span><span id="TDBatchConsumer.__init__-681"><a href="#TDBatchConsumer.__init__-681"><span class="linenos">681</span></a><span class="sd">        - max_cache_size: cache size</span>
</span><span id="TDBatchConsumer.__init__-682"><a href="#TDBatchConsumer.__init__-682"><span class="linenos">682</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDBatchConsumer.__init__-683"><a href="#TDBatchConsumer.__init__-683"><span class="linenos">683</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__interval</span> <span class="o">=</span> <span class="n">interval</span>
</span><span id="TDBatchConsumer.__init__-684"><a href="#TDBatchConsumer.__init__-684"><span class="linenos">684</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__batch</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
</span><span id="TDBatchConsumer.__init__-685"><a href="#TDBatchConsumer.__init__-685"><span class="linenos">685</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__message_channel</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="TDBatchConsumer.__init__-686"><a href="#TDBatchConsumer.__init__-686"><span class="linenos">686</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__max_cache_size</span> <span class="o">=</span> <span class="n">max_cache_size</span>
</span><span id="TDBatchConsumer.__init__-687"><a href="#TDBatchConsumer.__init__-687"><span class="linenos">687</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="TDBatchConsumer.__init__-688"><a href="#TDBatchConsumer.__init__-688"><span class="linenos">688</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__last_flush</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="TDBatchConsumer.__init__-689"><a href="#TDBatchConsumer.__init__-689"><span class="linenos">689</span></a>        <span class="n">server_url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">server_uri</span><span class="p">)</span>
</span><span id="TDBatchConsumer.__init__-690"><a href="#TDBatchConsumer.__init__-690"><span class="linenos">690</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__http_service</span> <span class="o">=</span> <span class="n">_HttpServices</span><span class="p">(</span><span class="n">server_url</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;/sync_server&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">geturl</span><span class="p">(),</span> <span class="n">appid</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
</span><span id="TDBatchConsumer.__init__-691"><a href="#TDBatchConsumer.__init__-691"><span class="linenos">691</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__http_service</span><span class="o">.</span><span class="n">compress</span> <span class="o">=</span> <span class="n">compress</span>
</span><span id="TDBatchConsumer.__init__-692"><a href="#TDBatchConsumer.__init__-692"><span class="linenos">692</span></a>        <span class="n">td_log</span><span class="p">(</span><span class="s2">&quot;init TDBatchConsumer&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Report data by http (synchronized)</p>

<p>Parameters:</p>

<ul>
<li>server_uri: str</li>
<li>appid: str</li>
<li>batch: Specify the number of data to trigger uploading, the default is 20, and the maximum is 200 .</li>
<li>timeout: Request timeout, in milliseconds, default is 30000 ms .</li>
<li>interval: The maximum time interval for uploading data, in seconds, the default is 3 seconds .</li>
<li>compress: is compress data when request .</li>
<li>max_cache_size: cache size</li>
</ul>
</div>


                            </div>
                            <div id="TDBatchConsumer.add" class="classattr">
                                        <input id="TDBatchConsumer.add-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">msg</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDBatchConsumer.add-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDBatchConsumer.add"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDBatchConsumer.add-694"><a href="#TDBatchConsumer.add-694"><span class="linenos">694</span></a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
</span><span id="TDBatchConsumer.add-695"><a href="#TDBatchConsumer.add-695"><span class="linenos">695</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_batch_lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
</span><span id="TDBatchConsumer.add-696"><a href="#TDBatchConsumer.add-696"><span class="linenos">696</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="TDBatchConsumer.add-697"><a href="#TDBatchConsumer.add-697"><span class="linenos">697</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__message_channel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="TDBatchConsumer.add-698"><a href="#TDBatchConsumer.add-698"><span class="linenos">698</span></a>        <span class="k">finally</span><span class="p">:</span>
</span><span id="TDBatchConsumer.add-699"><a href="#TDBatchConsumer.add-699"><span class="linenos">699</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_batch_lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span><span id="TDBatchConsumer.add-700"><a href="#TDBatchConsumer.add-700"><span class="linenos">700</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__message_channel</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__batch</span> \
</span><span id="TDBatchConsumer.add-701"><a href="#TDBatchConsumer.add-701"><span class="linenos">701</span></a>                <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TDBatchConsumer.add-702"><a href="#TDBatchConsumer.add-702"><span class="linenos">702</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">flush_once</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="TDBatchConsumer.flush" class="classattr">
                                        <input id="TDBatchConsumer.flush-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">flush</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">throw_exception</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDBatchConsumer.flush-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDBatchConsumer.flush"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDBatchConsumer.flush-704"><a href="#TDBatchConsumer.flush-704"><span class="linenos">704</span></a>    <span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">throw_exception</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="TDBatchConsumer.flush-705"><a href="#TDBatchConsumer.flush-705"><span class="linenos">705</span></a>        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__message_channel</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TDBatchConsumer.flush-706"><a href="#TDBatchConsumer.flush-706"><span class="linenos">706</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="TDBatchConsumer.flush-707"><a href="#TDBatchConsumer.flush-707"><span class="linenos">707</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">flush_once</span><span class="p">(</span><span class="n">throw_exception</span><span class="p">)</span>
</span><span id="TDBatchConsumer.flush-708"><a href="#TDBatchConsumer.flush-708"><span class="linenos">708</span></a>            <span class="k">except</span> <span class="n">TDIllegalDataException</span><span class="p">:</span>
</span><span id="TDBatchConsumer.flush-709"><a href="#TDBatchConsumer.flush-709"><span class="linenos">709</span></a>                <span class="k">continue</span>
</span></pre></div>


    

                            </div>
                            <div id="TDBatchConsumer.flush_once" class="classattr">
                                        <input id="TDBatchConsumer.flush_once-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">flush_once</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">throw_exception</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDBatchConsumer.flush_once-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDBatchConsumer.flush_once"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDBatchConsumer.flush_once-711"><a href="#TDBatchConsumer.flush_once-711"><span class="linenos">711</span></a>    <span class="k">def</span> <span class="nf">flush_once</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">throw_exception</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="TDBatchConsumer.flush_once-712"><a href="#TDBatchConsumer.flush_once-712"><span class="linenos">712</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__message_channel</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TDBatchConsumer.flush_once-713"><a href="#TDBatchConsumer.flush_once-713"><span class="linenos">713</span></a>            <span class="k">return</span>
</span><span id="TDBatchConsumer.flush_once-714"><a href="#TDBatchConsumer.flush_once-714"><span class="linenos">714</span></a>
</span><span id="TDBatchConsumer.flush_once-715"><a href="#TDBatchConsumer.flush_once-715"><span class="linenos">715</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_cachelock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
</span><span id="TDBatchConsumer.flush_once-716"><a href="#TDBatchConsumer.flush_once-716"><span class="linenos">716</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_batch_lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
</span><span id="TDBatchConsumer.flush_once-717"><a href="#TDBatchConsumer.flush_once-717"><span class="linenos">717</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="TDBatchConsumer.flush_once-718"><a href="#TDBatchConsumer.flush_once-718"><span class="linenos">718</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="TDBatchConsumer.flush_once-719"><a href="#TDBatchConsumer.flush_once-719"><span class="linenos">719</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__message_channel</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TDBatchConsumer.flush_once-720"><a href="#TDBatchConsumer.flush_once-720"><span class="linenos">720</span></a>                    <span class="k">return</span>
</span><span id="TDBatchConsumer.flush_once-721"><a href="#TDBatchConsumer.flush_once-721"><span class="linenos">721</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__message_channel</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__batch</span><span class="p">:</span>
</span><span id="TDBatchConsumer.flush_once-722"><a href="#TDBatchConsumer.flush_once-722"><span class="linenos">722</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__message_channel</span><span class="p">)</span>
</span><span id="TDBatchConsumer.flush_once-723"><a href="#TDBatchConsumer.flush_once-723"><span class="linenos">723</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">__message_channel</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="TDBatchConsumer.flush_once-724"><a href="#TDBatchConsumer.flush_once-724"><span class="linenos">724</span></a>            <span class="k">finally</span><span class="p">:</span>
</span><span id="TDBatchConsumer.flush_once-725"><a href="#TDBatchConsumer.flush_once-725"><span class="linenos">725</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_batch_lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span><span id="TDBatchConsumer.flush_once-726"><a href="#TDBatchConsumer.flush_once-726"><span class="linenos">726</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="TDBatchConsumer.flush_once-727"><a href="#TDBatchConsumer.flush_once-727"><span class="linenos">727</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__http_service</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;[&#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">msg</span><span class="p">)))</span>
</span><span id="TDBatchConsumer.flush_once-728"><a href="#TDBatchConsumer.flush_once-728"><span class="linenos">728</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__last_flush</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="TDBatchConsumer.flush_once-729"><a href="#TDBatchConsumer.flush_once-729"><span class="linenos">729</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="TDBatchConsumer.flush_once-730"><a href="#TDBatchConsumer.flush_once-730"><span class="linenos">730</span></a>        <span class="k">except</span> <span class="n">TDNetworkException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="TDBatchConsumer.flush_once-731"><a href="#TDBatchConsumer.flush_once-731"><span class="linenos">731</span></a>            <span class="k">if</span> <span class="n">throw_exception</span><span class="p">:</span>
</span><span id="TDBatchConsumer.flush_once-732"><a href="#TDBatchConsumer.flush_once-732"><span class="linenos">732</span></a>                <span class="k">raise</span> <span class="n">e</span>
</span><span id="TDBatchConsumer.flush_once-733"><a href="#TDBatchConsumer.flush_once-733"><span class="linenos">733</span></a>        <span class="k">except</span> <span class="n">TDIllegalDataException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="TDBatchConsumer.flush_once-734"><a href="#TDBatchConsumer.flush_once-734"><span class="linenos">734</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="TDBatchConsumer.flush_once-735"><a href="#TDBatchConsumer.flush_once-735"><span class="linenos">735</span></a>            <span class="k">if</span> <span class="n">throw_exception</span><span class="p">:</span>
</span><span id="TDBatchConsumer.flush_once-736"><a href="#TDBatchConsumer.flush_once-736"><span class="linenos">736</span></a>                <span class="k">raise</span> <span class="n">e</span>
</span><span id="TDBatchConsumer.flush_once-737"><a href="#TDBatchConsumer.flush_once-737"><span class="linenos">737</span></a>        <span class="k">finally</span><span class="p">:</span>
</span><span id="TDBatchConsumer.flush_once-738"><a href="#TDBatchConsumer.flush_once-738"><span class="linenos">738</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">__max_cache_size</span><span class="p">:</span>
</span><span id="TDBatchConsumer.flush_once-739"><a href="#TDBatchConsumer.flush_once-739"><span class="linenos">739</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cache_buffer</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</span><span id="TDBatchConsumer.flush_once-740"><a href="#TDBatchConsumer.flush_once-740"><span class="linenos">740</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_cachelock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="TDBatchConsumer.close" class="classattr">
                                        <input id="TDBatchConsumer.close-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">close</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDBatchConsumer.close-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDBatchConsumer.close"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDBatchConsumer.close-742"><a href="#TDBatchConsumer.close-742"><span class="linenos">742</span></a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TDBatchConsumer.close-743"><a href="#TDBatchConsumer.close-743"><span class="linenos">743</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="TDDebugConsumer">
                            <input id="TDDebugConsumer-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">TDDebugConsumer</span>:

                <label class="view-source-button" for="TDDebugConsumer-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDDebugConsumer"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDDebugConsumer-892"><a href="#TDDebugConsumer-892"><span class="linenos">892</span></a><span class="k">class</span> <span class="nc">TDDebugConsumer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="TDDebugConsumer-893"><a href="#TDDebugConsumer-893"><span class="linenos">893</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDDebugConsumer-894"><a href="#TDDebugConsumer-894"><span class="linenos">894</span></a><span class="sd">    The server will strictly verify the data. When a certain attribute does not meet the specification,</span>
</span><span id="TDDebugConsumer-895"><a href="#TDDebugConsumer-895"><span class="linenos">895</span></a><span class="sd">    the entire data will not be stored. When the data format is wrong, an exception message containing detailed reasons</span>
</span><span id="TDDebugConsumer-896"><a href="#TDDebugConsumer-896"><span class="linenos">896</span></a><span class="sd">    will be thrown. It is recommended to use this Consumer first to debug buried point data.</span>
</span><span id="TDDebugConsumer-897"><a href="#TDDebugConsumer-897"><span class="linenos">897</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="TDDebugConsumer-898"><a href="#TDDebugConsumer-898"><span class="linenos">898</span></a>
</span><span id="TDDebugConsumer-899"><a href="#TDDebugConsumer-899"><span class="linenos">899</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server_uri</span><span class="p">,</span> <span class="n">appid</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30000</span><span class="p">,</span> <span class="n">write_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">device_id</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
</span><span id="TDDebugConsumer-900"><a href="#TDDebugConsumer-900"><span class="linenos">900</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDDebugConsumer-901"><a href="#TDDebugConsumer-901"><span class="linenos">901</span></a><span class="sd">        Init debug consumer</span>
</span><span id="TDDebugConsumer-902"><a href="#TDDebugConsumer-902"><span class="linenos">902</span></a>
</span><span id="TDDebugConsumer-903"><a href="#TDDebugConsumer-903"><span class="linenos">903</span></a><span class="sd">        Parameters:</span>
</span><span id="TDDebugConsumer-904"><a href="#TDDebugConsumer-904"><span class="linenos">904</span></a><span class="sd">        - server_uri: str</span>
</span><span id="TDDebugConsumer-905"><a href="#TDDebugConsumer-905"><span class="linenos">905</span></a><span class="sd">        - appid: str</span>
</span><span id="TDDebugConsumer-906"><a href="#TDDebugConsumer-906"><span class="linenos">906</span></a><span class="sd">        - timeout: Request timeout, in milliseconds, default is 30000 ms</span>
</span><span id="TDDebugConsumer-907"><a href="#TDDebugConsumer-907"><span class="linenos">907</span></a><span class="sd">        - write_data: write data to TE or not</span>
</span><span id="TDDebugConsumer-908"><a href="#TDDebugConsumer-908"><span class="linenos">908</span></a><span class="sd">        - device_id: debug device in TE</span>
</span><span id="TDDebugConsumer-909"><a href="#TDDebugConsumer-909"><span class="linenos">909</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDDebugConsumer-910"><a href="#TDDebugConsumer-910"><span class="linenos">910</span></a>        <span class="n">server_url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">server_uri</span><span class="p">)</span>
</span><span id="TDDebugConsumer-911"><a href="#TDDebugConsumer-911"><span class="linenos">911</span></a>        <span class="n">debug_url</span> <span class="o">=</span> <span class="n">server_url</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;/data_debug&#39;</span><span class="p">)</span>
</span><span id="TDDebugConsumer-912"><a href="#TDDebugConsumer-912"><span class="linenos">912</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__server_uri</span> <span class="o">=</span> <span class="n">debug_url</span><span class="o">.</span><span class="n">geturl</span><span class="p">()</span>
</span><span id="TDDebugConsumer-913"><a href="#TDDebugConsumer-913"><span class="linenos">913</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__appid</span> <span class="o">=</span> <span class="n">appid</span>
</span><span id="TDDebugConsumer-914"><a href="#TDDebugConsumer-914"><span class="linenos">914</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span> <span class="o">=</span> <span class="n">timeout</span>
</span><span id="TDDebugConsumer-915"><a href="#TDDebugConsumer-915"><span class="linenos">915</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__writer_data</span> <span class="o">=</span> <span class="n">write_data</span>
</span><span id="TDDebugConsumer-916"><a href="#TDDebugConsumer-916"><span class="linenos">916</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__device_id</span> <span class="o">=</span> <span class="n">device_id</span>
</span><span id="TDDebugConsumer-917"><a href="#TDDebugConsumer-917"><span class="linenos">917</span></a>        <span class="n">TDAnalytics</span><span class="o">.</span><span class="n">enableLog</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="TDDebugConsumer-918"><a href="#TDDebugConsumer-918"><span class="linenos">918</span></a>        <span class="n">td_log</span><span class="p">(</span><span class="s2">&quot;init DebugConsumer&quot;</span><span class="p">)</span>
</span><span id="TDDebugConsumer-919"><a href="#TDDebugConsumer-919"><span class="linenos">919</span></a>
</span><span id="TDDebugConsumer-920"><a href="#TDDebugConsumer-920"><span class="linenos">920</span></a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
</span><span id="TDDebugConsumer-921"><a href="#TDDebugConsumer-921"><span class="linenos">921</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="TDDebugConsumer-922"><a href="#TDDebugConsumer-922"><span class="linenos">922</span></a>            <span class="n">dry_run</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="TDDebugConsumer-923"><a href="#TDDebugConsumer-923"><span class="linenos">923</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__writer_data</span><span class="p">:</span>
</span><span id="TDDebugConsumer-924"><a href="#TDDebugConsumer-924"><span class="linenos">924</span></a>                <span class="n">dry_run</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="TDDebugConsumer-925"><a href="#TDDebugConsumer-925"><span class="linenos">925</span></a>
</span><span id="TDDebugConsumer-926"><a href="#TDDebugConsumer-926"><span class="linenos">926</span></a>            <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="s1">&#39;server&#39;</span><span class="p">,</span> <span class="s1">&#39;appid&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__appid</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">msg</span><span class="p">,</span> <span class="s1">&#39;dryRun&#39;</span><span class="p">:</span> <span class="n">dry_run</span><span class="p">}</span>
</span><span id="TDDebugConsumer-927"><a href="#TDDebugConsumer-927"><span class="linenos">927</span></a>
</span><span id="TDDebugConsumer-928"><a href="#TDDebugConsumer-928"><span class="linenos">928</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__device_id</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TDDebugConsumer-929"><a href="#TDDebugConsumer-929"><span class="linenos">929</span></a>                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;deviceId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__device_id</span>
</span><span id="TDDebugConsumer-930"><a href="#TDDebugConsumer-930"><span class="linenos">930</span></a>
</span><span id="TDDebugConsumer-931"><a href="#TDDebugConsumer-931"><span class="linenos">931</span></a>            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__server_uri</span><span class="p">,</span>
</span><span id="TDDebugConsumer-932"><a href="#TDDebugConsumer-932"><span class="linenos">932</span></a>                                     <span class="n">data</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
</span><span id="TDDebugConsumer-933"><a href="#TDDebugConsumer-933"><span class="linenos">933</span></a>                                     <span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span><span class="p">)</span>
</span><span id="TDDebugConsumer-934"><a href="#TDDebugConsumer-934"><span class="linenos">934</span></a>            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
</span><span id="TDDebugConsumer-935"><a href="#TDDebugConsumer-935"><span class="linenos">935</span></a>                <span class="n">response_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span><span id="TDDebugConsumer-936"><a href="#TDDebugConsumer-936"><span class="linenos">936</span></a>                <span class="n">td_log</span><span class="p">(</span><span class="s1">&#39;response=</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">response_data</span><span class="p">))</span>
</span><span id="TDDebugConsumer-937"><a href="#TDDebugConsumer-937"><span class="linenos">937</span></a>                <span class="k">if</span> <span class="n">response_data</span><span class="p">[</span><span class="s2">&quot;errorLevel&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TDDebugConsumer-938"><a href="#TDDebugConsumer-938"><span class="linenos">938</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="TDDebugConsumer-939"><a href="#TDDebugConsumer-939"><span class="linenos">939</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="TDDebugConsumer-940"><a href="#TDDebugConsumer-940"><span class="linenos">940</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unexpected result : </span><span class="se">\n</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span><span id="TDDebugConsumer-941"><a href="#TDDebugConsumer-941"><span class="linenos">941</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="TDDebugConsumer-942"><a href="#TDDebugConsumer-942"><span class="linenos">942</span></a>                <span class="k">raise</span> <span class="n">TDNetworkException</span><span class="p">(</span><span class="s2">&quot;Unexpected http status code: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">))</span>
</span><span id="TDDebugConsumer-943"><a href="#TDDebugConsumer-943"><span class="linenos">943</span></a>        <span class="k">except</span> <span class="ne">ConnectionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="TDDebugConsumer-944"><a href="#TDDebugConsumer-944"><span class="linenos">944</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="TDDebugConsumer-945"><a href="#TDDebugConsumer-945"><span class="linenos">945</span></a>            <span class="k">raise</span> <span class="n">TDNetworkException</span><span class="p">(</span><span class="s2">&quot;Data transmission failed due to &quot;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="TDDebugConsumer-946"><a href="#TDDebugConsumer-946"><span class="linenos">946</span></a>
</span><span id="TDDebugConsumer-947"><a href="#TDDebugConsumer-947"><span class="linenos">947</span></a>    <span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">throw_exception</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="TDDebugConsumer-948"><a href="#TDDebugConsumer-948"><span class="linenos">948</span></a>        <span class="k">pass</span>
</span><span id="TDDebugConsumer-949"><a href="#TDDebugConsumer-949"><span class="linenos">949</span></a>
</span><span id="TDDebugConsumer-950"><a href="#TDDebugConsumer-950"><span class="linenos">950</span></a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TDDebugConsumer-951"><a href="#TDDebugConsumer-951"><span class="linenos">951</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>The server will strictly verify the data. When a certain attribute does not meet the specification,
the entire data will not be stored. When the data format is wrong, an exception message containing detailed reasons
will be thrown. It is recommended to use this Consumer first to debug buried point data.</p>
</div>


                            <div id="TDDebugConsumer.__init__" class="classattr">
                                        <input id="TDDebugConsumer.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">TDDebugConsumer</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">server_uri</span>, </span><span class="param"><span class="n">appid</span>, </span><span class="param"><span class="n">timeout</span><span class="o">=</span><span class="mi">30000</span>, </span><span class="param"><span class="n">write_data</span><span class="o">=</span><span class="kc">True</span>, </span><span class="param"><span class="n">device_id</span><span class="o">=</span><span class="s1">&#39;&#39;</span></span>)</span>

                <label class="view-source-button" for="TDDebugConsumer.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDDebugConsumer.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDDebugConsumer.__init__-899"><a href="#TDDebugConsumer.__init__-899"><span class="linenos">899</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server_uri</span><span class="p">,</span> <span class="n">appid</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30000</span><span class="p">,</span> <span class="n">write_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">device_id</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
</span><span id="TDDebugConsumer.__init__-900"><a href="#TDDebugConsumer.__init__-900"><span class="linenos">900</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDDebugConsumer.__init__-901"><a href="#TDDebugConsumer.__init__-901"><span class="linenos">901</span></a><span class="sd">        Init debug consumer</span>
</span><span id="TDDebugConsumer.__init__-902"><a href="#TDDebugConsumer.__init__-902"><span class="linenos">902</span></a>
</span><span id="TDDebugConsumer.__init__-903"><a href="#TDDebugConsumer.__init__-903"><span class="linenos">903</span></a><span class="sd">        Parameters:</span>
</span><span id="TDDebugConsumer.__init__-904"><a href="#TDDebugConsumer.__init__-904"><span class="linenos">904</span></a><span class="sd">        - server_uri: str</span>
</span><span id="TDDebugConsumer.__init__-905"><a href="#TDDebugConsumer.__init__-905"><span class="linenos">905</span></a><span class="sd">        - appid: str</span>
</span><span id="TDDebugConsumer.__init__-906"><a href="#TDDebugConsumer.__init__-906"><span class="linenos">906</span></a><span class="sd">        - timeout: Request timeout, in milliseconds, default is 30000 ms</span>
</span><span id="TDDebugConsumer.__init__-907"><a href="#TDDebugConsumer.__init__-907"><span class="linenos">907</span></a><span class="sd">        - write_data: write data to TE or not</span>
</span><span id="TDDebugConsumer.__init__-908"><a href="#TDDebugConsumer.__init__-908"><span class="linenos">908</span></a><span class="sd">        - device_id: debug device in TE</span>
</span><span id="TDDebugConsumer.__init__-909"><a href="#TDDebugConsumer.__init__-909"><span class="linenos">909</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDDebugConsumer.__init__-910"><a href="#TDDebugConsumer.__init__-910"><span class="linenos">910</span></a>        <span class="n">server_url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">server_uri</span><span class="p">)</span>
</span><span id="TDDebugConsumer.__init__-911"><a href="#TDDebugConsumer.__init__-911"><span class="linenos">911</span></a>        <span class="n">debug_url</span> <span class="o">=</span> <span class="n">server_url</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;/data_debug&#39;</span><span class="p">)</span>
</span><span id="TDDebugConsumer.__init__-912"><a href="#TDDebugConsumer.__init__-912"><span class="linenos">912</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__server_uri</span> <span class="o">=</span> <span class="n">debug_url</span><span class="o">.</span><span class="n">geturl</span><span class="p">()</span>
</span><span id="TDDebugConsumer.__init__-913"><a href="#TDDebugConsumer.__init__-913"><span class="linenos">913</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__appid</span> <span class="o">=</span> <span class="n">appid</span>
</span><span id="TDDebugConsumer.__init__-914"><a href="#TDDebugConsumer.__init__-914"><span class="linenos">914</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span> <span class="o">=</span> <span class="n">timeout</span>
</span><span id="TDDebugConsumer.__init__-915"><a href="#TDDebugConsumer.__init__-915"><span class="linenos">915</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__writer_data</span> <span class="o">=</span> <span class="n">write_data</span>
</span><span id="TDDebugConsumer.__init__-916"><a href="#TDDebugConsumer.__init__-916"><span class="linenos">916</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__device_id</span> <span class="o">=</span> <span class="n">device_id</span>
</span><span id="TDDebugConsumer.__init__-917"><a href="#TDDebugConsumer.__init__-917"><span class="linenos">917</span></a>        <span class="n">TDAnalytics</span><span class="o">.</span><span class="n">enableLog</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="TDDebugConsumer.__init__-918"><a href="#TDDebugConsumer.__init__-918"><span class="linenos">918</span></a>        <span class="n">td_log</span><span class="p">(</span><span class="s2">&quot;init DebugConsumer&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Init debug consumer</p>

<p>Parameters:</p>

<ul>
<li>server_uri: str</li>
<li>appid: str</li>
<li>timeout: Request timeout, in milliseconds, default is 30000 ms</li>
<li>write_data: write data to TE or not</li>
<li>device_id: debug device in TE</li>
</ul>
</div>


                            </div>
                            <div id="TDDebugConsumer.add" class="classattr">
                                        <input id="TDDebugConsumer.add-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">msg</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDDebugConsumer.add-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDDebugConsumer.add"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDDebugConsumer.add-920"><a href="#TDDebugConsumer.add-920"><span class="linenos">920</span></a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
</span><span id="TDDebugConsumer.add-921"><a href="#TDDebugConsumer.add-921"><span class="linenos">921</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="TDDebugConsumer.add-922"><a href="#TDDebugConsumer.add-922"><span class="linenos">922</span></a>            <span class="n">dry_run</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="TDDebugConsumer.add-923"><a href="#TDDebugConsumer.add-923"><span class="linenos">923</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__writer_data</span><span class="p">:</span>
</span><span id="TDDebugConsumer.add-924"><a href="#TDDebugConsumer.add-924"><span class="linenos">924</span></a>                <span class="n">dry_run</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="TDDebugConsumer.add-925"><a href="#TDDebugConsumer.add-925"><span class="linenos">925</span></a>
</span><span id="TDDebugConsumer.add-926"><a href="#TDDebugConsumer.add-926"><span class="linenos">926</span></a>            <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="s1">&#39;server&#39;</span><span class="p">,</span> <span class="s1">&#39;appid&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">__appid</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">msg</span><span class="p">,</span> <span class="s1">&#39;dryRun&#39;</span><span class="p">:</span> <span class="n">dry_run</span><span class="p">}</span>
</span><span id="TDDebugConsumer.add-927"><a href="#TDDebugConsumer.add-927"><span class="linenos">927</span></a>
</span><span id="TDDebugConsumer.add-928"><a href="#TDDebugConsumer.add-928"><span class="linenos">928</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__device_id</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TDDebugConsumer.add-929"><a href="#TDDebugConsumer.add-929"><span class="linenos">929</span></a>                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;deviceId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__device_id</span>
</span><span id="TDDebugConsumer.add-930"><a href="#TDDebugConsumer.add-930"><span class="linenos">930</span></a>
</span><span id="TDDebugConsumer.add-931"><a href="#TDDebugConsumer.add-931"><span class="linenos">931</span></a>            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__server_uri</span><span class="p">,</span>
</span><span id="TDDebugConsumer.add-932"><a href="#TDDebugConsumer.add-932"><span class="linenos">932</span></a>                                     <span class="n">data</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
</span><span id="TDDebugConsumer.add-933"><a href="#TDDebugConsumer.add-933"><span class="linenos">933</span></a>                                     <span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__timeout</span><span class="p">)</span>
</span><span id="TDDebugConsumer.add-934"><a href="#TDDebugConsumer.add-934"><span class="linenos">934</span></a>            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
</span><span id="TDDebugConsumer.add-935"><a href="#TDDebugConsumer.add-935"><span class="linenos">935</span></a>                <span class="n">response_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span><span id="TDDebugConsumer.add-936"><a href="#TDDebugConsumer.add-936"><span class="linenos">936</span></a>                <span class="n">td_log</span><span class="p">(</span><span class="s1">&#39;response=</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">response_data</span><span class="p">))</span>
</span><span id="TDDebugConsumer.add-937"><a href="#TDDebugConsumer.add-937"><span class="linenos">937</span></a>                <span class="k">if</span> <span class="n">response_data</span><span class="p">[</span><span class="s2">&quot;errorLevel&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TDDebugConsumer.add-938"><a href="#TDDebugConsumer.add-938"><span class="linenos">938</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="TDDebugConsumer.add-939"><a href="#TDDebugConsumer.add-939"><span class="linenos">939</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="TDDebugConsumer.add-940"><a href="#TDDebugConsumer.add-940"><span class="linenos">940</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unexpected result : </span><span class="se">\n</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span><span id="TDDebugConsumer.add-941"><a href="#TDDebugConsumer.add-941"><span class="linenos">941</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="TDDebugConsumer.add-942"><a href="#TDDebugConsumer.add-942"><span class="linenos">942</span></a>                <span class="k">raise</span> <span class="n">TDNetworkException</span><span class="p">(</span><span class="s2">&quot;Unexpected http status code: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">))</span>
</span><span id="TDDebugConsumer.add-943"><a href="#TDDebugConsumer.add-943"><span class="linenos">943</span></a>        <span class="k">except</span> <span class="ne">ConnectionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="TDDebugConsumer.add-944"><a href="#TDDebugConsumer.add-944"><span class="linenos">944</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="TDDebugConsumer.add-945"><a href="#TDDebugConsumer.add-945"><span class="linenos">945</span></a>            <span class="k">raise</span> <span class="n">TDNetworkException</span><span class="p">(</span><span class="s2">&quot;Data transmission failed due to &quot;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span></pre></div>


    

                            </div>
                            <div id="TDDebugConsumer.flush" class="classattr">
                                        <input id="TDDebugConsumer.flush-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">flush</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">throw_exception</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDDebugConsumer.flush-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDDebugConsumer.flush"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDDebugConsumer.flush-947"><a href="#TDDebugConsumer.flush-947"><span class="linenos">947</span></a>    <span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">throw_exception</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="TDDebugConsumer.flush-948"><a href="#TDDebugConsumer.flush-948"><span class="linenos">948</span></a>        <span class="k">pass</span>
</span></pre></div>


    

                            </div>
                            <div id="TDDebugConsumer.close" class="classattr">
                                        <input id="TDDebugConsumer.close-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">close</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDDebugConsumer.close-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDDebugConsumer.close"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDDebugConsumer.close-950"><a href="#TDDebugConsumer.close-950"><span class="linenos">950</span></a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TDDebugConsumer.close-951"><a href="#TDDebugConsumer.close-951"><span class="linenos">951</span></a>        <span class="k">pass</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="TDAsyncBatchConsumer">
                            <input id="TDAsyncBatchConsumer-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">TDAsyncBatchConsumer</span>:

                <label class="view-source-button" for="TDAsyncBatchConsumer-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDAsyncBatchConsumer"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDAsyncBatchConsumer-748"><a href="#TDAsyncBatchConsumer-748"><span class="linenos">748</span></a><span class="k">class</span> <span class="nc">TDAsyncBatchConsumer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="TDAsyncBatchConsumer-749"><a href="#TDAsyncBatchConsumer-749"><span class="linenos">749</span></a>
</span><span id="TDAsyncBatchConsumer-750"><a href="#TDAsyncBatchConsumer-750"><span class="linenos">750</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server_uri</span><span class="p">,</span> <span class="n">appid</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">flush_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">queue_size</span><span class="o">=</span><span class="mi">100000</span><span class="p">):</span>
</span><span id="TDAsyncBatchConsumer-751"><a href="#TDAsyncBatchConsumer-751"><span class="linenos">751</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAsyncBatchConsumer-752"><a href="#TDAsyncBatchConsumer-752"><span class="linenos">752</span></a><span class="sd">        Report data by http (asynchronous)</span>
</span><span id="TDAsyncBatchConsumer-753"><a href="#TDAsyncBatchConsumer-753"><span class="linenos">753</span></a>
</span><span id="TDAsyncBatchConsumer-754"><a href="#TDAsyncBatchConsumer-754"><span class="linenos">754</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAsyncBatchConsumer-755"><a href="#TDAsyncBatchConsumer-755"><span class="linenos">755</span></a><span class="sd">        - server_uri: str</span>
</span><span id="TDAsyncBatchConsumer-756"><a href="#TDAsyncBatchConsumer-756"><span class="linenos">756</span></a><span class="sd">        - appid: str</span>
</span><span id="TDAsyncBatchConsumer-757"><a href="#TDAsyncBatchConsumer-757"><span class="linenos">757</span></a><span class="sd">        - interval: The maximum time interval for uploading data, in seconds, the default is 3 seconds</span>
</span><span id="TDAsyncBatchConsumer-758"><a href="#TDAsyncBatchConsumer-758"><span class="linenos">758</span></a><span class="sd">        - flush_size: The threshold of the queue cache, if this value is exceeded, it will be sent immediately</span>
</span><span id="TDAsyncBatchConsumer-759"><a href="#TDAsyncBatchConsumer-759"><span class="linenos">759</span></a><span class="sd">        - queue_size: The size of the storage queue</span>
</span><span id="TDAsyncBatchConsumer-760"><a href="#TDAsyncBatchConsumer-760"><span class="linenos">760</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAsyncBatchConsumer-761"><a href="#TDAsyncBatchConsumer-761"><span class="linenos">761</span></a>        <span class="n">server_url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">server_uri</span><span class="p">)</span>
</span><span id="TDAsyncBatchConsumer-762"><a href="#TDAsyncBatchConsumer-762"><span class="linenos">762</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__http_service</span> <span class="o">=</span> <span class="n">_HttpServices</span><span class="p">(</span><span class="n">server_url</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;/sync_server&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">geturl</span><span class="p">(),</span> <span class="n">appid</span><span class="p">,</span> <span class="mi">30000</span><span class="p">)</span>
</span><span id="TDAsyncBatchConsumer-763"><a href="#TDAsyncBatchConsumer-763"><span class="linenos">763</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__batch</span> <span class="o">=</span> <span class="n">flush_size</span>
</span><span id="TDAsyncBatchConsumer-764"><a href="#TDAsyncBatchConsumer-764"><span class="linenos">764</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__queue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">(</span><span class="n">queue_size</span><span class="p">)</span>
</span><span id="TDAsyncBatchConsumer-765"><a href="#TDAsyncBatchConsumer-765"><span class="linenos">765</span></a>
</span><span id="TDAsyncBatchConsumer-766"><a href="#TDAsyncBatchConsumer-766"><span class="linenos">766</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__flushing_thread</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_AsyncFlushThread</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interval</span><span class="p">)</span>
</span><span id="TDAsyncBatchConsumer-767"><a href="#TDAsyncBatchConsumer-767"><span class="linenos">767</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__flushing_thread</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="TDAsyncBatchConsumer-768"><a href="#TDAsyncBatchConsumer-768"><span class="linenos">768</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__flushing_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span id="TDAsyncBatchConsumer-769"><a href="#TDAsyncBatchConsumer-769"><span class="linenos">769</span></a>        <span class="n">td_log</span><span class="p">(</span><span class="s2">&quot;init AsyncBatchConsumer&quot;</span><span class="p">)</span>
</span><span id="TDAsyncBatchConsumer-770"><a href="#TDAsyncBatchConsumer-770"><span class="linenos">770</span></a>
</span><span id="TDAsyncBatchConsumer-771"><a href="#TDAsyncBatchConsumer-771"><span class="linenos">771</span></a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
</span><span id="TDAsyncBatchConsumer-772"><a href="#TDAsyncBatchConsumer-772"><span class="linenos">772</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="TDAsyncBatchConsumer-773"><a href="#TDAsyncBatchConsumer-773"><span class="linenos">773</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__queue</span><span class="o">.</span><span class="n">put_nowait</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="TDAsyncBatchConsumer-774"><a href="#TDAsyncBatchConsumer-774"><span class="linenos">774</span></a>        <span class="k">except</span> <span class="n">queue</span><span class="o">.</span><span class="n">Full</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="TDAsyncBatchConsumer-775"><a href="#TDAsyncBatchConsumer-775"><span class="linenos">775</span></a>            <span class="k">raise</span> <span class="n">TDNetworkException</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="TDAsyncBatchConsumer-776"><a href="#TDAsyncBatchConsumer-776"><span class="linenos">776</span></a>
</span><span id="TDAsyncBatchConsumer-777"><a href="#TDAsyncBatchConsumer-777"><span class="linenos">777</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__queue</span><span class="o">.</span><span class="n">qsize</span><span class="p">()</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">__batch</span><span class="p">:</span>
</span><span id="TDAsyncBatchConsumer-778"><a href="#TDAsyncBatchConsumer-778"><span class="linenos">778</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span><span id="TDAsyncBatchConsumer-779"><a href="#TDAsyncBatchConsumer-779"><span class="linenos">779</span></a>
</span><span id="TDAsyncBatchConsumer-780"><a href="#TDAsyncBatchConsumer-780"><span class="linenos">780</span></a>    <span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TDAsyncBatchConsumer-781"><a href="#TDAsyncBatchConsumer-781"><span class="linenos">781</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__flushing_thread</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span><span id="TDAsyncBatchConsumer-782"><a href="#TDAsyncBatchConsumer-782"><span class="linenos">782</span></a>
</span><span id="TDAsyncBatchConsumer-783"><a href="#TDAsyncBatchConsumer-783"><span class="linenos">783</span></a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TDAsyncBatchConsumer-784"><a href="#TDAsyncBatchConsumer-784"><span class="linenos">784</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span><span id="TDAsyncBatchConsumer-785"><a href="#TDAsyncBatchConsumer-785"><span class="linenos">785</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__flushing_thread</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</span><span id="TDAsyncBatchConsumer-786"><a href="#TDAsyncBatchConsumer-786"><span class="linenos">786</span></a>        <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__queue</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span>
</span><span id="TDAsyncBatchConsumer-787"><a href="#TDAsyncBatchConsumer-787"><span class="linenos">787</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_perform_request</span><span class="p">()</span>
</span><span id="TDAsyncBatchConsumer-788"><a href="#TDAsyncBatchConsumer-788"><span class="linenos">788</span></a>
</span><span id="TDAsyncBatchConsumer-789"><a href="#TDAsyncBatchConsumer-789"><span class="linenos">789</span></a>    <span class="k">def</span> <span class="nf">_perform_request</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TDAsyncBatchConsumer-790"><a href="#TDAsyncBatchConsumer-790"><span class="linenos">790</span></a>
</span><span id="TDAsyncBatchConsumer-791"><a href="#TDAsyncBatchConsumer-791"><span class="linenos">791</span></a>        <span class="n">flush_buffer</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="TDAsyncBatchConsumer-792"><a href="#TDAsyncBatchConsumer-792"><span class="linenos">792</span></a>        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">flush_buffer</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">__batch</span><span class="p">:</span>
</span><span id="TDAsyncBatchConsumer-793"><a href="#TDAsyncBatchConsumer-793"><span class="linenos">793</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="TDAsyncBatchConsumer-794"><a href="#TDAsyncBatchConsumer-794"><span class="linenos">794</span></a>                <span class="n">flush_buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__queue</span><span class="o">.</span><span class="n">get_nowait</span><span class="p">()))</span>
</span><span id="TDAsyncBatchConsumer-795"><a href="#TDAsyncBatchConsumer-795"><span class="linenos">795</span></a>            <span class="k">except</span> <span class="n">queue</span><span class="o">.</span><span class="n">Empty</span><span class="p">:</span>
</span><span id="TDAsyncBatchConsumer-796"><a href="#TDAsyncBatchConsumer-796"><span class="linenos">796</span></a>                <span class="k">break</span>
</span><span id="TDAsyncBatchConsumer-797"><a href="#TDAsyncBatchConsumer-797"><span class="linenos">797</span></a>
</span><span id="TDAsyncBatchConsumer-798"><a href="#TDAsyncBatchConsumer-798"><span class="linenos">798</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">flush_buffer</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="TDAsyncBatchConsumer-799"><a href="#TDAsyncBatchConsumer-799"><span class="linenos">799</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>  <span class="c1"># Retry 3 times in case of network exception</span>
</span><span id="TDAsyncBatchConsumer-800"><a href="#TDAsyncBatchConsumer-800"><span class="linenos">800</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="TDAsyncBatchConsumer-801"><a href="#TDAsyncBatchConsumer-801"><span class="linenos">801</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">__http_service</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s1">&#39;[&#39;</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">flush_buffer</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">flush_buffer</span><span class="p">)))</span>
</span><span id="TDAsyncBatchConsumer-802"><a href="#TDAsyncBatchConsumer-802"><span class="linenos">802</span></a>                    <span class="k">return</span> <span class="kc">True</span>
</span><span id="TDAsyncBatchConsumer-803"><a href="#TDAsyncBatchConsumer-803"><span class="linenos">803</span></a>                <span class="k">except</span> <span class="n">TDNetworkException</span><span class="p">:</span>
</span><span id="TDAsyncBatchConsumer-804"><a href="#TDAsyncBatchConsumer-804"><span class="linenos">804</span></a>                    <span class="k">pass</span>
</span><span id="TDAsyncBatchConsumer-805"><a href="#TDAsyncBatchConsumer-805"><span class="linenos">805</span></a>                <span class="k">except</span> <span class="n">TDIllegalDataException</span><span class="p">:</span>
</span><span id="TDAsyncBatchConsumer-806"><a href="#TDAsyncBatchConsumer-806"><span class="linenos">806</span></a>                    <span class="k">break</span>
</span><span id="TDAsyncBatchConsumer-807"><a href="#TDAsyncBatchConsumer-807"><span class="linenos">807</span></a>
</span><span id="TDAsyncBatchConsumer-808"><a href="#TDAsyncBatchConsumer-808"><span class="linenos">808</span></a>    <span class="k">class</span> <span class="nc">_AsyncFlushThread</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">):</span>
</span><span id="TDAsyncBatchConsumer-809"><a href="#TDAsyncBatchConsumer-809"><span class="linenos">809</span></a>        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">consumer</span><span class="p">,</span> <span class="n">interval</span><span class="p">):</span>
</span><span id="TDAsyncBatchConsumer-810"><a href="#TDAsyncBatchConsumer-810"><span class="linenos">810</span></a>            <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="TDAsyncBatchConsumer-811"><a href="#TDAsyncBatchConsumer-811"><span class="linenos">811</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_consumer</span> <span class="o">=</span> <span class="n">consumer</span>
</span><span id="TDAsyncBatchConsumer-812"><a href="#TDAsyncBatchConsumer-812"><span class="linenos">812</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_interval</span> <span class="o">=</span> <span class="n">interval</span>
</span><span id="TDAsyncBatchConsumer-813"><a href="#TDAsyncBatchConsumer-813"><span class="linenos">813</span></a>
</span><span id="TDAsyncBatchConsumer-814"><a href="#TDAsyncBatchConsumer-814"><span class="linenos">814</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_stop_event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
</span><span id="TDAsyncBatchConsumer-815"><a href="#TDAsyncBatchConsumer-815"><span class="linenos">815</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_finished_event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
</span><span id="TDAsyncBatchConsumer-816"><a href="#TDAsyncBatchConsumer-816"><span class="linenos">816</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_flush_event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
</span><span id="TDAsyncBatchConsumer-817"><a href="#TDAsyncBatchConsumer-817"><span class="linenos">817</span></a>
</span><span id="TDAsyncBatchConsumer-818"><a href="#TDAsyncBatchConsumer-818"><span class="linenos">818</span></a>        <span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TDAsyncBatchConsumer-819"><a href="#TDAsyncBatchConsumer-819"><span class="linenos">819</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_flush_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</span><span id="TDAsyncBatchConsumer-820"><a href="#TDAsyncBatchConsumer-820"><span class="linenos">820</span></a>
</span><span id="TDAsyncBatchConsumer-821"><a href="#TDAsyncBatchConsumer-821"><span class="linenos">821</span></a>        <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TDAsyncBatchConsumer-822"><a href="#TDAsyncBatchConsumer-822"><span class="linenos">822</span></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAsyncBatchConsumer-823"><a href="#TDAsyncBatchConsumer-823"><span class="linenos">823</span></a><span class="sd">            Use of this method needs to be adjusted when exiting to ensure that the safe line program ends safely.</span>
</span><span id="TDAsyncBatchConsumer-824"><a href="#TDAsyncBatchConsumer-824"><span class="linenos">824</span></a><span class="sd">            &quot;&quot;&quot;</span>
</span><span id="TDAsyncBatchConsumer-825"><a href="#TDAsyncBatchConsumer-825"><span class="linenos">825</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_stop_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</span><span id="TDAsyncBatchConsumer-826"><a href="#TDAsyncBatchConsumer-826"><span class="linenos">826</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_finished_event</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
</span><span id="TDAsyncBatchConsumer-827"><a href="#TDAsyncBatchConsumer-827"><span class="linenos">827</span></a>
</span><span id="TDAsyncBatchConsumer-828"><a href="#TDAsyncBatchConsumer-828"><span class="linenos">828</span></a>        <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TDAsyncBatchConsumer-829"><a href="#TDAsyncBatchConsumer-829"><span class="linenos">829</span></a>            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="TDAsyncBatchConsumer-830"><a href="#TDAsyncBatchConsumer-830"><span class="linenos">830</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_flush_event</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_interval</span><span class="p">)</span>
</span><span id="TDAsyncBatchConsumer-831"><a href="#TDAsyncBatchConsumer-831"><span class="linenos">831</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_consumer</span><span class="o">.</span><span class="n">_perform_request</span><span class="p">()</span>
</span><span id="TDAsyncBatchConsumer-832"><a href="#TDAsyncBatchConsumer-832"><span class="linenos">832</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_flush_event</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</span><span id="TDAsyncBatchConsumer-833"><a href="#TDAsyncBatchConsumer-833"><span class="linenos">833</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
</span><span id="TDAsyncBatchConsumer-834"><a href="#TDAsyncBatchConsumer-834"><span class="linenos">834</span></a>                    <span class="k">break</span>
</span><span id="TDAsyncBatchConsumer-835"><a href="#TDAsyncBatchConsumer-835"><span class="linenos">835</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_finished_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</span></pre></div>


    

                            <div id="TDAsyncBatchConsumer.__init__" class="classattr">
                                        <input id="TDAsyncBatchConsumer.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">TDAsyncBatchConsumer</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">server_uri</span>, </span><span class="param"><span class="n">appid</span>, </span><span class="param"><span class="n">interval</span><span class="o">=</span><span class="mi">3</span>, </span><span class="param"><span class="n">flush_size</span><span class="o">=</span><span class="mi">20</span>, </span><span class="param"><span class="n">queue_size</span><span class="o">=</span><span class="mi">100000</span></span>)</span>

                <label class="view-source-button" for="TDAsyncBatchConsumer.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDAsyncBatchConsumer.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDAsyncBatchConsumer.__init__-750"><a href="#TDAsyncBatchConsumer.__init__-750"><span class="linenos">750</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server_uri</span><span class="p">,</span> <span class="n">appid</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">flush_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">queue_size</span><span class="o">=</span><span class="mi">100000</span><span class="p">):</span>
</span><span id="TDAsyncBatchConsumer.__init__-751"><a href="#TDAsyncBatchConsumer.__init__-751"><span class="linenos">751</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="TDAsyncBatchConsumer.__init__-752"><a href="#TDAsyncBatchConsumer.__init__-752"><span class="linenos">752</span></a><span class="sd">        Report data by http (asynchronous)</span>
</span><span id="TDAsyncBatchConsumer.__init__-753"><a href="#TDAsyncBatchConsumer.__init__-753"><span class="linenos">753</span></a>
</span><span id="TDAsyncBatchConsumer.__init__-754"><a href="#TDAsyncBatchConsumer.__init__-754"><span class="linenos">754</span></a><span class="sd">        Parameters:</span>
</span><span id="TDAsyncBatchConsumer.__init__-755"><a href="#TDAsyncBatchConsumer.__init__-755"><span class="linenos">755</span></a><span class="sd">        - server_uri: str</span>
</span><span id="TDAsyncBatchConsumer.__init__-756"><a href="#TDAsyncBatchConsumer.__init__-756"><span class="linenos">756</span></a><span class="sd">        - appid: str</span>
</span><span id="TDAsyncBatchConsumer.__init__-757"><a href="#TDAsyncBatchConsumer.__init__-757"><span class="linenos">757</span></a><span class="sd">        - interval: The maximum time interval for uploading data, in seconds, the default is 3 seconds</span>
</span><span id="TDAsyncBatchConsumer.__init__-758"><a href="#TDAsyncBatchConsumer.__init__-758"><span class="linenos">758</span></a><span class="sd">        - flush_size: The threshold of the queue cache, if this value is exceeded, it will be sent immediately</span>
</span><span id="TDAsyncBatchConsumer.__init__-759"><a href="#TDAsyncBatchConsumer.__init__-759"><span class="linenos">759</span></a><span class="sd">        - queue_size: The size of the storage queue</span>
</span><span id="TDAsyncBatchConsumer.__init__-760"><a href="#TDAsyncBatchConsumer.__init__-760"><span class="linenos">760</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TDAsyncBatchConsumer.__init__-761"><a href="#TDAsyncBatchConsumer.__init__-761"><span class="linenos">761</span></a>        <span class="n">server_url</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">server_uri</span><span class="p">)</span>
</span><span id="TDAsyncBatchConsumer.__init__-762"><a href="#TDAsyncBatchConsumer.__init__-762"><span class="linenos">762</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__http_service</span> <span class="o">=</span> <span class="n">_HttpServices</span><span class="p">(</span><span class="n">server_url</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;/sync_server&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">geturl</span><span class="p">(),</span> <span class="n">appid</span><span class="p">,</span> <span class="mi">30000</span><span class="p">)</span>
</span><span id="TDAsyncBatchConsumer.__init__-763"><a href="#TDAsyncBatchConsumer.__init__-763"><span class="linenos">763</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__batch</span> <span class="o">=</span> <span class="n">flush_size</span>
</span><span id="TDAsyncBatchConsumer.__init__-764"><a href="#TDAsyncBatchConsumer.__init__-764"><span class="linenos">764</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__queue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">(</span><span class="n">queue_size</span><span class="p">)</span>
</span><span id="TDAsyncBatchConsumer.__init__-765"><a href="#TDAsyncBatchConsumer.__init__-765"><span class="linenos">765</span></a>
</span><span id="TDAsyncBatchConsumer.__init__-766"><a href="#TDAsyncBatchConsumer.__init__-766"><span class="linenos">766</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__flushing_thread</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_AsyncFlushThread</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interval</span><span class="p">)</span>
</span><span id="TDAsyncBatchConsumer.__init__-767"><a href="#TDAsyncBatchConsumer.__init__-767"><span class="linenos">767</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__flushing_thread</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="TDAsyncBatchConsumer.__init__-768"><a href="#TDAsyncBatchConsumer.__init__-768"><span class="linenos">768</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__flushing_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span id="TDAsyncBatchConsumer.__init__-769"><a href="#TDAsyncBatchConsumer.__init__-769"><span class="linenos">769</span></a>        <span class="n">td_log</span><span class="p">(</span><span class="s2">&quot;init AsyncBatchConsumer&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Report data by http (asynchronous)</p>

<p>Parameters:</p>

<ul>
<li>server_uri: str</li>
<li>appid: str</li>
<li>interval: The maximum time interval for uploading data, in seconds, the default is 3 seconds</li>
<li>flush_size: The threshold of the queue cache, if this value is exceeded, it will be sent immediately</li>
<li>queue_size: The size of the storage queue</li>
</ul>
</div>


                            </div>
                            <div id="TDAsyncBatchConsumer.add" class="classattr">
                                        <input id="TDAsyncBatchConsumer.add-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">msg</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDAsyncBatchConsumer.add-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDAsyncBatchConsumer.add"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDAsyncBatchConsumer.add-771"><a href="#TDAsyncBatchConsumer.add-771"><span class="linenos">771</span></a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
</span><span id="TDAsyncBatchConsumer.add-772"><a href="#TDAsyncBatchConsumer.add-772"><span class="linenos">772</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="TDAsyncBatchConsumer.add-773"><a href="#TDAsyncBatchConsumer.add-773"><span class="linenos">773</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">__queue</span><span class="o">.</span><span class="n">put_nowait</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="TDAsyncBatchConsumer.add-774"><a href="#TDAsyncBatchConsumer.add-774"><span class="linenos">774</span></a>        <span class="k">except</span> <span class="n">queue</span><span class="o">.</span><span class="n">Full</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="TDAsyncBatchConsumer.add-775"><a href="#TDAsyncBatchConsumer.add-775"><span class="linenos">775</span></a>            <span class="k">raise</span> <span class="n">TDNetworkException</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="TDAsyncBatchConsumer.add-776"><a href="#TDAsyncBatchConsumer.add-776"><span class="linenos">776</span></a>
</span><span id="TDAsyncBatchConsumer.add-777"><a href="#TDAsyncBatchConsumer.add-777"><span class="linenos">777</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__queue</span><span class="o">.</span><span class="n">qsize</span><span class="p">()</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">__batch</span><span class="p">:</span>
</span><span id="TDAsyncBatchConsumer.add-778"><a href="#TDAsyncBatchConsumer.add-778"><span class="linenos">778</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="TDAsyncBatchConsumer.flush" class="classattr">
                                        <input id="TDAsyncBatchConsumer.flush-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">flush</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDAsyncBatchConsumer.flush-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDAsyncBatchConsumer.flush"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDAsyncBatchConsumer.flush-780"><a href="#TDAsyncBatchConsumer.flush-780"><span class="linenos">780</span></a>    <span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TDAsyncBatchConsumer.flush-781"><a href="#TDAsyncBatchConsumer.flush-781"><span class="linenos">781</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__flushing_thread</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="TDAsyncBatchConsumer.close" class="classattr">
                                        <input id="TDAsyncBatchConsumer.close-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">close</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDAsyncBatchConsumer.close-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDAsyncBatchConsumer.close"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDAsyncBatchConsumer.close-783"><a href="#TDAsyncBatchConsumer.close-783"><span class="linenos">783</span></a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TDAsyncBatchConsumer.close-784"><a href="#TDAsyncBatchConsumer.close-784"><span class="linenos">784</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span><span id="TDAsyncBatchConsumer.close-785"><a href="#TDAsyncBatchConsumer.close-785"><span class="linenos">785</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">__flushing_thread</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</span><span id="TDAsyncBatchConsumer.close-786"><a href="#TDAsyncBatchConsumer.close-786"><span class="linenos">786</span></a>        <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">__queue</span><span class="o">.</span><span class="n">empty</span><span class="p">():</span>
</span><span id="TDAsyncBatchConsumer.close-787"><a href="#TDAsyncBatchConsumer.close-787"><span class="linenos">787</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_perform_request</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="TDException">
                            <input id="TDException-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">TDException</span><wbr>(<span class="base">builtins.Exception</span>):

                <label class="view-source-button" for="TDException-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDException"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDException-101"><a href="#TDException-101"><span class="linenos">101</span></a><span class="k">class</span> <span class="nc">TDException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
</span><span id="TDException-102"><a href="#TDException-102"><span class="linenos">102</span></a>    <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Common base class for all non-exit exceptions.</p>
</div>


                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>builtins.Exception</dt>
                                <dd id="TDException.__init__" class="function">Exception</dd>

            </div>
            <div><dt>builtins.BaseException</dt>
                                <dd id="TDException.with_traceback" class="function">with_traceback</dd>
                <dd id="TDException.args" class="variable">args</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="TDIllegalDataException">
                            <input id="TDIllegalDataException-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">TDIllegalDataException</span><wbr>(<span class="base"><a href="#TDException">tgasdk.TDException</a></span>):

                <label class="view-source-button" for="TDIllegalDataException-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDIllegalDataException"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDIllegalDataException-105"><a href="#TDIllegalDataException-105"><span class="linenos">105</span></a><span class="k">class</span> <span class="nc">TDIllegalDataException</span><span class="p">(</span><span class="n">TDException</span><span class="p">):</span>
</span><span id="TDIllegalDataException-106"><a href="#TDIllegalDataException-106"><span class="linenos">106</span></a>    <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Common base class for all non-exit exceptions.</p>
</div>


                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>builtins.Exception</dt>
                                <dd id="TDIllegalDataException.__init__" class="function">Exception</dd>

            </div>
            <div><dt>builtins.BaseException</dt>
                                <dd id="TDIllegalDataException.with_traceback" class="function">with_traceback</dd>
                <dd id="TDIllegalDataException.args" class="variable">args</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="TDNetworkException">
                            <input id="TDNetworkException-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">TDNetworkException</span><wbr>(<span class="base"><a href="#TDException">tgasdk.TDException</a></span>):

                <label class="view-source-button" for="TDNetworkException-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDNetworkException"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDNetworkException-109"><a href="#TDNetworkException-109"><span class="linenos">109</span></a><span class="k">class</span> <span class="nc">TDNetworkException</span><span class="p">(</span><span class="n">TDException</span><span class="p">):</span>
</span><span id="TDNetworkException-110"><a href="#TDNetworkException-110"><span class="linenos">110</span></a>    <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Common base class for all non-exit exceptions.</p>
</div>


                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>builtins.Exception</dt>
                                <dd id="TDNetworkException.__init__" class="function">Exception</dd>

            </div>
            <div><dt>builtins.BaseException</dt>
                                <dd id="TDNetworkException.with_traceback" class="function">with_traceback</dd>
                <dd id="TDNetworkException.args" class="variable">args</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="TD_ROTATE_MODE">
                            <input id="TD_ROTATE_MODE-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">TD_ROTATE_MODE</span><wbr>(<span class="base">enum.Enum</span>):

                <label class="view-source-button" for="TD_ROTATE_MODE-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TD_ROTATE_MODE"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TD_ROTATE_MODE-52"><a href="#TD_ROTATE_MODE-52"><span class="linenos">52</span></a>    <span class="k">class</span> <span class="nc">TD_ROTATE_MODE</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="TD_ROTATE_MODE-53"><a href="#TD_ROTATE_MODE-53"><span class="linenos">53</span></a>        <span class="n">DAILY</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="TD_ROTATE_MODE-54"><a href="#TD_ROTATE_MODE-54"><span class="linenos">54</span></a>        <span class="n">HOURLY</span> <span class="o">=</span> <span class="mi">1</span>
</span></pre></div>


            <div class="docstring"><p>An enumeration.</p>
</div>


                            <div id="TD_ROTATE_MODE.DAILY" class="classattr">
                                <div class="attr variable">
            <span class="name">DAILY</span>        =
<span class="default_value">&lt;<a href="#TD_ROTATE_MODE.DAILY">TD_ROTATE_MODE.DAILY</a>: 1&gt;</span>

        
    </div>
    <a class="headerlink" href="#TD_ROTATE_MODE.DAILY"></a>
    
    

                            </div>
                            <div id="TD_ROTATE_MODE.HOURLY" class="classattr">
                                <div class="attr variable">
            <span class="name">HOURLY</span>        =
<span class="default_value">&lt;<a href="#TD_ROTATE_MODE.HOURLY">TD_ROTATE_MODE.HOURLY</a>: 2&gt;</span>

        
    </div>
    <a class="headerlink" href="#TD_ROTATE_MODE.HOURLY"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>enum.Enum</dt>
                                <dd id="TD_ROTATE_MODE.name" class="variable">name</dd>
                <dd id="TD_ROTATE_MODE.value" class="variable">value</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="TDDynamicSuperPropertiesTracker">
                            <input id="TDDynamicSuperPropertiesTracker-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">TDDynamicSuperPropertiesTracker</span>:

                <label class="view-source-button" for="TDDynamicSuperPropertiesTracker-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDDynamicSuperPropertiesTracker"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDDynamicSuperPropertiesTracker-113"><a href="#TDDynamicSuperPropertiesTracker-113"><span class="linenos">113</span></a><span class="k">class</span> <span class="nc">TDDynamicSuperPropertiesTracker</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="TDDynamicSuperPropertiesTracker-114"><a href="#TDDynamicSuperPropertiesTracker-114"><span class="linenos">114</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TDDynamicSuperPropertiesTracker-115"><a href="#TDDynamicSuperPropertiesTracker-115"><span class="linenos">115</span></a>        <span class="k">pass</span>
</span><span id="TDDynamicSuperPropertiesTracker-116"><a href="#TDDynamicSuperPropertiesTracker-116"><span class="linenos">116</span></a>
</span><span id="TDDynamicSuperPropertiesTracker-117"><a href="#TDDynamicSuperPropertiesTracker-117"><span class="linenos">117</span></a>    <span class="k">def</span> <span class="nf">get_dynamic_super_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TDDynamicSuperPropertiesTracker-118"><a href="#TDDynamicSuperPropertiesTracker-118"><span class="linenos">118</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span></pre></div>


    

                            <div id="TDDynamicSuperPropertiesTracker.get_dynamic_super_properties" class="classattr">
                                        <input id="TDDynamicSuperPropertiesTracker.get_dynamic_super_properties-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_dynamic_super_properties</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TDDynamicSuperPropertiesTracker.get_dynamic_super_properties-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TDDynamicSuperPropertiesTracker.get_dynamic_super_properties"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TDDynamicSuperPropertiesTracker.get_dynamic_super_properties-117"><a href="#TDDynamicSuperPropertiesTracker.get_dynamic_super_properties-117"><span class="linenos">117</span></a>    <span class="k">def</span> <span class="nf">get_dynamic_super_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TDDynamicSuperPropertiesTracker.get_dynamic_super_properties-118"><a href="#TDDynamicSuperPropertiesTracker.get_dynamic_super_properties-118"><span class="linenos">118</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span></pre></div>


    

                            </div>
                </section>
    </main>
</body>
</html>